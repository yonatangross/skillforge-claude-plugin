{
  "version": 3,
  "sources": ["../src/types.ts", "../src/lib/common.ts", "../src/lib/git.ts", "../src/lib/guards.ts", "../src/skill/backend-file-naming.ts", "../src/skill/decision-processor.ts", "../src/skill/backend-layer-validator.ts", "../src/skill/coverage-check.ts", "../src/skill/coverage-threshold-gate.ts", "../src/skill/cross-instance-test-validator.ts", "../src/skill/di-pattern-enforcer.ts", "../src/skill/duplicate-code-detector.ts", "../src/skill/eval-metrics-collector.ts", "../src/skill/evidence-collector.ts", "../src/skill/import-direction-enforcer.ts", "../src/skill/merge-conflict-predictor.ts", "../src/skill/merge-readiness-checker.ts", "../src/skill/migration-validator.ts", "../src/skill/pattern-consistency-enforcer.ts", "../src/skill/redact-secrets.ts", "../src/skill/review-summary-generator.ts", "../src/skill/security-summary.ts", "../src/skill/structure-location-validator.ts", "../src/skill/test-location-validator.ts", "../src/skill/test-pattern-validator.ts", "../src/skill/test-runner.ts", "../src/entries/skill.ts"],
  "sourcesContent": ["/**\n * TypeScript type definitions for Claude Code hooks\n * CC 2.1.9 compliant with additionalContext support\n */\n\n/**\n * Hook events supported by Claude Code\n */\nexport type HookEvent =\n  | 'PreToolUse'\n  | 'PostToolUse'\n  | 'PermissionRequest'\n  | 'UserPromptSubmit'\n  | 'SessionStart'\n  | 'SessionEnd'\n  | 'Stop'\n  | 'SubagentStart'\n  | 'SubagentStop'\n  | 'Setup'\n  | 'Notification';\n\n/**\n * Hook input envelope from Claude Code (sent via stdin as JSON)\n */\nexport interface HookInput {\n  /** The hook event type */\n  hook_event?: HookEvent;\n  /** The tool being invoked */\n  tool_name: string;\n  /** Session ID (CC 2.1.9 guarantees availability) */\n  session_id: string;\n  /** Tool-specific input parameters */\n  tool_input: ToolInput;\n  /** Tool output (PostToolUse only) */\n  tool_output?: unknown;\n  /** Tool error message if any */\n  tool_error?: string;\n  /** Tool exit code */\n  exit_code?: number;\n  /** User prompt (UserPromptSubmit only) */\n  prompt?: string;\n  /** Project directory */\n  project_dir?: string;\n\n  // SubagentStart/SubagentStop specific fields\n  /** Agent type for subagent hooks */\n  subagent_type?: string;\n  /** Agent type (alternative field name) */\n  agent_type?: string;\n  /** Agent ID */\n  agent_id?: string;\n  /** Agent output (SubagentStop) */\n  agent_output?: string;\n  /** Output (alternative field name) */\n  output?: string;\n  /** Error from subagent */\n  error?: string;\n  /** Duration in milliseconds */\n  duration_ms?: number;\n  /** Tool result \u2014 string from most hooks, object from Skill PostToolUse */\n  tool_result?: string | { is_error?: boolean; content?: string };\n\n  // Notification specific fields\n  /** Notification message */\n  message?: string;\n  /** Notification type */\n  notification_type?: string;\n}\n\n/**\n * Tool input types - union of all tool inputs\n */\nexport interface ToolInput {\n  /** Bash command (Bash tool) */\n  command?: string;\n  /** Timeout in ms (Bash tool) */\n  timeout?: number;\n  /** File path (Write/Edit/Read tools) */\n  file_path?: string;\n  /** File content (Write tool) */\n  content?: string;\n  /** Old text to replace (Edit tool) */\n  old_string?: string;\n  /** New text (Edit tool) */\n  new_string?: string;\n  /** Pattern (Glob/Grep tools) */\n  pattern?: string;\n  /** Allow additional properties */\n  [key: string]: unknown;\n}\n\n/**\n * Hook-specific output for CC 2.1.9\n */\nexport interface HookSpecificOutput {\n  /** Hook event name for context */\n  hookEventName?: 'PreToolUse' | 'PostToolUse' | 'PermissionRequest' | 'UserPromptSubmit';\n  /** Permission decision (PermissionRequest hooks) */\n  permissionDecision?: 'allow' | 'deny';\n  /** Reason for permission decision */\n  permissionDecisionReason?: string;\n  /** Additional context injected before tool execution (CC 2.1.9) */\n  additionalContext?: string;\n}\n\n/**\n * Hook result - output JSON to stdout\n * CC 2.1.7+ compliant\n */\nexport interface HookResult {\n  /** Whether to continue execution */\n  continue: boolean;\n  /** Suppress hook output from user */\n  suppressOutput?: boolean;\n  /** System message shown to user */\n  systemMessage?: string;\n  /** Reason for stopping (when continue is false) */\n  stopReason?: string;\n  /** Hook-specific output fields */\n  hookSpecificOutput?: HookSpecificOutput;\n}\n\n/**\n * Hook function signature\n */\nexport type HookFn = (input: HookInput) => Promise<HookResult> | HookResult;\n\n/**\n * Hook metadata for auto-discovery and governance\n * Co-export alongside hook functions for single-source-of-truth registration\n */\nexport interface HookMeta {\n  /** Full hook name path (e.g., 'pretool/bash/dangerous-command-blocker') */\n  name: string;\n  /** Human-readable description */\n  description: string;\n  /** Hook event type */\n  event: HookEvent;\n  /** Tool matcher patterns for hooks.json (e.g., 'Bash', 'Write|Edit') */\n  matchers?: string[];\n  /** Run asynchronously (non-blocking) */\n  async?: boolean;\n  /** Only run once per session */\n  once?: boolean;\n  /** Timeout in seconds (async hooks only) */\n  timeout?: number;\n  /** Risk category for prioritization */\n  tier?: 'security-critical' | 'data-loss' | 'quality-gate' | 'standard';\n}\n\n/**\n * Hook overrides configuration for per-project toggle/customization\n * Stored at .claude/hook-overrides.json (gitignored)\n */\nexport interface HookOverrides {\n  /** Hook names to disable entirely */\n  disabled?: string[];\n  /** Per-hook timeout overrides (seconds) */\n  timeouts?: Record<string, number>;\n}\n\n/**\n * Hook registration entry\n */\nexport interface HookRegistration {\n  /** Hook name (e.g., 'permission/auto-approve-readonly') */\n  name: string;\n  /** Hook event type */\n  event: HookEvent;\n  /** Tool matcher (string pattern or regex) */\n  matcher?: string | RegExp;\n  /** Hook implementation function */\n  fn: HookFn;\n}\n\n/**\n * Bash tool input (type guard helper)\n */\nexport interface BashToolInput extends ToolInput {\n  command: string;\n  timeout?: number;\n}\n\n/**\n * Write tool input (type guard helper)\n */\nexport interface WriteToolInput extends ToolInput {\n  file_path: string;\n  content: string;\n}\n\n/**\n * Edit tool input (type guard helper)\n */\nexport interface EditToolInput extends ToolInput {\n  file_path: string;\n  old_string: string;\n  new_string: string;\n}\n\n/**\n * Read tool input (type guard helper)\n */\nexport interface ReadToolInput extends ToolInput {\n  file_path: string;\n  offset?: number;\n  limit?: number;\n}\n\n/**\n * Type guards for tool inputs\n */\nexport function isBashInput(input: ToolInput): input is BashToolInput {\n  return typeof input.command === 'string';\n}\n\nexport function isWriteInput(input: ToolInput): input is WriteToolInput {\n  return typeof input.file_path === 'string' && typeof input.content === 'string';\n}\n\nexport function isEditInput(input: ToolInput): input is EditToolInput {\n  return (\n    typeof input.file_path === 'string' &&\n    typeof input.old_string === 'string' &&\n    typeof input.new_string === 'string'\n  );\n}\n\nexport function isReadInput(input: ToolInput): input is ReadToolInput {\n  return typeof input.file_path === 'string' && input.content === undefined;\n}\n", "/**\n * Common utilities for TypeScript hooks\n * Ported from hooks/_lib/common.sh\n */\n\nimport { appendFileSync, existsSync, statSync, renameSync, mkdirSync, readSync } from 'node:fs';\nimport { execSync } from 'node:child_process';\nimport type { HookResult, HookInput } from '../types.js';\n\n// -----------------------------------------------------------------------------\n// Environment and Paths\n// All functions read env vars dynamically to support testing\n// -----------------------------------------------------------------------------\n\n/**\n * Get the log directory path\n */\nexport function getLogDir(): string {\n  if (process.env.CLAUDE_PLUGIN_ROOT) {\n    return `${process.env.HOME || process.env.USERPROFILE || '/tmp'}/.claude/logs/ork`;\n  }\n  return `${getProjectDir()}/.claude/logs`;\n}\n\n/**\n * Get the project directory\n * Read dynamically to support testing\n */\nexport function getProjectDir(): string {\n  return process.env.CLAUDE_PROJECT_DIR || '.';\n}\n\n/**\n * Get the plugin root directory\n * Read dynamically to support testing\n */\nexport function getPluginRoot(): string {\n  return process.env.CLAUDE_PLUGIN_ROOT || process.env.CLAUDE_PROJECT_DIR || '.';\n}\n\n/**\n * Get the session ID\n * CC 2.1.9+ should guarantee CLAUDE_SESSION_ID availability, but we add\n * a defensive fallback to prevent hook crashes during edge cases.\n * Read dynamically to support testing.\n */\nexport function getSessionId(): string {\n  return process.env.CLAUDE_SESSION_ID || `fallback-${process.pid}-${Date.now()}`;\n}\n\n/**\n * Get cached git branch (set at session start or first call)\n * Caches result in process.env to avoid repeated execSync calls\n */\nexport function getCachedBranch(projectDir?: string): string {\n  if (process.env.ORCHESTKIT_BRANCH) {\n    return process.env.ORCHESTKIT_BRANCH;\n  }\n\n  try {\n    const branch = execSync('git branch --show-current', {\n      cwd: projectDir || getProjectDir(),\n      encoding: 'utf8',\n      timeout: 5000,\n      stdio: ['pipe', 'pipe', 'pipe'],\n    }).trim();\n    process.env.ORCHESTKIT_BRANCH = branch;\n    return branch;\n  } catch {\n    return 'unknown';\n  }\n}\n\n/**\n * Get log level (debug|info|warn|error, default: warn)\n */\nexport function getLogLevel(): string {\n  return process.env.ORCHESTKIT_LOG_LEVEL || 'warn';\n}\n\n/**\n * Check if should log at given level\n */\nexport function shouldLog(level: 'debug' | 'info' | 'warn' | 'error'): boolean {\n  const levels = ['debug', 'info', 'warn', 'error'];\n  return levels.indexOf(level) >= levels.indexOf(getLogLevel());\n}\n\n// -----------------------------------------------------------------------------\n// Output Helpers (CC 2.1.7+ compliant)\n// -----------------------------------------------------------------------------\n\n/**\n * Output silent success - hook completed without errors, no user-visible output\n */\nexport function outputSilentSuccess(): HookResult {\n  return { continue: true, suppressOutput: true };\n}\n\n/**\n * Output silent allow - permission hook approves silently\n */\nexport function outputSilentAllow(): HookResult {\n  return {\n    continue: true,\n    suppressOutput: true,\n    hookSpecificOutput: { permissionDecision: 'allow' },\n  };\n}\n\n/**\n * Output block - stops the operation with an error\n */\nexport function outputBlock(reason: string): HookResult {\n  return {\n    continue: false,\n    stopReason: reason,\n    hookSpecificOutput: {\n      permissionDecision: 'deny',\n      permissionDecisionReason: reason,\n    },\n  };\n}\n\n/**\n * Output with additionalContext - injects context before tool execution (CC 2.1.9)\n * For PostToolUse hooks (hookEventName optional)\n */\nexport function outputWithContext(ctx: string): HookResult {\n  return {\n    continue: true,\n    suppressOutput: true,\n    hookSpecificOutput: {\n      hookEventName: 'PostToolUse',\n      additionalContext: ctx,\n    },\n  };\n}\n\n/**\n * Output with additionalContext for UserPromptSubmit hooks (CC 2.1.9)\n * hookEventName is REQUIRED for UserPromptSubmit\n */\nexport function outputPromptContext(ctx: string): HookResult {\n  return {\n    continue: true,\n    suppressOutput: true,\n    hookSpecificOutput: {\n      hookEventName: 'UserPromptSubmit',\n      additionalContext: ctx,\n    },\n  };\n}\n\n/**\n * Output allow with additionalContext - permission hook approves with context (CC 2.1.9)\n */\nexport function outputAllowWithContext(ctx: string, systemMessage?: string): HookResult {\n  const result: HookResult = {\n    continue: true,\n    hookSpecificOutput: {\n      hookEventName: 'PreToolUse',\n      additionalContext: ctx,\n      permissionDecision: 'allow',\n    },\n  };\n\n  if (systemMessage) {\n    result.systemMessage = systemMessage;\n  } else {\n    result.suppressOutput = true;\n  }\n\n  return result;\n}\n\n/**\n * Output error message - only use when there's an actual problem\n */\nexport function outputError(message: string): HookResult {\n  return { continue: true, systemMessage: message };\n}\n\n/**\n * Output warning message - CC 2.1.7 compliant (no ANSI in JSON)\n */\nexport function outputWarning(message: string): HookResult {\n  return { continue: true, systemMessage: `\\u26a0 ${message}` };\n}\n\n/**\n * Output deny with feedback logging (CC 2.1.7)\n */\nexport function outputDeny(reason: string): HookResult {\n  return {\n    continue: false,\n    stopReason: reason,\n    hookSpecificOutput: {\n      hookEventName: 'PreToolUse',\n      permissionDecision: 'deny',\n      permissionDecisionReason: reason,\n    },\n  };\n}\n\n// -----------------------------------------------------------------------------\n// Logging (with log level guard for performance)\n// -----------------------------------------------------------------------------\n\nconst LOG_ROTATION_MAX_SIZE = 200 * 1024; // 200KB\nconst PERMISSION_LOG_MAX_SIZE = 100 * 1024; // 100KB\n\n/**\n * Rotate log file if it exceeds size limit\n */\nfunction rotateLogFile(logFile: string, maxSize: number): void {\n  if (!existsSync(logFile)) return;\n\n  try {\n    const stats = statSync(logFile);\n    if (stats.size > maxSize) {\n      const rotated = `${logFile}.old.${Date.now()}`;\n      renameSync(logFile, rotated);\n    }\n  } catch {\n    // Ignore rotation errors\n  }\n}\n\n/**\n * Ensure directory exists\n */\nfunction ensureDir(dir: string): void {\n  if (!existsSync(dir)) {\n    mkdirSync(dir, { recursive: true });\n  }\n}\n\n/**\n * Log to hook log file with automatic rotation\n * Respects ORCHESTKIT_LOG_LEVEL (default: warn, skips debug logs in production)\n */\nexport function logHook(hookName: string, message: string, level: 'debug' | 'info' | 'warn' | 'error' = 'debug'): void {\n  // Skip if below log level threshold (big perf win - avoids I/O)\n  if (!shouldLog(level)) {\n    return;\n  }\n\n  const logDir = getLogDir();\n  const logFile = `${logDir}/hooks.log`;\n\n  try {\n    ensureDir(logDir);\n    rotateLogFile(logFile, LOG_ROTATION_MAX_SIZE);\n\n    const timestamp = new Date().toISOString().replace('T', ' ').slice(0, 19);\n    appendFileSync(logFile, `[${timestamp}] [${level.toUpperCase()}] [${hookName}] ${message}\\n`);\n  } catch {\n    // Ignore logging errors - don't block hook execution\n  }\n}\n\n/**\n * Log permission decision for audit trail (CC 2.1.7 feature)\n * Always logs (security audit trail) - not affected by log level\n */\nexport function logPermissionFeedback(\n  decision: 'allow' | 'deny' | 'warn',\n  reason: string,\n  input?: HookInput | Record<string, unknown>\n): void {\n  const logDir = getLogDir();\n  const logFile = `${logDir}/permission-feedback.log`;\n\n  try {\n    ensureDir(logDir);\n    rotateLogFile(logFile, PERMISSION_LOG_MAX_SIZE);\n\n    const timestamp = new Date().toISOString();\n    const toolName = (input as HookInput)?.tool_name || process.env.HOOK_TOOL_NAME || 'unknown';\n    const sessionId = (input as HookInput)?.session_id || getSessionId();\n\n    appendFileSync(\n      logFile,\n      `${timestamp} | ${decision} | ${reason} | tool=${toolName} | session=${sessionId}\\n`\n    );\n  } catch {\n    // Ignore logging errors\n  }\n}\n\n// -----------------------------------------------------------------------------\n// Token Estimation\n// -----------------------------------------------------------------------------\n\n/**\n * Content-aware token estimation (~80% accuracy without external tokenizer).\n * Code-heavy content averages ~2.8 chars/token; prose ~3.5 chars/token.\n */\nexport function estimateTokenCount(content: string): number {\n  if (!content) return 0;\n  const codeIndicators = (content.match(/[{};()=><]/g) || []).length;\n  const codeRatio = codeIndicators / content.length;\n  const charsPerToken = codeRatio > 0.03 ? 2.8 : 3.5;\n  return Math.ceil(content.length / charsPerToken);\n}\n\n// -----------------------------------------------------------------------------\n// Budgeted Output Helpers\n// -----------------------------------------------------------------------------\n\n/**\n * Output prompt context with token budget awareness.\n * Checks if the category is over budget before injecting.\n * Falls back to silent success when budget exhausted.\n *\n * Accepts budget checker and tracker as parameters to avoid circular deps.\n * If not provided, falls back to unchecked injection.\n */\nexport function outputPromptContextBudgeted(\n  ctx: string,\n  hookName: string,\n  category: string,\n  budgetChecker?: { isOverBudget: (cat: string) => boolean },\n  tokenTracker?: { trackTokenUsage: (hook: string, cat: string, tokens: number) => void },\n): HookResult {\n  const tokens = estimateTokenCount(ctx);\n\n  if (budgetChecker && budgetChecker.isOverBudget(category)) {\n    logHook(hookName, `Budget exhausted for ${category}, suppressing ${tokens}t`);\n    return outputSilentSuccess();\n  }\n\n  if (tokenTracker) {\n    tokenTracker.trackTokenUsage(hookName, category, tokens);\n  }\n\n  return outputPromptContext(ctx);\n}\n\n// -----------------------------------------------------------------------------\n// Input Helpers\n// -----------------------------------------------------------------------------\n\n/**\n * Read hook input from stdin synchronously\n * Returns parsed JSON or empty object on failure\n */\nexport function readHookInput(): HookInput {\n  try {\n    // Read from stdin synchronously\n    const chunks: Buffer[] = [];\n    const BUFSIZE = 256;\n    const buf = Buffer.allocUnsafe(BUFSIZE);\n\n    let bytesRead: number;\n    const fd = 0; // stdin\n\n    while (true) {\n      try {\n        bytesRead = readSync(fd, buf, 0, BUFSIZE, null);\n        if (bytesRead === 0) break;\n        chunks.push(Buffer.from(buf.subarray(0, bytesRead)));\n      } catch {\n        break;\n      }\n    }\n\n    const input = Buffer.concat(chunks).toString('utf8').trim();\n    if (!input) {\n      return { tool_name: '', session_id: getSessionId(), tool_input: {} };\n    }\n\n    return JSON.parse(input);\n  } catch {\n    return { tool_name: '', session_id: getSessionId(), tool_input: {} };\n  }\n}\n\n/**\n * Get field from hook input using optional chaining\n */\nexport function getField<T>(input: HookInput, path: string): T | undefined {\n  const parts = path.replace(/^\\./, '').split('.');\n  let value: unknown = input;\n\n  for (const part of parts) {\n    if (value === null || value === undefined) return undefined;\n    value = (value as Record<string, unknown>)[part];\n  }\n\n  return value as T;\n}\n\n// -----------------------------------------------------------------------------\n// String Utilities\n// -----------------------------------------------------------------------------\n\n/**\n * Normalize command: remove line continuations and collapse whitespace\n * Prevents bypassing detection with backslash-newline tricks (CC 2.1.6 fix)\n */\nexport function normalizeCommand(command: string): string {\n  return command\n    .replace(/\\\\\\s*[\\r\\n]+/g, ' ') // Remove line continuations\n    .replace(/\\n/g, ' ') // Replace newlines with spaces\n    .replace(/\\s+/g, ' ') // Collapse whitespace\n    .trim();\n}\n\n/**\n * Escape string for use in regex\n */\nexport function escapeRegex(str: string): string {\n  return str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\n", "/**\n * Git utilities for TypeScript hooks\n * Ported from hooks/_lib/common.sh git functions\n */\n\nimport { execSync } from 'node:child_process';\nimport { getProjectDir } from './common.js';\n\n/**\n * Get the current git branch\n */\nexport function getCurrentBranch(projectDir?: string): string {\n  const dir = projectDir || getProjectDir();\n  try {\n    return execSync('git branch --show-current', {\n      cwd: dir,\n      encoding: 'utf8',\n      timeout: 5000,\n      stdio: ['pipe', 'pipe', 'pipe'],\n    }).trim();\n  } catch {\n    return 'unknown';\n  }\n}\n\n/**\n * Check if on a protected branch (dev, main, master)\n */\nexport function isProtectedBranch(branch?: string): boolean {\n  const currentBranch = branch || getCurrentBranch();\n  return ['dev', 'main', 'master'].includes(currentBranch);\n}\n\n/**\n * Get the repository root directory\n */\nexport function getRepoRoot(projectDir?: string): string {\n  const dir = projectDir || getProjectDir();\n  try {\n    return execSync('git rev-parse --show-toplevel', {\n      cwd: dir,\n      encoding: 'utf8',\n      timeout: 5000,\n      stdio: ['pipe', 'pipe', 'pipe'],\n    }).trim();\n  } catch {\n    return dir;\n  }\n}\n\n/**\n * Check if path is inside a git repository\n */\nexport function isGitRepo(projectDir?: string): boolean {\n  const dir = projectDir || getProjectDir();\n  try {\n    execSync('git rev-parse --git-dir', {\n      cwd: dir,\n      encoding: 'utf8',\n      timeout: 5000,\n      stdio: ['pipe', 'pipe', 'pipe'],\n    });\n    return true;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Get git status (short format)\n */\nexport function getGitStatus(projectDir?: string): string {\n  const dir = projectDir || getProjectDir();\n  try {\n    return execSync('git status --short', {\n      cwd: dir,\n      encoding: 'utf8',\n      timeout: 10000,\n      stdio: ['pipe', 'pipe', 'pipe'],\n    }).trim();\n  } catch {\n    return '';\n  }\n}\n\n/**\n * Check if there are uncommitted changes\n */\nexport function hasUncommittedChanges(projectDir?: string): boolean {\n  return getGitStatus(projectDir).length > 0;\n}\n\n/**\n * Get the default branch (main or master)\n */\nexport function getDefaultBranch(projectDir?: string): string {\n  const dir = projectDir || getProjectDir();\n  try {\n    // Check if 'main' exists\n    execSync('git rev-parse --verify main', {\n      cwd: dir,\n      encoding: 'utf8',\n      timeout: 5000,\n      stdio: ['pipe', 'pipe', 'pipe'],\n    });\n    return 'main';\n  } catch {\n    try {\n      // Check if 'master' exists\n      execSync('git rev-parse --verify master', {\n        cwd: dir,\n        encoding: 'utf8',\n        timeout: 5000,\n        stdio: ['pipe', 'pipe', 'pipe'],\n      });\n      return 'master';\n    } catch {\n      return 'main'; // Default to main\n    }\n  }\n}\n\n/**\n * Extract issue number from branch name\n * Supports patterns like: issue/123-description, feature/123, fix-123\n */\nexport function extractIssueNumber(branch: string): number | null {\n  // Match common patterns\n  const patterns = [\n    /issue\\/(\\d+)/i,\n    /feature\\/(\\d+)/i,\n    /fix\\/(\\d+)/i,\n    /bug\\/(\\d+)/i,\n    /feat\\/(\\d+)/i,\n    /^(\\d+)-/,\n    /-(\\d+)$/,\n    /#(\\d+)/,\n  ];\n\n  for (const pattern of patterns) {\n    const match = branch.match(pattern);\n    if (match) {\n      return parseInt(match[1], 10);\n    }\n  }\n\n  return null;\n}\n\n/**\n * Validate branch name format\n * Returns error message if invalid, null if valid\n */\nexport function validateBranchName(branch: string): string | null {\n  // Skip validation for protected branches\n  if (isProtectedBranch(branch)) {\n    return null;\n  }\n\n  // Valid prefixes\n  const validPrefixes = [\n    'issue/',\n    'feature/',\n    'fix/',\n    'bug/',\n    'feat/',\n    'chore/',\n    'docs/',\n    'refactor/',\n    'test/',\n    'ci/',\n    'perf/',\n    'style/',\n    'release/',\n    'hotfix/',\n  ];\n\n  const hasValidPrefix = validPrefixes.some((prefix) => branch.startsWith(prefix));\n  if (!hasValidPrefix) {\n    return `Branch name should start with a valid prefix: ${validPrefixes.join(', ')}`;\n  }\n\n  // Check for issue number in issue/ branches\n  if (branch.startsWith('issue/') && !extractIssueNumber(branch)) {\n    return 'issue/ branches should include an issue number (e.g., issue/123-description)';\n  }\n\n  return null;\n}\n", "/**\n * Self-guard helpers for TypeScript hooks\n * Ported from hooks/_lib/common.sh guard functions\n *\n * Guards are predicates that determine if a hook should run.\n * They return `true` to run the hook, `false` to skip it.\n */\n\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess } from './common.js';\n\n/**\n * Guard result type - either continue (null) or skip with result\n */\nexport type GuardResult = HookResult | null;\n\n/**\n * Create a guard that returns silent success if predicate fails\n */\nexport function createGuard(\n  predicate: (input: HookInput) => boolean\n): (input: HookInput) => GuardResult {\n  return (input: HookInput) => (predicate(input) ? null : outputSilentSuccess());\n}\n\n// -----------------------------------------------------------------------------\n// File Extension Guards\n// -----------------------------------------------------------------------------\n\n/**\n * Guard: Only run for specific file extensions\n */\nexport function guardFileExtension(\n  input: HookInput,\n  ...extensions: string[]\n): GuardResult {\n  const filePath = input.tool_input.file_path;\n  if (!filePath) return outputSilentSuccess();\n\n  const ext = filePath.split('.').pop()?.toLowerCase() || '';\n  const normalizedExtensions = extensions.map((e) => e.toLowerCase().replace(/^\\./, ''));\n\n  if (normalizedExtensions.includes(ext)) {\n    return null; // Continue with hook\n  }\n\n  return outputSilentSuccess();\n}\n\n/**\n * Guard: Only run for code files\n */\nexport function guardCodeFiles(input: HookInput): GuardResult {\n  return guardFileExtension(input, 'py', 'ts', 'tsx', 'js', 'jsx', 'go', 'rs', 'java');\n}\n\n/**\n * Guard: Only run for Python files\n */\nexport function guardPythonFiles(input: HookInput): GuardResult {\n  return guardFileExtension(input, 'py');\n}\n\n/**\n * Guard: Only run for TypeScript/JavaScript files\n */\nexport function guardTypescriptFiles(input: HookInput): GuardResult {\n  return guardFileExtension(input, 'ts', 'tsx', 'js', 'jsx');\n}\n\n// -----------------------------------------------------------------------------\n// Path Pattern Guards\n// -----------------------------------------------------------------------------\n\n/**\n * Guard: Only run for test files\n */\nexport function guardTestFiles(input: HookInput): GuardResult {\n  const filePath = input.tool_input.file_path;\n  if (!filePath) return outputSilentSuccess();\n\n  const testPatterns = [/test/i, /spec/i, /__tests__/i];\n  if (testPatterns.some((p) => p.test(filePath))) {\n    return null; // Continue with hook\n  }\n\n  return outputSilentSuccess();\n}\n\n/**\n * Guard: Skip internal/generated files\n */\nexport function guardSkipInternal(input: HookInput): GuardResult {\n  const filePath = input.tool_input.file_path || '';\n  if (!filePath) return null; // No file path, continue\n\n  // Skip these directories/patterns\n  const skipPatterns = [\n    /\\/\\.claude\\//,\n    /\\/node_modules\\//,\n    /\\/\\.git\\//,\n    /\\/dist\\//,\n    /\\/build\\//,\n    /\\/__pycache__\\//,\n    /\\/\\.venv\\//,\n    /\\/venv\\//,\n    /\\.lock$/,\n  ];\n\n  if (skipPatterns.some((p) => p.test(filePath))) {\n    return outputSilentSuccess();\n  }\n\n  return null; // Continue with hook\n}\n\n/**\n * Guard: Only run for files matching path patterns\n */\nexport function guardPathPattern(input: HookInput, ...patterns: (string | RegExp)[]): GuardResult {\n  const filePath = input.tool_input.file_path;\n  if (!filePath) return outputSilentSuccess();\n\n  for (const pattern of patterns) {\n    if (typeof pattern === 'string') {\n      // Simple glob-like matching\n      const regex = new RegExp(pattern.replace(/\\*/g, '.*').replace(/\\?/g, '.'));\n      if (regex.test(filePath)) return null;\n    } else {\n      if (pattern.test(filePath)) return null;\n    }\n  }\n\n  return outputSilentSuccess();\n}\n\n// -----------------------------------------------------------------------------\n// Tool Guards\n// -----------------------------------------------------------------------------\n\n/**\n * Guard: Only run for specific tool names\n */\nexport function guardTool(input: HookInput, ...tools: string[]): GuardResult {\n  const toolName = input.tool_name;\n  if (!toolName) return outputSilentSuccess();\n\n  if (tools.includes(toolName)) {\n    return null; // Continue with hook\n  }\n\n  return outputSilentSuccess();\n}\n\n/**\n * Guard: Only run for Write or Edit tools\n */\nexport function guardWriteEdit(input: HookInput): GuardResult {\n  return guardTool(input, 'Write', 'Edit');\n}\n\n/**\n * Guard: Only run for Bash tool\n */\nexport function guardBash(input: HookInput): GuardResult {\n  return guardTool(input, 'Bash');\n}\n\n// -----------------------------------------------------------------------------\n// Command Guards\n// -----------------------------------------------------------------------------\n\n/**\n * Guard: Only run for non-trivial bash commands\n */\nexport function guardNontrivialBash(input: HookInput): GuardResult {\n  const command = input.tool_input.command || '';\n\n  // Skip trivial commands\n  const trivialPatterns = [\n    /^echo\\s/,\n    /^ls(\\s|$)/,\n    /^pwd$/,\n    /^cat\\s/,\n    /^head\\s/,\n    /^tail\\s/,\n    /^wc\\s/,\n    /^date$/,\n    /^whoami$/,\n  ];\n\n  if (trivialPatterns.some((p) => p.test(command))) {\n    return outputSilentSuccess();\n  }\n\n  return null; // Continue with hook\n}\n\n/**\n * Guard: Only run for git commands\n */\nexport function guardGitCommand(input: HookInput): GuardResult {\n  const command = input.tool_input.command || '';\n\n  if (command.startsWith('git')) {\n    return null; // Continue with hook\n  }\n\n  return outputSilentSuccess();\n}\n\n// -----------------------------------------------------------------------------\n// Environment Guards\n// -----------------------------------------------------------------------------\n\n/**\n * Guard: Only run if multi-instance coordination is enabled\n */\nexport function guardMultiInstance(input: HookInput): GuardResult {\n  const projectDir = input.project_dir || process.env.CLAUDE_PROJECT_DIR || '.';\n  const dbPath = `${projectDir}/.claude/coordination/.claude.db`;\n\n  try {\n    const { existsSync } = require('node:fs');\n    if (existsSync(dbPath)) {\n      return null; // Continue with hook\n    }\n  } catch {\n    // Ignore errors\n  }\n\n  return outputSilentSuccess();\n}\n\n// -----------------------------------------------------------------------------\n// Composite Guards\n// -----------------------------------------------------------------------------\n\n/**\n * Run multiple guards in sequence, return first skip result or null to continue\n */\nexport function runGuards(input: HookInput, ...guards: ((input: HookInput) => GuardResult)[]): GuardResult {\n  for (const guard of guards) {\n    const result = guard(input);\n    if (result !== null) {\n      return result; // Skip with this result\n    }\n  }\n  return null; // All guards passed, continue\n}\n", "/**\n * Backend File Naming Hook\n * BLOCKING: Backend files must follow naming conventions\n * CC 2.1.7 Compliant\n */\n\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, outputBlock, logHook } from '../lib/common.js';\nimport { guardPythonFiles } from '../lib/guards.js';\n\n/**\n * Validate backend Python file naming conventions\n */\nexport function backendFileNaming(input: HookInput): HookResult {\n  // Self-guard: Only run for Python files\n  const guard = guardPythonFiles(input);\n  if (guard) return guard;\n\n  const filePath = input.tool_input.file_path;\n  if (!filePath) return outputSilentSuccess();\n\n  // Skip if not in an app/ or backend/ directory\n  if (!filePath.includes('/app/') && !filePath.includes('/backend/')) {\n    return outputSilentSuccess();\n  }\n\n  const filename = filePath.split('/').pop() || '';\n  const dirname = filePath.substring(0, filePath.lastIndexOf('/'));\n  const errors: string[] = [];\n\n  // Skip __init__.py files\n  if (filename === '__init__.py') return outputSilentSuccess();\n\n  // Router naming conventions\n  if (dirname.endsWith('/routers') || dirname.includes('/routers/')) {\n    const validRouterPattern = /^(router_|routes_|api_).*\\.py$/;\n    const utilPattern = /^(deps|dependencies|utils|helpers|base)\\.py$/;\n    if (!validRouterPattern.test(filename) && !utilPattern.test(filename)) {\n      errors.push('ROUTER NAMING: Files in routers/ must be prefixed');\n      errors.push(`  Got: ${filename}`);\n      errors.push('  Expected: router_*.py, routes_*.py, api_*.py, deps.py');\n    }\n  }\n\n  // Service naming conventions\n  if (dirname.endsWith('/services') || dirname.includes('/services/')) {\n    const validServicePattern = /_service\\.py$/;\n    const utilPattern = /^(base|utils|helpers|abstract)\\.py$/;\n    if (!validServicePattern.test(filename) && !utilPattern.test(filename)) {\n      errors.push('SERVICE NAMING: Files in services/ must end with _service.py');\n      errors.push(`  Got: ${filename}`);\n      errors.push('  Expected: *_service.py, base.py, utils.py');\n    }\n  }\n\n  // Repository naming conventions\n  if (dirname.endsWith('/repositories') || dirname.includes('/repositories/')) {\n    const validRepoPattern = /_(repository|repo)\\.py$/;\n    const utilPattern = /^(base|abstract|utils)\\.py$/;\n    if (!validRepoPattern.test(filename) && !utilPattern.test(filename)) {\n      errors.push('REPOSITORY NAMING: Files in repositories/ must end with _repository.py');\n      errors.push(`  Got: ${filename}`);\n      errors.push('  Expected: *_repository.py, *_repo.py, base.py');\n    }\n  }\n\n  // Schema naming conventions\n  if (dirname.endsWith('/schemas') || dirname.includes('/schemas/')) {\n    const validSchemaPattern = /_(schema|dto|request|response)\\.py$/;\n    const utilPattern = /^(base|common|shared|utils)\\.py$/;\n    if (!validSchemaPattern.test(filename) && !utilPattern.test(filename)) {\n      errors.push('SCHEMA NAMING: Files in schemas/ must use proper suffix');\n      errors.push(`  Got: ${filename}`);\n      errors.push('  Expected: *_schema.py, *_dto.py, *_request.py, *_response.py');\n    }\n  }\n\n  // Model naming conventions\n  if (dirname.endsWith('/models') || dirname.includes('/models/')) {\n    const validModelPattern = /_(model|entity|orm)\\.py$/;\n    const utilPattern = /^(base|abstract|mixins)\\.py$/;\n    if (!validModelPattern.test(filename) && !utilPattern.test(filename)) {\n      errors.push('MODEL NAMING: Files in models/ must use proper suffix');\n      errors.push(`  Got: ${filename}`);\n      errors.push('  Expected: *_model.py, *_entity.py, *_orm.py, base.py');\n    }\n  }\n\n  // General Python naming conventions - PascalCase check\n  if (/^[A-Z][a-zA-Z]+\\.py$/.test(filename)) {\n    errors.push('NAMING: Python files should use snake_case, not PascalCase');\n    errors.push(`  Got: ${filename}`);\n  }\n\n  // Report errors and block\n  if (errors.length > 0) {\n    const reason = `Backend naming violation in ${filename}: ${errors[0]}`;\n    logHook('backend-file-naming', `BLOCKED: ${reason}`);\n    return outputBlock(reason);\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Unified Decision Processor Hook\n * Consolidates: mem0-decision-saver + decision-entity-extractor\n *\n * Hook: SkillComplete\n *\n * Purpose:\n * 1. Extract decisions from skill output\n * 2. Extract entities (Agent, Technology, Pattern) for graph memory\n * 3. Suggest mem0 storage with enriched metadata\n *\n * CC 2.1.16 Compliant - Enriched metadata for decision-history\n * Version: 2.0.0 - Consolidated from 2 hooks (~520 LOC \u2192 ~250 LOC)\n */\n\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, getPluginRoot } from '../lib/common.js';\nimport { execSync } from 'child_process';\nimport { readFileSync, existsSync } from 'fs';\nimport { join } from 'path';\n\n// =============================================================================\n// CONSTANTS\n// =============================================================================\n\nconst MIN_OUTPUT_LENGTH = 100;\nconst MAX_TEXT_LENGTH = 10240;\n\n// Decision indicators\nconst DECISION_INDICATORS = [\n  'decided', 'chose', 'selected', 'will use', 'implemented',\n  'architecture:', 'pattern:', 'approach:', 'recommendation:',\n  'best practice:', 'conclusion:',\n];\n\n// Known OrchestKit agents\nconst KNOWN_AGENTS = [\n  'database-engineer', 'backend-system-architect', 'frontend-ui-developer',\n  'security-auditor', 'test-generator', 'workflow-architect', 'llm-integrator',\n  'data-pipeline-engineer', 'metrics-architect', 'ux-researcher',\n  'ci-cd-engineer', 'infrastructure-architect', 'accessibility-specialist',\n];\n\n// Known technologies\nconst KNOWN_TECHNOLOGIES = [\n  'postgresql', 'postgres', 'pgvector', 'redis', 'mongodb', 'sqlite',\n  'fastapi', 'django', 'flask', 'express', 'nextjs',\n  'react', 'vue', 'angular', 'typescript', 'python',\n  'jwt', 'oauth', 'passkeys', 'langchain', 'langgraph', 'langfuse',\n  'docker', 'kubernetes', 'terraform', 'aws', 'gcp',\n  'pytest', 'jest', 'vitest', 'playwright', 'msw',\n];\n\n// Known patterns\nconst KNOWN_PATTERNS = [\n  'cursor-pagination', 'repository-pattern', 'service-layer', 'clean-architecture',\n  'dependency-injection', 'event-sourcing', 'cqrs', 'saga-pattern',\n  'circuit-breaker', 'rate-limiting', 'optimistic-locking',\n  'caching', 'cache-aside', 'rag', 'semantic-search',\n];\n\n// Best practice patterns (precompiled)\nconst BEST_PRACTICE_PATTERNS: [string, RegExp][] = [\n  ['cursor-pagination', /cursor[- ]?(based)?[- ]?pagination/i],\n  ['jwt-validation', /jwt|json web token/i],\n  ['dependency-injection', /dependency injection|di pattern|ioc/i],\n  ['rate-limiting', /rate[- ]?limit|throttl/i],\n  ['circuit-breaker', /circuit[- ]?breaker|resilience/i],\n  ['event-sourcing', /event[- ]?sourc/i],\n  ['cqrs', /cqrs|command.*query.*separation/i],\n  ['idempotency', /idempoten/i],\n];\n\n// Importance keywords\nconst HIGH_IMPORTANCE = ['critical', 'security', 'breaking', 'migration', 'architecture', 'production'];\nconst MEDIUM_IMPORTANCE = ['refactor', 'optimize', 'improve', 'update', 'enhance', 'fix'];\n\n// =============================================================================\n// TYPES\n// =============================================================================\n\ninterface ExtractedEntities {\n  agents: string[];\n  technologies: string[];\n  patterns: string[];\n}\n\n// =============================================================================\n// VERSION DETECTION\n// =============================================================================\n\nlet cachedPluginVersion: string | null = null;\n\nfunction getCCVersion(): string {\n  if (process.env.CLAUDE_CODE_VERSION) return process.env.CLAUDE_CODE_VERSION;\n  try {\n    const output = execSync('claude --version 2>/dev/null', { encoding: 'utf-8', timeout: 2000 });\n    const match = output.match(/(\\d+\\.\\d+\\.\\d+)/);\n    if (match) return match[1];\n  } catch { /* ignore */ }\n  return '2.1.16';\n}\n\nfunction getPluginVersion(): string {\n  if (cachedPluginVersion) return cachedPluginVersion;\n  try {\n    const pluginRoot = getPluginRoot();\n    const path = join(pluginRoot, '.claude-plugin', 'plugin.json');\n    if (existsSync(path)) {\n      const content = JSON.parse(readFileSync(path, 'utf-8'));\n      cachedPluginVersion = (content.version as string) || 'unknown';\n      return cachedPluginVersion;\n    }\n  } catch { /* ignore */ }\n  cachedPluginVersion = 'unknown';\n  return cachedPluginVersion;\n}\n\n// =============================================================================\n// ENTITY EXTRACTION\n// =============================================================================\n\nfunction extractEntities(text: string): ExtractedEntities {\n  const textLower = text.toLowerCase();\n  return {\n    agents: [...new Set(KNOWN_AGENTS.filter(a => textLower.includes(a)))],\n    technologies: [...new Set(KNOWN_TECHNOLOGIES.filter(t => textLower.includes(t)))],\n    patterns: [...new Set(KNOWN_PATTERNS.filter(p => textLower.includes(p)))],\n  };\n}\n\nfunction detectRelationType(text: string): string {\n  const t = text.toLowerCase();\n  if (/recommend|suggests|advises/.test(t)) return 'RECOMMENDS';\n  if (/chose|selected|decided/.test(t)) return 'CHOSEN_FOR';\n  if (/replace|instead of/.test(t)) return 'REPLACES';\n  if (/conflict|incompatible/.test(t)) return 'CONFLICTS_WITH';\n  return 'RELATES_TO';\n}\n\n// =============================================================================\n// DECISION EXTRACTION\n// =============================================================================\n\nfunction hasDecisionContent(output: string): boolean {\n  const lower = output.toLowerCase();\n  return DECISION_INDICATORS.some(ind => lower.includes(ind));\n}\n\nfunction extractDecisions(output: string): string[] {\n  const decisions: string[] = [];\n  for (const indicator of DECISION_INDICATORS) {\n    const regex = new RegExp(`[^\\\\n]*${indicator}[^\\\\n]*`, 'gi');\n    const matches = output.match(regex);\n    if (matches) {\n      for (const match of matches.slice(0, 3)) {\n        const cleaned = match.trim().slice(0, 300);\n        if (cleaned.length > 30) decisions.push(cleaned);\n      }\n    }\n  }\n  return [...new Set(decisions)].slice(0, 5);\n}\n\nfunction detectCategory(text: string): string {\n  const t = text.slice(0, MAX_TEXT_LENGTH).toLowerCase();\n  if (/pagination|cursor|offset/.test(t)) return 'pagination';\n  if (/security|vulnerability|owasp/.test(t)) return 'security';\n  if (/database|sql|postgres|schema/.test(t)) return 'database';\n  if (/api|endpoint|rest|graphql/.test(t)) return 'api';\n  if (/auth|login|jwt|oauth/.test(t)) return 'authentication';\n  if (/test|pytest|jest|vitest/.test(t)) return 'testing';\n  if (/deploy|ci|cd|docker|kubernetes/.test(t)) return 'deployment';\n  if (/monitoring|logging|tracing|metrics/.test(t)) return 'observability';\n  if (/react|frontend|ui|tailwind/.test(t)) return 'frontend';\n  if (/llm|rag|embedding|langchain/.test(t)) return 'ai-ml';\n  if (/architecture|design|pattern/.test(t)) return 'architecture';\n  return 'decision';\n}\n\nfunction detectImportance(text: string): 'high' | 'medium' | 'low' {\n  const t = text.toLowerCase();\n  if (HIGH_IMPORTANCE.some(k => t.includes(k))) return 'high';\n  if (MEDIUM_IMPORTANCE.some(k => t.includes(k))) return 'medium';\n  return 'low';\n}\n\nfunction extractBestPractice(text: string): string | null {\n  for (const [name, pattern] of BEST_PRACTICE_PATTERNS) {\n    if (pattern.test(text)) return name;\n  }\n  return null;\n}\n\n// =============================================================================\n// MAIN HOOK\n// =============================================================================\n\nexport function decisionProcessor(input: HookInput): HookResult {\n  const skillName = (input as any).skill_name || input.tool_input?.skill || '';\n  const toolResult = input.tool_result;\n  const skillOutput = typeof toolResult === 'string'\n    ? toolResult\n    : (toolResult?.content || (input as any).output || '');\n\n  if (!skillOutput || skillOutput.length < MIN_OUTPUT_LENGTH) {\n    return outputSilentSuccess();\n  }\n\n  if (!hasDecisionContent(skillOutput)) {\n    return outputSilentSuccess();\n  }\n\n  // Extract decisions and entities\n  const decisions = extractDecisions(skillOutput);\n  const entities = extractEntities(skillOutput);\n  const totalEntities = entities.agents.length + entities.technologies.length + entities.patterns.length;\n\n  if (decisions.length === 0 && totalEntities === 0) {\n    return outputSilentSuccess();\n  }\n\n  // Build output message\n  const parts: string[] = [];\n  const firstDecision = decisions[0] || skillOutput.slice(0, 200);\n  const category = detectCategory(firstDecision);\n\n  // Decision extraction section\n  if (decisions.length > 0) {\n    const importance = detectImportance(firstDecision);\n    const bestPractice = extractBestPractice(firstDecision);\n    const ccVersion = getCCVersion();\n    const pluginVersion = getPluginVersion();\n\n    const metadata: Record<string, unknown> = {\n      category,\n      source: 'orchestkit-plugin',\n      skill: skillName || 'unknown',\n      cc_version: ccVersion,\n      plugin_version: pluginVersion,\n      importance,\n      timestamp: new Date().toISOString(),\n    };\n    if (bestPractice) metadata.best_practice = bestPractice;\n\n    const pluginRoot = getPluginRoot();\n    const scriptPath = `${pluginRoot}/skills/mem0-memory/scripts/crud/add-memory.py`;\n\n    parts.push(`[Decisions] Found ${decisions.length} decisions (category: ${category}, importance: ${importance})\n\nTo persist to mem0:\nbash ${scriptPath} --text \"<decision>\" --user-id \"orchestkit:all-agents\" --metadata '${JSON.stringify(metadata)}' --enable-graph\n\nExample: \"${firstDecision.slice(0, 100)}...\"`);\n  }\n\n  // Entity extraction section\n  if (totalEntities > 0) {\n    const relationType = detectRelationType(skillOutput);\n    const entityList = [\n      ...entities.agents.map(a => ({ name: a, entityType: 'Agent', observations: [`Agent: ${a}`] })),\n      ...entities.technologies.map(t => ({ name: t, entityType: 'Technology', observations: [`Tech: ${t}`] })),\n      ...entities.patterns.map(p => ({ name: p, entityType: 'Pattern', observations: [`Pattern: ${p}`] })),\n    ];\n\n    parts.push(`[Entities] Found ${totalEntities} entities for graph memory:\n- Agents: ${entities.agents.length}\n- Technologies: ${entities.technologies.length}\n- Patterns: ${entities.patterns.length}\n\nmcp__memory__create_entities with:\nentities: ${JSON.stringify(entityList.slice(0, 5))}\n\nRelation type: ${relationType}`);\n  }\n\n  return {\n    continue: true,\n    systemMessage: parts.join('\\n\\n'),\n  };\n}\n", "/**\n * Backend Layer Validator Hook\n * BLOCKING: Enforce layer separation in FastAPI\n * CC 2.1.7 Compliant\n */\n\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, outputBlock, logHook } from '../lib/common.js';\nimport { guardPythonFiles } from '../lib/guards.js';\n\n/**\n * Validate FastAPI layer architecture rules\n */\nexport function backendLayerValidator(input: HookInput): HookResult {\n  // Self-guard: Only run for Python files\n  const guard = guardPythonFiles(input);\n  if (guard) return guard;\n\n  const filePath = input.tool_input.file_path;\n  const content = input.tool_input.content || (input as any).tool_result || '';\n\n  if (!filePath || !content) return outputSilentSuccess();\n\n  const errors: string[] = [];\n\n  // Router layer violations\n  if (filePath.includes('/routers/')) {\n    // Rule: No direct database operations in routers\n    if (/db\\.(add|delete|commit|flush|rollback|refresh|execute|scalar)/.test(content)) {\n      errors.push('DATABASE: Direct database operations not allowed in routers');\n    }\n\n    // Rule: No SQLAlchemy imports\n    if (/^from sqlalchemy import/m.test(content)) {\n      errors.push('IMPORT: SQLAlchemy imports not allowed in routers');\n    }\n  }\n\n  // Service layer violations\n  if (filePath.includes('/services/')) {\n    // Rule: No HTTP exception handling\n    if (/HTTPException\\s*\\(/.test(content)) {\n      errors.push('HTTP: HTTPException not allowed in services - use domain exceptions');\n    }\n\n    // Rule: No FastAPI Request/Response objects\n    if (/from fastapi import.*(Request|Response)/.test(content)) {\n      errors.push('HTTP: Request/Response types not allowed in services');\n    }\n  }\n\n  // Repository layer violations\n  if (filePath.includes('/repositories/')) {\n    // Rule: No HTTP exceptions\n    if (/HTTPException/.test(content)) {\n      errors.push('HTTP: HTTPException not allowed in repositories');\n    }\n\n    // Rule: No service/router imports\n    if (/from.*(services|routers).*import/.test(content)) {\n      errors.push('IMPORT: Repositories cannot import from services or routers');\n    }\n  }\n\n  // Report errors\n  if (errors.length > 0) {\n    const filename = filePath.split('/').pop() || filePath;\n    const reason = `Layer violation in ${filename}: ${errors[0]}`;\n    logHook('backend-layer-validator', `BLOCKED: ${reason}`);\n    return outputBlock(reason);\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Coverage Check Hook\n * Runs on Stop for testing skills - checks if coverage threshold is met\n * CC 2.1.7 Compliant - Silent operation\n */\n\nimport { existsSync, appendFileSync, mkdirSync, readFileSync } from 'node:fs';\nimport { execSync } from 'node:child_process';\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, getLogDir, getProjectDir } from '../lib/common.js';\n\n/**\n * Check coverage threshold on stop\n */\nexport function coverageCheck(_input: HookInput): HookResult {\n  const projectDir = getProjectDir();\n  const logDir = getLogDir();\n  const logFile = `${logDir}/coverage-check.log`;\n  const threshold = parseInt(process.env.COVERAGE_THRESHOLD || '80', 10);\n\n  // Ensure log directory exists\n  try {\n    mkdirSync(logDir, { recursive: true });\n  } catch {\n    // Ignore\n  }\n\n  const logLines: string[] = [];\n  const timestamp = new Date().toISOString().replace('T', ' ').slice(0, 19);\n  logLines.push(`[${timestamp}] Coverage Check`);\n\n  // Check Python coverage\n  const coverageFile = `${projectDir}/.coverage`;\n  const coverageXml = `${projectDir}/coverage.xml`;\n\n  if (existsSync(coverageFile) || existsSync(coverageXml)) {\n    try {\n      const result = execSync('coverage report --fail-under=0', {\n        cwd: projectDir,\n        encoding: 'utf8',\n        timeout: 30000,\n        stdio: ['pipe', 'pipe', 'pipe'],\n      });\n\n      const totalLine = result.split('\\n').find((line) => line.includes('TOTAL'));\n      if (totalLine) {\n        const match = totalLine.match(/(\\d+)%/);\n        if (match) {\n          const coverage = parseInt(match[1], 10);\n          logLines.push(`Python coverage: ${coverage}%`);\n          if (coverage < threshold) {\n            logLines.push(`WARNING: Coverage ${coverage}% is below threshold ${threshold}%`);\n          } else {\n            logLines.push('Coverage meets threshold');\n          }\n        }\n      }\n    } catch {\n      // coverage command not available or failed\n    }\n  }\n\n  // Check JS/TS coverage\n  const coverageDir = `${projectDir}/coverage`;\n  if (existsSync(coverageDir)) {\n    const summaryFile = `${coverageDir}/coverage-summary.json`;\n    if (existsSync(summaryFile)) {\n      logLines.push('');\n      logLines.push('JavaScript/TypeScript coverage report found');\n      logLines.push('Check coverage/lcov-report/index.html for details');\n    }\n  }\n\n  // Write to log file\n  try {\n    appendFileSync(logFile, logLines.join('\\n') + '\\n');\n  } catch {\n    // Ignore logging errors\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Coverage Threshold Gate Hook\n * BLOCKING: Coverage must meet threshold after implementation\n * CC 2.1.7 Compliant\n */\n\nimport { existsSync, readFileSync } from 'node:fs';\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, outputBlock, getProjectDir } from '../lib/common.js';\n\nconst COVERAGE_PATHS = [\n  // JavaScript/TypeScript (Jest, Vitest, c8)\n  'coverage/coverage-summary.json',\n  'coverage/coverage-final.json',\n  '.vitest/coverage/coverage-summary.json',\n  // Python (coverage.py, pytest-cov)\n  'coverage.json',\n  '.coverage.json',\n  'htmlcov/status.json',\n];\n\n/**\n * Parse coverage from various file formats\n */\nfunction parseCoverage(filePath: string, content: string): number | null {\n  try {\n    const data = JSON.parse(content);\n\n    // Jest/Vitest coverage-summary.json format\n    if (filePath.includes('coverage-summary.json')) {\n      return data?.total?.lines?.pct ?? data?.total?.statements?.pct ?? null;\n    }\n\n    // coverage.py JSON format\n    if (filePath.includes('coverage.json')) {\n      return data?.totals?.percent_covered ?? null;\n    }\n\n    // Try generic pct field\n    if (data?.total?.pct !== undefined) {\n      return data.total.pct;\n    }\n\n    return null;\n  } catch {\n    return null;\n  }\n}\n\n/**\n * Check coverage threshold gate\n */\nexport function coverageThresholdGate(_input: HookInput): HookResult {\n  const projectDir = getProjectDir();\n  const threshold = parseInt(process.env.COVERAGE_THRESHOLD || '80', 10);\n\n  // Find coverage file\n  let coverageFile = '';\n  let coverageContent = '';\n\n  for (const path of COVERAGE_PATHS) {\n    const fullPath = `${projectDir}/${path}`;\n    if (existsSync(fullPath)) {\n      coverageFile = fullPath;\n      try {\n        coverageContent = readFileSync(fullPath, 'utf8');\n      } catch {\n        continue;\n      }\n      break;\n    }\n  }\n\n  // No coverage file = skip (coverage might not be configured yet)\n  if (!coverageFile || !coverageContent) {\n    return outputSilentSuccess();\n  }\n\n  // Parse coverage\n  const coverage = parseCoverage(coverageFile, coverageContent);\n  if (coverage === null) {\n    return outputSilentSuccess();\n  }\n\n  // Check threshold\n  const coverageInt = Math.floor(coverage);\n  if (coverageInt < threshold) {\n    const reason = `BLOCKED: Coverage ${coverage}% is below threshold ${threshold}%\n\nCoverage report: ${coverageFile}\n\nActions required:\n  1. Identify uncovered code paths\n  2. Add tests for critical business logic\n  3. Re-run tests with coverage:\n\n     TypeScript: npm test -- --coverage\n     Python:     pytest --cov=app --cov-report=term-missing\n\n  4. Ensure coverage >= ${threshold}% before proceeding\n\nTip: Focus on testing:\n  - Business logic (services, utils)\n  - Edge cases and error handling\n  - Critical user flows`;\n\n    return outputBlock(reason);\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Cross-Instance Test Validator Hook\n * BLOCKING: Ensure test coverage when code is split across instances\n * CC 2.1.7 Compliant\n */\n\nimport { existsSync, readFileSync, readdirSync, statSync } from 'node:fs';\nimport { execSync } from 'node:child_process';\nimport type { HookInput, HookResult } from '../types.js';\nimport {\n  outputSilentSuccess,\n  outputBlock,\n  outputWithContext,\n  getProjectDir,\n} from '../lib/common.js';\nimport { getRepoRoot } from '../lib/git.js';\n\n/**\n * Check if file is a test file\n */\nfunction isTestFile(filePath: string): boolean {\n  return (\n    /\\.(test|spec)\\.(ts|tsx|js|jsx)$/.test(filePath) ||\n    /test_.*\\.py$/.test(filePath) ||\n    /_test\\.py$/.test(filePath)\n  );\n}\n\n/**\n * Find corresponding test file for an implementation\n */\nfunction findTestFile(implFile: string): string | null {\n  if (/\\.(ts|tsx|js|jsx)$/.test(implFile)) {\n    const base = implFile.replace(/\\.[^.]+$/, '');\n    const ext = implFile.split('.').pop() || 'ts';\n\n    // Check common patterns\n    const patterns = [\n      `${base}.test.${ext}`,\n      `${base}.spec.${ext}`,\n      `${base}.test.ts`,\n      `${base}.test.tsx`,\n    ];\n\n    for (const pattern of patterns) {\n      if (existsSync(pattern)) return pattern;\n    }\n\n    // Check __tests__ directory\n    const dir = implFile.substring(0, implFile.lastIndexOf('/'));\n    const filename = implFile.split('/').pop() || '';\n    const baseFilename = filename.replace(/\\.[^.]+$/, '');\n\n    const testDirPatterns = [\n      `${dir}/__tests__/${baseFilename}.test.${ext}`,\n      `${dir}/__tests__/${baseFilename}.spec.${ext}`,\n    ];\n\n    for (const pattern of testDirPatterns) {\n      if (existsSync(pattern)) return pattern;\n    }\n  } else if (implFile.endsWith('.py')) {\n    const dir = implFile.substring(0, implFile.lastIndexOf('/'));\n    const filename = implFile.split('/').pop() || '';\n    const testFilename = `test_${filename}`;\n\n    // Try same directory\n    if (existsSync(`${dir}/${testFilename}`)) {\n      return `${dir}/${testFilename}`;\n    }\n\n    // Try tests/ directory\n    const parentDir = dir.substring(0, dir.lastIndexOf('/'));\n    if (existsSync(`${parentDir}/tests/${testFilename}`)) {\n      return `${parentDir}/tests/${testFilename}`;\n    }\n    if (existsSync(`${dir}/tests/${testFilename}`)) {\n      return `${dir}/tests/${testFilename}`;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Extract testable units from content\n */\nfunction extractTestableUnits(content: string, filePath: string): string[] {\n  const units: string[] = [];\n\n  if (/\\.(ts|tsx|js|jsx)$/.test(filePath)) {\n    // TypeScript/JavaScript: Extract exported functions and classes\n    const matches = content.match(/export (function|class|const|async function)\\s+([A-Za-z_][A-Za-z0-9_]*)/g);\n    if (matches) {\n      for (const match of matches) {\n        const name = match.split(/\\s+/).pop();\n        if (name) units.push(name);\n      }\n    }\n  } else if (filePath.endsWith('.py')) {\n    // Python: Extract public functions and classes\n    const lines = content.split('\\n');\n    for (const line of lines) {\n      const match = line.match(/^(def|class)\\s+([A-Za-z][A-Za-z0-9_]*)/);\n      if (match && match[2]) {\n        units.push(match[2]);\n      }\n    }\n  }\n\n  return [...new Set(units)];\n}\n\n/**\n * Validate test coverage for cross-instance code\n */\nexport function crossInstanceTestValidator(input: HookInput): HookResult {\n  const filePath = input.tool_input?.file_path || '';\n  const content = input.tool_input?.content || (input as any).tool_result || '';\n\n  if (!filePath || !content) return outputSilentSuccess();\n\n  // Only validate implementation files (not tests)\n  if (isTestFile(filePath)) return outputSilentSuccess();\n\n  // Skip non-code files\n  if (!/\\.(ts|tsx|js|jsx|py)$/.test(filePath)) {\n    return outputSilentSuccess();\n  }\n\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  // Find corresponding test file\n  const testFile = findTestFile(filePath);\n\n  // Extract testable units\n  const testableUnits = extractTestableUnits(content, filePath);\n\n  if (testableUnits.length > 0) {\n    if (!testFile) {\n      errors.push('TEST COVERAGE: No test file found for implementation');\n      errors.push(`  Implementation: ${filePath}`);\n      errors.push('  Expected test file:');\n\n      if (/\\.(ts|tsx|js|jsx)$/.test(filePath)) {\n        const base = filePath.replace(/\\.[^.]+$/, '');\n        const ext = filePath.split('.').pop() || 'ts';\n        const dir = filePath.substring(0, filePath.lastIndexOf('/'));\n        const filename = filePath.split('/').pop() || '';\n        errors.push(`    - ${base}.test.${ext}`);\n        errors.push(`    - ${dir}/__tests__/${filename}`);\n      } else if (filePath.endsWith('.py')) {\n        const filename = filePath.split('/').pop() || '';\n        const dir = filePath.substring(0, filePath.lastIndexOf('/'));\n        errors.push(`    - ${dir}/test_${filename}`);\n        errors.push(`    - ${dir.substring(0, dir.lastIndexOf('/'))}/tests/test_${filename}`);\n      }\n\n      errors.push('');\n      errors.push(`  Found ${testableUnits.length} testable units:`);\n      for (const unit of testableUnits.slice(0, 5)) {\n        errors.push(`    - ${unit}`);\n      }\n    } else {\n      // Test file exists - check if new units are tested\n      try {\n        const testContent = readFileSync(testFile, 'utf8');\n        const untestedUnits: string[] = [];\n\n        for (const unit of testableUnits) {\n          // Use word boundary check\n          const regex = new RegExp(`\\\\b${unit.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}\\\\b`);\n          if (!regex.test(testContent)) {\n            untestedUnits.push(unit);\n          }\n        }\n\n        if (untestedUnits.length > 0) {\n          warnings.push('TEST COVERAGE: New units without tests');\n          warnings.push(`  Implementation: ${filePath}`);\n          warnings.push(`  Test file: ${testFile}`);\n          warnings.push('');\n          warnings.push(`  Untested units (${untestedUnits.length}/${testableUnits.length}):`);\n          for (const unit of untestedUnits.slice(0, 5)) {\n            warnings.push(`    - ${unit}`);\n          }\n          warnings.push('');\n          warnings.push('  Add tests before committing');\n        }\n      } catch {\n        // Ignore file read errors\n      }\n    }\n  }\n\n  // Block on missing tests for new code\n  if (errors.length > 0) {\n    return outputBlock(`Missing test coverage for new code: ${errors[0]}`);\n  }\n\n  // Warn about test gaps\n  if (warnings.length > 0) {\n    const warningContext = warnings.join('\\n');\n    return outputWithContext(`Test coverage warnings detected:\\n\\n${warningContext}`);\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * DI Pattern Enforcer Hook\n * BLOCKING: Enforce dependency injection patterns in FastAPI\n * CC 2.1.7 Compliant\n */\n\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, outputWithContext, logHook } from '../lib/common.js';\n\n/**\n * Enforce dependency injection patterns in FastAPI routers\n */\nexport function diPatternEnforcer(input: HookInput): HookResult {\n  const filePath = input.tool_input?.file_path || '';\n  const content = input.tool_input?.content || (input as any).tool_result || '';\n\n  if (!filePath || !content) return outputSilentSuccess();\n\n  // Only validate Python files in routers/\n  if (!/\\/routers\\/.*\\.py$/.test(filePath)) {\n    return outputSilentSuccess();\n  }\n\n  // Skip deps.py and dependencies.py (these define the DI functions)\n  const filename = filePath.split('/').pop() || '';\n  if (/^(deps|dependencies|__init__)\\.py$/.test(filename)) {\n    return outputSilentSuccess();\n  }\n\n  const errors: string[] = [];\n\n  // Rule: No direct service/repository instantiation\n  if (/=\\s*[A-Z][a-zA-Z]*Service\\s*\\(\\s*\\)/.test(content)) {\n    const match = content.match(/[A-Z][a-zA-Z]*Service\\s*\\(\\s*\\)/);\n    errors.push('INSTANTIATION: Direct service instantiation not allowed');\n    errors.push(`  Found: ${match?.[0] || 'Service()'}`);\n    errors.push('  ');\n    errors.push('  Use dependency injection:');\n    errors.push('    service: MyService = Depends(get_my_service)');\n  }\n\n  if (/=\\s*[A-Z][a-zA-Z]*(Repository|Repo)\\s*\\(\\s*\\)/.test(content)) {\n    const match = content.match(/[A-Z][a-zA-Z]*(Repository|Repo)\\s*\\(\\s*\\)/);\n    errors.push('INSTANTIATION: Direct repository instantiation not allowed');\n    errors.push(`  Found: ${match?.[0] || 'Repository()'}`);\n    errors.push('  ');\n    errors.push('  Use dependency injection:');\n    errors.push('    repo: MyRepository = Depends(get_my_repository)');\n  }\n\n  // Rule: No global service/repository instances\n  if (/^[a-z_]+\\s*=\\s*[A-Z][a-zA-Z]*(Service|Repository|Repo)\\s*\\(/m.test(content)) {\n    errors.push('GLOBAL: Global service/repository instance not allowed');\n    errors.push('  ');\n    errors.push('  Global instances cause:');\n    errors.push('    - Shared state between requests');\n    errors.push('    - Difficult testing');\n    errors.push('    - Connection pool issues');\n    errors.push('  ');\n    errors.push('  Use Depends() for request-scoped instances');\n  }\n\n  // Rule: Database session must use Depends()\n  if (/:\\s*(Async)?Session[^=]*\\)/.test(content)) {\n    if (!/:\\s*(Async)?Session\\s*=\\s*Depends/.test(content)) {\n      errors.push('DI: Database session must use Depends()');\n      errors.push('  ');\n      errors.push('  BAD:  async def get_users(db: AsyncSession):');\n      errors.push('  GOOD: async def get_users(db: AsyncSession = Depends(get_db)):');\n    }\n  }\n\n  // Rule: Route handlers should use Depends for typed dependencies\n  if (/@router\\.(get|post|put|patch|delete)/.test(content)) {\n    if (/:\\s*[A-Z][a-zA-Z]*(Service|Repository|Repo)[^=)]*\\)/.test(content)) {\n      if (!/:\\s*[A-Z][a-zA-Z]*(Service|Repository|Repo)\\s*=\\s*Depends/.test(content)) {\n        errors.push('DI: Service/Repository parameters must use Depends()');\n        errors.push('  ');\n        errors.push('  BAD:  async def create_user(user_service: UserService):');\n        errors.push('  GOOD: async def create_user(user_service: UserService = Depends(get_user_service)):');\n      }\n    }\n  }\n\n  // Rule: No sync DB calls in async functions\n  if (/async def/.test(content)) {\n    // Check for db.query() - sync SQLAlchemy 1.x pattern\n    if (/db\\.query\\(/.test(content)) {\n      if (!/await.*db\\.query\\(/.test(content)) {\n        errors.push('ASYNC: Sync database call in async function');\n        errors.push('  Found: db.query() (sync pattern)');\n        errors.push('  ');\n        errors.push('  Use async SQLAlchemy 2.0 patterns:');\n        errors.push('    result = await db.execute(select(User))');\n        errors.push('    users = result.scalars().all()');\n      }\n    }\n\n    // Check for session methods that should be awaited\n    const syncPattern = /db\\.(add|delete|commit|flush|rollback|refresh)\\(/;\n    if (syncPattern.test(content)) {\n      if (/AsyncSession/.test(content)) {\n        // Check if await is used with these methods\n        const lines = content.split('\\n');\n        for (const line of lines) {\n          if (syncPattern.test(line) && !line.includes('await')) {\n            errors.push('ASYNC: Missing await for async database operation');\n            errors.push('  ');\n            errors.push('  With AsyncSession, use await:');\n            errors.push('    await db.commit()');\n            errors.push('    await db.refresh(user)');\n            break;\n          }\n        }\n      }\n    }\n  }\n\n  // Report errors and block\n  if (errors.length > 0) {\n    logHook('di-pattern-enforcer', `BLOCKED: DI violation in ${filePath}`);\n    const ctx = `Dependency injection violation in ${filePath}. See stderr for details.`;\n    return outputWithContext(ctx);\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Duplicate Code Detector Hook\n * BLOCKING: Detect duplicate/redundant code across worktrees\n * CC 2.1.7 Compliant\n */\n\nimport { existsSync, readFileSync, readdirSync, statSync } from 'node:fs';\nimport { execSync } from 'node:child_process';\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, outputWithContext, getProjectDir } from '../lib/common.js';\nimport { getRepoRoot } from '../lib/git.js';\n\n/**\n * Extract function/class signatures from content\n */\nfunction extractSignatures(content: string, filePath: string): string[] {\n  const signatures: string[] = [];\n\n  if (/\\.(ts|tsx|js|jsx)$/.test(filePath)) {\n    // TypeScript/JavaScript\n    const matches = content.match(/(function|class|const|export function|export class)\\s+[A-Za-z_][A-Za-z0-9_]*/g);\n    if (matches) {\n      signatures.push(...matches);\n    }\n  } else if (filePath.endsWith('.py')) {\n    // Python\n    const lines = content.split('\\n');\n    for (const line of lines) {\n      const match = line.match(/^(def|class)\\s+[A-Za-z_][A-Za-z0-9_]*/);\n      if (match) signatures.push(match[0]);\n    }\n  }\n\n  return [...new Set(signatures)];\n}\n\n/**\n * Find code files in directory (excluding common ignored paths)\n */\nfunction findCodeFiles(dir: string, pattern: RegExp): string[] {\n  const files: string[] = [];\n  const ignoreDirs = ['node_modules', '.venv', 'venv', '__pycache__', 'dist', 'build', '.next', '.git'];\n\n  function walk(currentDir: string): void {\n    try {\n      const entries = readdirSync(currentDir, { withFileTypes: true });\n      for (const entry of entries) {\n        const fullPath = `${currentDir}/${entry.name}`;\n        if (entry.isDirectory()) {\n          if (!ignoreDirs.includes(entry.name)) {\n            walk(fullPath);\n          }\n        } else if (entry.isFile() && pattern.test(entry.name)) {\n          files.push(fullPath);\n        }\n      }\n    } catch {\n      // Ignore access errors\n    }\n  }\n\n  walk(dir);\n  return files;\n}\n\n/**\n * Check for copy-paste patterns in content\n */\nfunction checkCopyPastePatterns(content: string): string[] {\n  const warnings: string[] = [];\n  const lines = content.split('\\n');\n  let prev = '';\n  let count = 0;\n  let startLine = 0;\n\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i].trim();\n    if (line && line === prev) {\n      count++;\n      if (count >= 3) {\n        warnings.push(`Line ${startLine}: ${prev.substring(0, 50)}`);\n      }\n    } else {\n      prev = line;\n      count = 1;\n      startLine = i + 1;\n    }\n  }\n\n  return warnings;\n}\n\n/**\n * Check for utility patterns that should be centralized\n */\nfunction checkUtilityPatterns(content: string, filePath: string): { errors: string[]; warnings: string[] } {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  if (/\\.(ts|tsx|js|jsx)$/.test(filePath)) {\n    // Check for date formatting\n    if (/new Date.*toLocaleDateString/.test(content)) {\n      errors.push('UTILITY: Direct date formatting detected');\n      errors.push(\"  Use centralized date utilities: import { formatDate } from '@/lib/dates'\");\n    }\n\n    // Check for multiple fetch calls\n    const fetchCount = (content.match(/fetch\\s*\\(\\s*['\"]/g) || []).length;\n    if (fetchCount > 2) {\n      warnings.push(`UTILITY: Multiple fetch calls detected (${fetchCount})`);\n      warnings.push('  Consider using centralized API client or custom hook');\n    }\n\n    // Check for multiple inline validations\n    const validationCount = (content.match(/if\\s*\\([^)]*\\.test\\([^)]*\\)/g) || []).length;\n    if (validationCount > 3) {\n      warnings.push(`UTILITY: Multiple inline validations detected (${validationCount})`);\n      warnings.push('  Use Zod schemas: const schema = z.object({...})');\n    }\n  }\n\n  if (filePath.endsWith('.py')) {\n    // Check for multiple json.loads\n    const jsonCount = (content.match(/json\\.loads/g) || []).length;\n    if (jsonCount > 3) {\n      warnings.push(`UTILITY: Multiple json.loads detected (${jsonCount})`);\n      warnings.push('  Consider centralized JSON handling with error recovery');\n    }\n\n    // Check for multiple environment variable access\n    const envCount = (content.match(/os\\.getenv|os\\.environ/g) || []).length;\n    if (envCount > 5) {\n      warnings.push(`UTILITY: Multiple environment variable accesses (${envCount})`);\n      warnings.push('  Use Settings/Config class with Pydantic validation');\n    }\n  }\n\n  return { errors, warnings };\n}\n\n/**\n * Detect duplicate/redundant code across worktrees\n */\nexport function duplicateCodeDetector(input: HookInput): HookResult {\n  const filePath = input.tool_input?.file_path || '';\n  const content = input.tool_input?.content || (input as any).tool_result || '';\n\n  if (!filePath || !content) return outputSilentSuccess();\n\n  // Only validate code files\n  if (!/\\.(ts|tsx|js|jsx|py)$/.test(filePath)) {\n    return outputSilentSuccess();\n  }\n\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  // 1. Extract signatures and check for duplicates in main repo\n  const signatures = extractSignatures(content, filePath);\n  if (signatures.length > 0) {\n    const projectRoot = getRepoRoot() || getProjectDir();\n    const codeFiles = findCodeFiles(projectRoot, /\\.(ts|tsx|js|jsx|py)$/);\n\n    for (const signature of signatures) {\n      const name = signature.split(/\\s+/).pop() || '';\n      if (!name) continue;\n\n      // Search for duplicates\n      for (const codeFile of codeFiles) {\n        if (codeFile === filePath) continue;\n\n        try {\n          const fileContent = readFileSync(codeFile, 'utf8');\n          // Word boundary check\n          const regex = new RegExp(`\\\\b${name.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}\\\\b`);\n          if (regex.test(fileContent)) {\n            // Check for exact signature match\n            if (fileContent.includes(signature)) {\n              const relPath = codeFile.replace(projectRoot + '/', '');\n              warnings.push(`DUPLICATE: '${name}' already exists in:`);\n              warnings.push(`  - ${relPath}`);\n              warnings.push('  Consider:');\n              warnings.push('    1. Reusing existing implementation');\n              warnings.push('    2. Extracting to shared utility');\n              warnings.push('    3. Using different name if intentionally different');\n              break;\n            }\n          }\n        } catch {\n          // Ignore file read errors\n        }\n      }\n    }\n  }\n\n  // 2. Check for copy-paste patterns\n  const copyPasteWarnings = checkCopyPastePatterns(content);\n  if (copyPasteWarnings.length > 0) {\n    warnings.push('COPY-PASTE: Repeated code blocks detected:');\n    for (const w of copyPasteWarnings.slice(0, 5)) {\n      warnings.push(`  ${w}`);\n    }\n    warnings.push('  Refactor repeated logic into functions');\n  }\n\n  // 3. Check for utility patterns\n  const utilityCheck = checkUtilityPatterns(content, filePath);\n  errors.push(...utilityCheck.errors);\n  warnings.push(...utilityCheck.warnings);\n\n  // Block on critical errors\n  if (errors.length > 0) {\n    const ctx = `Duplicate code violation in ${filePath}. See stderr for details.`;\n    return outputWithContext(ctx);\n  }\n\n  // Warn but don't block\n  if (warnings.length > 0) {\n    const ctx = `Potential code duplication detected in ${filePath}. Review warnings on stderr.`;\n    return outputWithContext(ctx);\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Eval Metrics Collector Hook\n * Runs on Stop for llm-evaluation skill\n * Collects and summarizes evaluation metrics\n * CC 2.1.7 Compliant\n */\n\nimport { existsSync, readFileSync, readdirSync } from 'node:fs';\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, getProjectDir } from '../lib/common.js';\n\n/**\n * Collect and summarize LLM evaluation metrics\n */\nexport function evalMetricsCollector(_input: HookInput): HookResult {\n  const projectDir = getProjectDir();\n  const messages: string[] = [];\n\n  messages.push('::group::LLM Evaluation Summary');\n\n  // Check for evaluation results\n  const evalResultsPath = `${projectDir}/eval_results.json`;\n  if (existsSync(evalResultsPath)) {\n    messages.push('Evaluation results found:');\n    try {\n      const content = readFileSync(evalResultsPath, 'utf8');\n      const data = JSON.parse(content);\n\n      if (typeof data === 'object' && data !== null) {\n        for (const [key, value] of Object.entries(data)) {\n          if (typeof value === 'number') {\n            const formatted = Number.isInteger(value) ? value.toString() : value.toFixed(2);\n            messages.push(`  ${key}: ${formatted}`);\n          }\n        }\n      }\n    } catch {\n      // If JSON parsing fails, show first 20 lines\n      try {\n        const content = readFileSync(evalResultsPath, 'utf8');\n        const lines = content.split('\\n').slice(0, 20);\n        messages.push(...lines);\n      } catch {\n        messages.push('  (Unable to read file)');\n      }\n    }\n  }\n\n  // Check for DeepEval results\n  const deepevalDir = `${projectDir}/.deepeval`;\n  if (existsSync(deepevalDir)) {\n    messages.push('');\n    messages.push('DeepEval results directory found');\n    try {\n      const files = readdirSync(deepevalDir).slice(0, 5);\n      for (const file of files) {\n        messages.push(`  ${file}`);\n      }\n    } catch {\n      // Ignore\n    }\n  }\n\n  // Check for RAGAS results\n  const ragasPath = `${projectDir}/ragas_results.json`;\n  if (existsSync(ragasPath)) {\n    messages.push('');\n    messages.push('RAGAS evaluation results found');\n  }\n\n  messages.push('');\n  messages.push('Evaluation complete - review metrics above');\n  messages.push('::endgroup::');\n\n  // Log to stderr for visibility during development\n  for (const msg of messages) {\n    process.stderr.write(msg + '\\n');\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Evidence Collector Hook\n * Runs on Stop for evidence-verification skill\n * Collects verification evidence - silent operation\n * CC 2.1.7 Compliant\n */\n\nimport { existsSync, appendFileSync, mkdirSync, readdirSync } from 'node:fs';\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, getLogDir, getProjectDir } from '../lib/common.js';\n\n/**\n * Collect verification evidence on session stop\n */\nexport function evidenceCollector(_input: HookInput): HookResult {\n  const logDir = getLogDir();\n  const projectDir = getProjectDir();\n  const logFile = `${logDir}/evidence-collector.log`;\n\n  // Ensure log directory exists\n  try {\n    mkdirSync(logDir, { recursive: true });\n  } catch {\n    // Ignore\n  }\n\n  const timestamp = new Date().toISOString().replace('T', ' ').slice(0, 19);\n  const logLines: string[] = [];\n\n  logLines.push(`[${timestamp}] Evidence Collection`);\n\n  // Collect exit codes from recent commands\n  logLines.push('Recent command results:');\n  const lastExitCode = process.env.CC_LAST_EXIT_CODE;\n  if (lastExitCode) {\n    logLines.push(`  Last exit code: ${lastExitCode}`);\n  }\n\n  // Check for test results\n  if (existsSync(`${projectDir}/pytest.xml`) || existsSync(`${projectDir}/junit.xml`)) {\n    logLines.push('  Test results: Found (XML format)');\n  }\n\n  const testResultsDir = `${projectDir}/test-results`;\n  if (existsSync(testResultsDir)) {\n    logLines.push('  Test results directory: Found');\n    try {\n      const files = readdirSync(testResultsDir).slice(0, 5);\n      for (const file of files) {\n        logLines.push(`    ${file}`);\n      }\n    } catch {\n      // Ignore\n    }\n  }\n\n  // Check for coverage\n  if (existsSync(`${projectDir}/.coverage`) || existsSync(`${projectDir}/coverage`)) {\n    logLines.push('  Coverage data: Found');\n  }\n\n  // Check for lint results\n  if (existsSync(`${projectDir}/lint-results.json`) || existsSync(`${projectDir}/eslint-report.json`)) {\n    logLines.push('  Lint results: Found');\n  }\n\n  logLines.push('Evidence verification complete.');\n\n  // Write to log file (silent operation)\n  try {\n    appendFileSync(logFile, logLines.join('\\n') + '\\n');\n  } catch {\n    // Ignore logging errors\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Import Direction Enforcer Hook\n * BLOCKING: Imports must follow unidirectional architecture\n * CC 2.1.7 Compliant\n */\n\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, outputBlock, logHook } from '../lib/common.js';\nimport { guardCodeFiles } from '../lib/guards.js';\n\n/**\n * Determine the architectural layer of a file\n */\nfunction getLayer(filePath: string): string | null {\n  // TypeScript/JavaScript layers\n  if (filePath.includes('/shared/')) return 'shared';\n  if (filePath.includes('/lib/')) return 'lib';\n  if (filePath.includes('/utils/')) return 'utils';\n  if (filePath.includes('/components/') && !filePath.includes('/features/')) return 'components';\n  if (filePath.includes('/hooks/') && !filePath.includes('/features/')) return 'hooks';\n  if (filePath.includes('/features/')) return 'features';\n  if (filePath.includes('/app/') || filePath.includes('/pages/')) return 'app';\n\n  // Python layers\n  if (filePath.includes('/repositories/')) return 'repositories';\n  if (filePath.includes('/services/') && filePath.endsWith('.py')) return 'services';\n  if (filePath.includes('/routers/')) return 'routers';\n\n  return null;\n}\n\n/**\n * Enforce import direction rules\n */\nexport function importDirectionEnforcer(input: HookInput): HookResult {\n  // Self-guard: Only run for code files\n  const guard = guardCodeFiles(input);\n  if (guard) return guard;\n\n  const filePath = input.tool_input.file_path || '';\n  const content = input.tool_input.content || (input as any).tool_result || '';\n\n  if (!filePath || !content) return outputSilentSuccess();\n\n  const layer = getLayer(filePath);\n  if (!layer) return outputSilentSuccess();\n\n  const errors: string[] = [];\n\n  // TypeScript/JavaScript import rules\n  if (/\\.(ts|tsx|js|jsx)$/.test(filePath)) {\n    switch (layer) {\n      case 'shared':\n      case 'lib':\n      case 'utils':\n        if (/from ['\"](@\\/|\\.\\.\\/)*(features|app)\\//.test(content)) {\n          errors.push(`${layer}/ cannot import from features/ or app/`);\n        }\n        break;\n\n      case 'components':\n      case 'hooks':\n        if (/from ['\"](@\\/|\\.\\.\\/)*(features|app)\\//.test(content)) {\n          errors.push(`${layer}/ cannot import from features/ or app/`);\n        }\n        break;\n\n      case 'features':\n        if (/from ['\"](@\\/|\\.\\.\\/)*app\\//.test(content)) {\n          errors.push('features/ cannot import from app/');\n        }\n        break;\n    }\n  }\n\n  // Python import rules\n  if (filePath.endsWith('.py')) {\n    switch (layer) {\n      case 'repositories':\n        if (/from (app\\.)?(services|routers)/.test(content)) {\n          errors.push('repositories/ cannot import from services/ or routers/');\n        }\n        break;\n\n      case 'services':\n        if (/from (app\\.)?routers\\.[a-z]/.test(content)) {\n          if (!/from (app\\.)?routers\\.(deps|dependencies)/.test(content)) {\n            errors.push('services/ cannot import from routers/');\n          }\n        }\n        break;\n    }\n  }\n\n  // Report errors\n  if (errors.length > 0) {\n    const filename = filePath.split('/').pop() || filePath;\n    const reason = `Import direction violation in ${filename}: ${errors[0]}`;\n    logHook('import-direction-enforcer', `BLOCKED: ${reason}`);\n    return outputBlock(reason);\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Merge Conflict Predictor Hook\n * WARNING: Predict merge conflicts before commit\n * CC 2.1.7 Compliant\n */\n\nimport { existsSync, readFileSync } from 'node:fs';\nimport { execSync } from 'node:child_process';\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, outputWithContext, getProjectDir } from '../lib/common.js';\nimport { getRepoRoot, getCurrentBranch, getDefaultBranch } from '../lib/git.js';\n\ninterface ConflictInfo {\n  worktree: string;\n  branch: string;\n  status: string;\n}\n\n/**\n * Get list of git worktrees\n */\nfunction getWorktrees(): string[] {\n  try {\n    const output = execSync('git worktree list --porcelain', {\n      encoding: 'utf8',\n      timeout: 5000,\n      stdio: ['pipe', 'pipe', 'pipe'],\n    });\n\n    return output\n      .split('\\n')\n      .filter((line) => line.startsWith('worktree '))\n      .map((line) => line.replace('worktree ', ''));\n  } catch {\n    return [];\n  }\n}\n\n/**\n * Get branch name for a worktree\n */\nfunction getWorktreeBranch(worktree: string): string {\n  try {\n    return execSync('git rev-parse --abbrev-ref HEAD', {\n      cwd: worktree,\n      encoding: 'utf8',\n      timeout: 5000,\n      stdio: ['pipe', 'pipe', 'pipe'],\n    }).trim();\n  } catch {\n    return 'unknown';\n  }\n}\n\n/**\n * Check if file is modified in a worktree\n */\nfunction isFileModified(worktree: string, relPath: string): boolean {\n  try {\n    const status = execSync(`git status --short \"${relPath}\"`, {\n      cwd: worktree,\n      encoding: 'utf8',\n      timeout: 5000,\n      stdio: ['pipe', 'pipe', 'pipe'],\n    });\n    return /^.M|^M.|^A/.test(status);\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Get commits ahead/behind count\n */\nfunction getBranchDivergence(baseBranch: string, currentBranch: string): { ahead: number; behind: number } {\n  try {\n    const ahead = parseInt(\n      execSync(`git rev-list --count ${baseBranch}..${currentBranch}`, {\n        encoding: 'utf8',\n        timeout: 5000,\n        stdio: ['pipe', 'pipe', 'pipe'],\n      }).trim(),\n      10\n    );\n    const behind = parseInt(\n      execSync(`git rev-list --count ${currentBranch}..${baseBranch}`, {\n        encoding: 'utf8',\n        timeout: 5000,\n        stdio: ['pipe', 'pipe', 'pipe'],\n      }).trim(),\n      10\n    );\n    return { ahead: ahead || 0, behind: behind || 0 };\n  } catch {\n    return { ahead: 0, behind: 0 };\n  }\n}\n\n/**\n * Predict merge conflicts before commit\n */\nexport function mergeConflictPredictor(input: HookInput): HookResult {\n  const filePath = input.tool_input.file_path || '';\n  const content = input.tool_input.content || (input as any).tool_result || '';\n\n  if (!filePath || !content) return outputSilentSuccess();\n\n  // Check if we have worktrees\n  const worktrees = getWorktrees();\n  if (worktrees.length === 0) return outputSilentSuccess();\n\n  const warnings: string[] = [];\n  const conflicts: ConflictInfo[] = [];\n\n  const repoRoot = getRepoRoot() || getProjectDir();\n  const currentWorktree = repoRoot;\n  const relPath = filePath.replace(repoRoot + '/', '').replace(repoRoot, '');\n\n  // Check each worktree for concurrent modifications\n  for (const worktree of worktrees) {\n    if (worktree === currentWorktree) continue;\n\n    const worktreeFile = `${worktree}/${relPath}`;\n    if (!existsSync(worktreeFile)) continue;\n\n    const branch = getWorktreeBranch(worktree);\n\n    // Check if file is modified\n    if (isFileModified(worktree, relPath)) {\n      conflicts.push({ worktree, branch, status: 'modified' });\n\n      // Get the other content to analyze overlap\n      try {\n        const otherContent = readFileSync(worktreeFile, 'utf8');\n\n        // Count changed lines (simple heuristic)\n        const newLines = content.split('\\n');\n        const otherLines = otherContent.split('\\n');\n        const diff = Math.abs(newLines.length - otherLines.length);\n\n        if (diff > 10) {\n          warnings.push(`OVERLAP: Significant changes in both branches (~${diff} lines)`);\n          warnings.push(`  Branch: ${branch}`);\n          warnings.push('  High risk of merge conflict');\n        }\n      } catch {\n        // Ignore read errors\n      }\n    }\n  }\n\n  // Check base branch divergence\n  const currentBranch = getCurrentBranch();\n  const baseBranch = getDefaultBranch();\n\n  if (currentBranch !== baseBranch) {\n    const { ahead, behind } = getBranchDivergence(baseBranch, currentBranch);\n\n    if (behind > 10) {\n      warnings.push(`DIVERGENCE: Current branch is ${behind} commits behind ${baseBranch}`);\n      warnings.push('  Consider rebasing before continuing development');\n      warnings.push('  This reduces merge conflict risk');\n    }\n  }\n\n  // Report conflicts\n  if (conflicts.length > 0) {\n    warnings.unshift('MERGE CONFLICT RISK: Concurrent modifications detected');\n    warnings.unshift('');\n    warnings.unshift(`File: ${filePath}`);\n\n    for (const conflict of conflicts) {\n      warnings.push(`  Branch: ${conflict.branch}`);\n      warnings.push(`  Status: ${conflict.status}`);\n      warnings.push(`  Path: ${conflict.worktree}`);\n    }\n\n    warnings.push('');\n    warnings.push('Recommendations:');\n    warnings.push('  1. Coordinate changes with other instances');\n    warnings.push('  2. Consider splitting work to avoid overlapping files');\n    warnings.push('  3. Communicate before merging');\n  }\n\n  if (warnings.length > 0) {\n    const ctx = `Potential merge conflicts detected in ${filePath}. Review warnings on stderr.`;\n    // Log warnings to stderr\n    process.stderr.write(warnings.join('\\n') + '\\n');\n    return outputWithContext(ctx);\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Merge Readiness Checker Hook\n * Comprehensive merge readiness check for worktree branches\n * CC 2.1.7 Compliant\n */\n\nimport { existsSync, readFileSync } from 'node:fs';\nimport { execSync } from 'node:child_process';\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, getProjectDir } from '../lib/common.js';\nimport { getRepoRoot, getCurrentBranch, getDefaultBranch, hasUncommittedChanges } from '../lib/git.js';\n\n/**\n * Execute git command safely\n */\nfunction gitExec(command: string, cwd?: string): string {\n  try {\n    return execSync(command, {\n      cwd: cwd || getProjectDir(),\n      encoding: 'utf8',\n      timeout: 30000,\n      stdio: ['pipe', 'pipe', 'pipe'],\n    }).trim();\n  } catch {\n    return '';\n  }\n}\n\n/**\n * Check merge readiness for branch\n */\nexport function mergeReadinessChecker(input: HookInput): HookResult {\n  const command = input.tool_input?.command || '';\n\n  // Only run for merge-related commands\n  if (!/\\b(gh\\s+pr\\s+merge|git\\s+merge|git\\s+rebase)\\b/i.test(command)) {\n    return outputSilentSuccess();\n  }\n\n  const targetBranch = (input.tool_input as any).target_branch || 'main';\n  const currentBranch = getCurrentBranch();\n\n  if (currentBranch === targetBranch) {\n    process.stderr.write(`Already on target branch ${targetBranch}\\n`);\n    return outputSilentSuccess();\n  }\n\n  process.stderr.write(`Checking merge readiness: ${currentBranch} -> ${targetBranch}\\n\\n`);\n\n  const projectRoot = getRepoRoot() || getProjectDir();\n  const errors: string[] = [];\n  const warnings: string[] = [];\n  const passes: string[] = [];\n\n  // 1. Check for uncommitted changes\n  process.stderr.write('1. Checking for uncommitted changes...\\n');\n  if (hasUncommittedChanges()) {\n    const status = gitExec('git status --short');\n    errors.push('Uncommitted changes detected:');\n    errors.push(status.split('\\n').slice(0, 10).join('\\n'));\n  } else {\n    passes.push('No uncommitted changes');\n  }\n\n  // 2. Check branch divergence\n  process.stderr.write('2. Checking branch divergence...\\n');\n  gitExec(`git fetch origin ${targetBranch}`);\n\n  const ahead = parseInt(gitExec(`git rev-list --count origin/${targetBranch}..${currentBranch}`) || '0', 10);\n  const behind = parseInt(gitExec(`git rev-list --count ${currentBranch}..origin/${targetBranch}`) || '0', 10);\n\n  process.stderr.write(`   Ahead: ${ahead} commits, Behind: ${behind} commits\\n`);\n\n  if (behind > 20) {\n    errors.push(`Branch is significantly behind ${targetBranch} (${behind} commits)`);\n    errors.push(`Rebase or merge ${targetBranch} before proceeding`);\n  } else if (behind > 5) {\n    warnings.push(`Branch is behind ${targetBranch} by ${behind} commits`);\n    warnings.push('Consider rebasing for easier merge');\n  } else {\n    passes.push(`Branch is up to date (behind by ${behind})`);\n  }\n\n  // 3. Check for merge conflicts\n  process.stderr.write('3. Checking for merge conflicts...\\n');\n  const mergeResult = gitExec(`git merge --no-commit --no-ff origin/${targetBranch}`);\n\n  if (mergeResult.includes('CONFLICT')) {\n    const conflictFiles = gitExec('git diff --name-only --diff-filter=U');\n    errors.push(`Merge conflicts detected with ${targetBranch}:`);\n    for (const file of conflictFiles.split('\\n').slice(0, 10)) {\n      if (file) errors.push(`  - ${file}`);\n    }\n    errors.push('Resolve conflicts before merging');\n    gitExec('git merge --abort');\n  } else {\n    passes.push('No merge conflicts detected');\n    gitExec('git merge --abort');\n  }\n\n  // 4. Run quality gates\n  process.stderr.write('4. Running quality gates on changed files...\\n');\n  const mergeBase = gitExec(`git merge-base ${currentBranch} origin/${targetBranch}`);\n  if (mergeBase) {\n    const changedFiles = gitExec(`git diff --name-only ${mergeBase} ${currentBranch}`);\n    const fileCount = changedFiles.split('\\n').filter(Boolean).length;\n    process.stderr.write(`   Checking ${fileCount} changed files...\\n`);\n    passes.push('Quality gates check performed');\n  } else {\n    warnings.push('Cannot determine merge base - skipping file checks');\n  }\n\n  // 5. Check test suite\n  process.stderr.write('5. Checking test suite...\\n');\n  if (existsSync(`${projectRoot}/package.json`)) {\n    const pkgContent = readFileSync(`${projectRoot}/package.json`, 'utf8');\n    if (pkgContent.includes('\"test\":')) {\n      passes.push('Frontend test script found');\n    }\n  }\n  if (existsSync(`${projectRoot}/pytest.ini`) || existsSync(`${projectRoot}/pyproject.toml`)) {\n    passes.push('Backend test configuration found');\n  }\n\n  // Generate report\n  process.stderr.write('\\n');\n  process.stderr.write('=' .repeat(60) + '\\n');\n  process.stderr.write('\\nMERGE READINESS REPORT\\n\\n');\n  process.stderr.write(`Branch: ${currentBranch} -> ${targetBranch}\\n\\n`);\n\n  if (passes.length > 0) {\n    process.stderr.write('PASSED CHECKS:\\n');\n    for (const pass of passes) {\n      process.stderr.write(`   ${pass}\\n`);\n    }\n    process.stderr.write('\\n');\n  }\n\n  if (warnings.length > 0) {\n    process.stderr.write('WARNINGS:\\n');\n    for (const warning of warnings) {\n      process.stderr.write(`   ${warning}\\n`);\n    }\n    process.stderr.write('\\n');\n  }\n\n  if (errors.length > 0) {\n    process.stderr.write('BLOCKERS:\\n');\n    for (const error of errors) {\n      process.stderr.write(`   ${error}\\n`);\n    }\n    process.stderr.write('\\nMERGE NOT READY - Fix blockers before merging\\n');\n    return { continue: false, stopReason: 'Merge not ready - blockers detected' };\n  }\n\n  if (warnings.length > 0) {\n    process.stderr.write('MERGE READY WITH WARNINGS\\n');\n    process.stderr.write('Review warnings before proceeding with merge\\n');\n  } else {\n    process.stderr.write('MERGE READY - All checks passed!\\n');\n    process.stderr.write('You can safely merge this branch\\n');\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Migration Validator Hook\n * Runs after Write for database-schema-designer skill\n * Validates alembic migration files\n * CC 2.1.7 Compliant\n */\n\nimport { existsSync, readFileSync } from 'node:fs';\nimport { execSync } from 'node:child_process';\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, outputWithContext, logHook } from '../lib/common.js';\n\n/**\n * Validate alembic migration files\n */\nexport function migrationValidator(input: HookInput): HookResult {\n  const filePath = input.tool_input?.file_path || process.env.CC_TOOL_FILE_PATH || '';\n\n  if (!filePath) return outputSilentSuccess();\n\n  // Only check migration files\n  if (!filePath.includes('alembic/versions') || !filePath.endsWith('.py')) {\n    return outputSilentSuccess();\n  }\n\n  if (!existsSync(filePath)) {\n    return outputSilentSuccess();\n  }\n\n  process.stderr.write(`::group::Migration Validation: ${filePath.split('/').pop()}\\n`);\n\n  const errors: string[] = [];\n  let content: string;\n\n  try {\n    content = readFileSync(filePath, 'utf8');\n  } catch {\n    errors.push('Cannot read migration file');\n    return outputWithContext(`Migration validation failed for ${filePath}`);\n  }\n\n  // Check for required functions\n  if (!content.includes('def upgrade')) {\n    errors.push('Missing upgrade() function in migration');\n  }\n\n  if (!content.includes('def downgrade')) {\n    errors.push('Missing downgrade() function in migration');\n  }\n\n  // Check for revision ID\n  if (!/^revision = /m.test(content)) {\n    errors.push('Missing revision ID in migration');\n  }\n\n  // Validate syntax\n  try {\n    execSync(`python3 -m py_compile \"${filePath}\"`, {\n      encoding: 'utf8',\n      timeout: 10000,\n      stdio: ['pipe', 'pipe', 'pipe'],\n    });\n  } catch {\n    errors.push('Python syntax error in migration');\n  }\n\n  // Report errors\n  if (errors.length > 0) {\n    process.stderr.write('::error::Migration validation failed\\n');\n    for (const error of errors) {\n      process.stderr.write(`  - ${error}\\n`);\n    }\n    process.stderr.write('::endgroup::\\n');\n\n    logHook('migration-validator', `BLOCKED: ${errors[0]}`);\n    const ctx = `Migration validation failed for ${filePath}. See stderr for details.`;\n    return outputWithContext(ctx);\n  }\n\n  process.stderr.write('Migration file is valid\\n');\n  process.stderr.write('::endgroup::\\n');\n\n  return outputSilentSuccess();\n}\n", "/**\n * Pattern Consistency Enforcer Hook\n * BLOCKING: Enforce consistent patterns across all instances\n * CC 2.1.7 Compliant\n */\n\nimport { existsSync, readFileSync } from 'node:fs';\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, outputBlock, getProjectDir } from '../lib/common.js';\nimport { getRepoRoot } from '../lib/git.js';\n\n/**\n * Enforce pattern consistency across codebase\n */\nexport function patternConsistencyEnforcer(input: HookInput): HookResult {\n  const filePath = input.tool_input.file_path || '';\n  const content = input.tool_input.content || (input as any).tool_result || '';\n\n  if (!filePath || !content) return outputSilentSuccess();\n\n  const projectRoot = getRepoRoot() || getProjectDir();\n  const patternsFile = `${projectRoot}/.claude/context/knowledge/patterns/established.json`;\n\n  // Skip if no patterns file\n  if (!existsSync(patternsFile)) {\n    return outputSilentSuccess();\n  }\n\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  // Backend pattern consistency (Python files)\n  if (filePath.endsWith('.py') && (filePath.includes('/backend/') || filePath.includes('/api/'))) {\n    // Check: Clean Architecture layers\n    if (filePath.includes('/routers/')) {\n      if (/from.*repositories.*import/.test(content)) {\n        errors.push('PATTERN: Router imports repository directly');\n        errors.push('  Established pattern: routers -> services -> repositories');\n        errors.push('  Import from services/ layer instead');\n      }\n    }\n\n    if (filePath.includes('/services/')) {\n      if (/from.*routers.*import/.test(content)) {\n        errors.push('PATTERN: Service imports router (circular dependency)');\n        errors.push('  Established pattern: Services are independent of HTTP layer');\n      }\n    }\n\n    // Check: Async SQLAlchemy pattern\n    if (/from sqlalchemy import/.test(content)) {\n      if (!/from sqlalchemy\\.ext\\.asyncio import/.test(content)) {\n        if (/Session|sessionmaker/.test(content)) {\n          errors.push('PATTERN: Using sync SQLAlchemy instead of async');\n          errors.push('  Established pattern: All DB operations use async/await');\n          errors.push('  Import: from sqlalchemy.ext.asyncio import AsyncSession');\n        }\n      }\n    }\n\n    // Check: Pydantic v2 validators\n    if (/from pydantic import.*BaseModel/.test(content)) {\n      if (/@validator\\(/.test(content)) {\n        errors.push('PATTERN: Using Pydantic v1 @validator decorator');\n        errors.push('  Established pattern: Pydantic v2 with @field_validator');\n        errors.push(\"  Update: @field_validator('field_name', mode='after')\");\n      }\n      if (/@root_validator/.test(content)) {\n        errors.push('PATTERN: Using Pydantic v1 @root_validator decorator');\n        errors.push('  Established pattern: Pydantic v2 with @model_validator');\n        errors.push(\"  Update: @model_validator(mode='after')\");\n      }\n    }\n  }\n\n  // Frontend pattern consistency (TypeScript/JavaScript)\n  if (/\\.(ts|tsx|js|jsx)$/.test(filePath) && (filePath.includes('/frontend/') || filePath.includes('/src/'))) {\n    // Check: React 19 function components\n    if (/React\\.FC</.test(content)) {\n      errors.push('PATTERN: Using React.FC instead of explicit Props type');\n      errors.push('  Established pattern: function Component(props: Props): React.ReactNode');\n      errors.push('  Remove React.FC, use explicit function declaration');\n    }\n\n    // Check: Zod validation for API responses\n    if (/fetch\\(|axios\\./.test(content)) {\n      if (!/from ['\"]zod['\"]/.test(content)) {\n        errors.push('PATTERN: API call without Zod validation');\n        errors.push('  Established pattern: All API responses validated with Zod');\n        errors.push(\"  Import: import { z } from 'zod'\");\n      }\n    }\n\n    // Check: React 19 APIs for forms\n    if (/<form/.test(content)) {\n      if (!/useFormStatus|useActionState|useOptimistic/.test(content)) {\n        warnings.push('PATTERN: Form without React 19 form hooks');\n        warnings.push('  Established pattern: Use useFormStatus for pending state');\n        warnings.push('  Consider: useOptimistic for optimistic updates');\n      }\n    }\n\n    // Check: Date formatting pattern\n    if (/new Date.*toLocaleDateString|toLocaleString/.test(content)) {\n      errors.push('PATTERN: Direct date formatting instead of centralized utility');\n      errors.push('  Established pattern: Use @/lib/dates helpers');\n      errors.push(\"  Import: import { formatDate, formatDateShort } from '@/lib/dates'\");\n    }\n  }\n\n  // Testing pattern consistency\n  if (/\\.(test|spec)\\.(ts|tsx|js|jsx)$/.test(filePath) || /test_.*\\.py$/.test(filePath)) {\n    // Check: AAA pattern presence\n    if (!/\\/\\/ Arrange|\\/\\/ Act|\\/\\/ Assert|# Arrange|# Act|# Assert/i.test(content)) {\n      warnings.push('PATTERN: AAA pattern comments missing');\n      warnings.push('  Established pattern: Structure tests with Arrange-Act-Assert');\n      warnings.push('  Add comments for clarity in complex tests');\n    }\n\n    // Check: MSW for API mocking (TypeScript)\n    if (/\\.(ts|tsx|js|jsx)$/.test(filePath)) {\n      if (/jest\\.mock.*fetch|global\\.fetch/.test(content)) {\n        errors.push('PATTERN: Using jest.mock for fetch instead of MSW');\n        errors.push('  Established pattern: Use MSW for API mocking');\n        errors.push(\"  Import: import { http, HttpResponse } from 'msw'\");\n      }\n    }\n\n    // Check: Pytest fixtures (Python)\n    if (filePath.endsWith('.py')) {\n      if (/class Test.*setUp/.test(content)) {\n        errors.push('PATTERN: Using unittest setUp instead of pytest fixtures');\n        errors.push('  Established pattern: Use pytest fixtures');\n        errors.push('  Convert: @pytest.fixture\\\\ndef setup_data():');\n      }\n    }\n  }\n\n  // AI Integration pattern consistency\n  if (filePath.includes('/llm/') || filePath.includes('/ai/') || filePath.includes('/agent/')) {\n    // Check: IDs flow around LLM\n    if (/prompt.*\\{.*id.*\\}|f\".*\\{.*\\.id\\}.*\"/.test(content)) {\n      errors.push('PATTERN: Database IDs in LLM prompts');\n      errors.push('  Established pattern: IDs flow around LLM, not through it');\n      errors.push('  Pass IDs via metadata, join results after LLM processing');\n    }\n\n    // Check: Async timeout protection\n    if (/await.*openai|await.*anthropic|await.*llm/.test(content)) {\n      if (!/asyncio\\.timeout|asyncio\\.wait_for|Promise\\.race/.test(content)) {\n        errors.push('PATTERN: LLM call without timeout protection');\n        errors.push('  Established pattern: Wrap all LLM calls with timeout');\n        errors.push('  Python: async with asyncio.timeout(30):');\n        errors.push('  TypeScript: await Promise.race([call, timeout])');\n      }\n    }\n  }\n\n  // Block on critical pattern violations\n  if (errors.length > 0) {\n    return outputBlock(`Pattern consistency violations detected in ${filePath}`);\n  }\n\n  // Warn about pattern drift (non-blocking)\n  if (warnings.length > 0) {\n    process.stderr.write('WARNING: Pattern consistency issues detected\\n');\n    process.stderr.write(`File: ${filePath}\\n\\n`);\n    for (const warning of warnings) {\n      process.stderr.write(`  ${warning}\\n`);\n    }\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Redact Secrets Hook\n * Runs after Bash commands in security-scanning skill\n * Warns if potential secrets detected in output\n * CC 2.1.7 Compliant\n */\n\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess } from '../lib/common.js';\n\n// API key patterns\nconst API_KEY_PATTERNS = [\n  /sk-[a-zA-Z0-9]{20,}/, // OpenAI\n  /ghp_[a-zA-Z0-9]{36}/, // GitHub PAT\n  /AKIA[A-Z0-9]{16}/, // AWS Access Key\n  /xox[baprs]-[a-zA-Z0-9-]+/, // Slack tokens\n];\n\n// Generic secret patterns\nconst SECRET_PATTERNS = [\n  /password\\s*[:=]\\s*['\"][^'\"]+['\"]/i,\n  /secret\\s*[:=]\\s*['\"][^'\"]+['\"]/i,\n];\n\n/**\n * Check for potential secrets in command output\n */\nexport function redactSecrets(input: HookInput): HookResult {\n  const toolOutput = (input as any).tool_result || (input as any).output || '';\n\n  if (!toolOutput) return outputSilentSuccess();\n\n  // Check for API key patterns\n  for (const pattern of API_KEY_PATTERNS) {\n    if (pattern.test(toolOutput)) {\n      process.stderr.write('::warning::Potential API key detected in output - verify redaction\\n');\n      break;\n    }\n  }\n\n  // Check for generic secret patterns\n  for (const pattern of SECRET_PATTERNS) {\n    if (pattern.test(toolOutput)) {\n      process.stderr.write('::warning::Potential hardcoded credential in output\\n');\n      break;\n    }\n  }\n\n  // Silent success - warnings printed to stderr, don't block\n  return outputSilentSuccess();\n}\n", "/**\n * Review Summary Generator Hook\n * Runs on Stop for code-review-playbook skill\n * Generates review summary - silent operation, logs to file\n * CC 2.1.7 Compliant\n */\n\nimport { appendFileSync, mkdirSync } from 'node:fs';\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, getLogDir } from '../lib/common.js';\n\n/**\n * Generate code review summary on session stop\n */\nexport function reviewSummaryGenerator(_input: HookInput): HookResult {\n  const logDir = getLogDir();\n  const logFile = `${logDir}/review-summary.log`;\n\n  // Ensure log directory exists\n  try {\n    mkdirSync(logDir, { recursive: true });\n  } catch {\n    // Ignore\n  }\n\n  const timestamp = new Date().toISOString().replace('T', ' ').slice(0, 19);\n  const logContent = `[${timestamp}] Code Review Summary\nReview checklist:\n  [ ] All blocking issues addressed\n  [ ] Non-blocking suggestions noted\n  [ ] Tests pass\n  [ ] No security concerns\n  [ ] Documentation updated if needed\n\nConventional comment prefixes used:\n  - blocking: Must fix before merge\n  - suggestion: Consider this improvement\n  - nitpick: Minor style issue\n  - question: Needs clarification\n  - praise: Good work!\n`;\n\n  // Write to log file (silent operation)\n  try {\n    appendFileSync(logFile, logContent + '\\n');\n  } catch {\n    // Ignore logging errors\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Security Summary Hook\n * Runs on Stop for security-scanning skill\n * Generates a summary of security scan completion - silent operation\n * CC 2.1.7 Compliant\n */\n\nimport { appendFileSync, mkdirSync } from 'node:fs';\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, getLogDir } from '../lib/common.js';\n\n/**\n * Generate security scan summary on session stop\n */\nexport function securitySummary(_input: HookInput): HookResult {\n  const logDir = getLogDir();\n  const logFile = `${logDir}/security-summary.log`;\n\n  // Ensure log directory exists\n  try {\n    mkdirSync(logDir, { recursive: true });\n  } catch {\n    // Ignore\n  }\n\n  const timestamp = new Date().toISOString().replace('T', ' ').slice(0, 19);\n  const logContent = `[${timestamp}] Security Scan Complete\nReview findings for:\n  - Critical/High vulnerabilities (fix immediately)\n  - Dependency CVEs (update packages)\n  - Hardcoded secrets (move to env vars)\n  - OWASP Top 10 violations\n\nNext steps:\n  1. Triage findings by severity\n  2. Create issues for critical/high\n  3. Update dependencies with CVEs\n`;\n\n  // Write to log file (silent operation)\n  try {\n    appendFileSync(logFile, logContent + '\\n');\n  } catch {\n    // Ignore logging errors\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Structure Location Validator Hook\n * BLOCKING: Files must be in correct architectural locations\n * CC 2.1.7 Compliant\n */\n\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, outputBlock, logHook } from '../lib/common.js';\nimport { guardCodeFiles } from '../lib/guards.js';\n\nconst MAX_DEPTH = 4;\n\n/**\n * Validate file structure and location\n */\nexport function structureLocationValidator(input: HookInput): HookResult {\n  // Self-guard: Only run for code files\n  const guard = guardCodeFiles(input);\n  if (guard) return guard;\n\n  const filePath = input.tool_input.file_path || '';\n  if (!filePath) return outputSilentSuccess();\n\n  const errors: string[] = [];\n  const filename = filePath.split('/').pop() || '';\n\n  // Rule: Max nesting depth (4 levels from src/ or app/)\n  if (filePath.includes('/src/') || filePath.includes('/app/')) {\n    let relativePath = '';\n    if (filePath.includes('/src/')) {\n      relativePath = filePath.split('/src/')[1] || '';\n    } else {\n      relativePath = filePath.split('/app/')[1] || '';\n    }\n\n    const depth = relativePath.split('/').filter(Boolean).length;\n    if (depth > MAX_DEPTH) {\n      errors.push(`NESTING: Max depth exceeded - ${depth} levels (max: ${MAX_DEPTH})`);\n    }\n  }\n\n  // Rule: No barrel files (index.ts that only re-export)\n  if (/^index\\.(ts|tsx|js)$/.test(filename)) {\n    if (!filePath.includes('/app/') && !/\\/(node_modules|dist|build)\\//.test(filePath)) {\n      errors.push('BARREL: Barrel files (index.ts) are discouraged - import directly from source');\n    }\n  }\n\n  // React/TypeScript structure rules\n  if (/\\.(tsx|ts|jsx|js)$/.test(filePath)) {\n    // Rule: React components (PascalCase) must be in components/ or features/\n    if (/^[A-Z][a-zA-Z0-9]*\\.(tsx|jsx)$/.test(filename)) {\n      if (!/(components\\/|features\\/|app\\/|pages\\/)/.test(filePath)) {\n        errors.push('COMPONENT: React components must be in components/, features/, or app/');\n      }\n    }\n\n    // Rule: Custom hooks (useX) must be in hooks/ directory\n    if (/^use[A-Z][a-zA-Z0-9]*\\.(ts|tsx)$/.test(filename)) {\n      if (!/(hooks\\/|\\/hooks\\/)/.test(filePath)) {\n        errors.push('HOOK: Custom hooks must be in hooks/ directory');\n      }\n    }\n  }\n\n  // FastAPI/Python structure rules\n  if (filePath.endsWith('.py')) {\n    const dirname = filePath.substring(0, filePath.lastIndexOf('/'));\n\n    // Rule: Router files must be in routers/\n    if (/^(router_|routes_|api_).*\\.py$/.test(filename)) {\n      if (!dirname.endsWith('/routers') && !dirname.endsWith('routers')) {\n        errors.push('ROUTER: Router files must be in routers/ directory');\n      }\n    }\n\n    // Rule: Service files must be in services/\n    if (/_service\\.py$/.test(filename)) {\n      if (!dirname.endsWith('/services') && !dirname.endsWith('services')) {\n        errors.push('SERVICE: Service files must be in services/ directory');\n      }\n    }\n\n    // Rule: Repository files must be in repositories/\n    if (/_(repository|repo)\\.py$/.test(filename)) {\n      if (!dirname.endsWith('/repositories') && !dirname.endsWith('repositories')) {\n        errors.push('REPOSITORY: Repository files must be in repositories/ directory');\n      }\n    }\n  }\n\n  // Report errors and block\n  if (errors.length > 0) {\n    const reason = `Structure violation: ${errors[0]}`;\n    logHook('structure-location-validator', `BLOCKED: ${reason}`);\n    return outputBlock(reason);\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Test Location Validator Hook\n * BLOCKING: Tests must be in correct location\n * CC 2.1.7 Compliant\n */\n\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, outputBlock, logHook } from '../lib/common.js';\nimport { guardCodeFiles } from '../lib/guards.js';\n\n/**\n * Check if file is a test file\n */\nfunction isTestFile(filePath: string): boolean {\n  // TypeScript/JavaScript test patterns\n  if (/\\.(test|spec)\\.(ts|tsx|js|jsx)$/.test(filePath)) return true;\n\n  // Python test patterns\n  if (/(^|\\/)test_[^/]*\\.py$/.test(filePath)) return true;\n  if (/_test\\.py$/.test(filePath)) return true;\n\n  return false;\n}\n\n/**\n * Validate test file location\n */\nexport function testLocationValidator(input: HookInput): HookResult {\n  // Self-guard: Only run for code files\n  const guard = guardCodeFiles(input);\n  if (guard) return guard;\n\n  const filePath = input.tool_input.file_path || '';\n  if (!filePath) return outputSilentSuccess();\n\n  const filename = filePath.split('/').pop() || '';\n  const isTest = isTestFile(filePath);\n\n  // Rule 1: Test files MUST be in test directories\n  if (isTest) {\n    if (!/(tests\\/|__tests__\\/|\\/test\\/|test\\/)/.test(filePath)) {\n      const reason = `Test file must be in tests/, __tests__/, or test/ directory: ${filename}`;\n      logHook('test-location-validator', `BLOCKED: ${reason}`);\n      return outputBlock(reason);\n    }\n  }\n\n  // Rule 2: Source files CANNOT be in test directories\n  if (!isTest && /(tests\\/|__tests__\\/|\\/test\\/)/.test(filePath)) {\n    // Allow certain files in test directories\n    const allowedPatterns = [\n      /^(conftest|fixtures|factories|mocks|__init__|setup|helpers|utils)\\.py$/,\n      /^(setup|helpers|utils|mocks|fixtures)\\.(ts|js)$/,\n    ];\n\n    const isAllowed = allowedPatterns.some((pattern) => pattern.test(filename));\n    const isInAllowedDir = /\\/(fixtures|mocks|factories|__mocks__)\\//.test(filePath);\n\n    if (!isAllowed && !isInAllowedDir) {\n      const reason = `Source files cannot be in test directories: ${filename}`;\n      logHook('test-location-validator', `BLOCKED: ${reason}`);\n      return outputBlock(reason);\n    }\n  }\n\n  // Rule 3: TypeScript/JavaScript tests must use .test or .spec suffix\n  if (/\\.(ts|tsx|js|jsx)$/.test(filePath) && /(tests\\/|__tests__)/.test(filePath)) {\n    // Skip setup/utility files\n    if (/^(setup|jest|vitest|config|helpers|utils|mocks)\\./.test(filename)) {\n      return outputSilentSuccess();\n    }\n\n    // Must have .test or .spec suffix\n    if (!/\\.(test|spec)\\.(ts|tsx|js|jsx)$/.test(filename)) {\n      const reason = `Test files must use .test.ts or .spec.ts suffix: ${filename}`;\n      logHook('test-location-validator', `BLOCKED: ${reason}`);\n      return outputBlock(reason);\n    }\n  }\n\n  // Rule 4: Python tests must follow naming convention\n  if (filePath.endsWith('.py') && /(tests\\/|\\/test\\/)/.test(filePath)) {\n    // Skip utility files\n    if (/^(conftest|__init__|fixtures|factories|mocks|helpers)\\.py$/.test(filename)) {\n      return outputSilentSuccess();\n    }\n\n    // Must start with test_ or end with _test.py\n    if (!/^test_.*\\.py$/.test(filename) && !/_test\\.py$/.test(filename)) {\n      const reason = `Python test files must be named test_*.py or *_test.py: ${filename}`;\n      logHook('test-location-validator', `BLOCKED: ${reason}`);\n      return outputBlock(reason);\n    }\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Test Pattern Validator Hook\n * BLOCKING: Tests must follow AAA pattern and naming conventions\n * CC 2.1.7 Compliant\n */\n\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, outputBlock, logHook } from '../lib/common.js';\n\n/**\n * Check if file is a test file\n */\nfunction isTestFile(filePath: string): boolean {\n  if (/\\.(test|spec)\\.(ts|tsx|js|jsx)$/.test(filePath)) return true;\n  if (/(^|\\/)test_[^/]*\\.py$/.test(filePath)) return true;\n  if (/_test\\.py$/.test(filePath)) return true;\n  return false;\n}\n\n/**\n * Validate test patterns and conventions\n */\nexport function testPatternValidator(input: HookInput): HookResult {\n  const filePath = input.tool_input?.file_path || '';\n  const content = input.tool_input?.content || (input as any).tool_result || '';\n\n  if (!filePath || !content) return outputSilentSuccess();\n\n  // Only validate test files\n  if (!isTestFile(filePath)) return outputSilentSuccess();\n\n  const errors: string[] = [];\n\n  // TypeScript/JavaScript test validation\n  if (/\\.(ts|tsx|js|jsx)$/.test(filePath)) {\n    // Rule: Test names must be descriptive (not too short)\n    const shortTests = content.match(/(test|it)\\(['\"][^'\"]{1,10}['\"]/g);\n    if (shortTests) {\n      if (shortTests.some((t: string) => /test[0-9]|works|^test$/i.test(t))) {\n        errors.push('Test names too short or generic. Use descriptive names:');\n        errors.push(\"  BAD:  test('test1'), test('works')\");\n        errors.push(\"  GOOD: test('should return user when ID exists')\");\n      }\n    }\n\n    // Rule: No shared mutable state without beforeEach reset\n    if (/^let [a-zA-Z_][a-zA-Z0-9_]* =/m.test(content)) {\n      if (!/beforeEach\\s*\\(\\s*(async\\s*)?\\(\\s*\\)\\s*=>/.test(content)) {\n        errors.push('Shared mutable state detected without beforeEach reset:');\n        errors.push('  Add beforeEach(() => { /* reset state */ }) to ensure test isolation');\n      }\n    }\n\n    // Rule: Avoid too many expects in single test\n    const totalExpects = (content.match(/expect\\(/g) || []).length;\n    const totalTests = (content.match(/(test|it)\\s*\\(/g) || []).length || 1;\n    const avgExpects = Math.floor(totalExpects / totalTests);\n\n    if (avgExpects > 5) {\n      errors.push(`High assertion count (avg ${avgExpects} per test):`);\n      errors.push('  Consider splitting into focused tests with 1-3 assertions each');\n      errors.push('  Or add AAA comments (// Arrange, // Act, // Assert)');\n    }\n\n    // Rule: No console.log in tests\n    if (/console\\.(log|warn|error)\\(/.test(content)) {\n      errors.push('console.log found in test file:');\n      errors.push('  Remove debugging statements before committing');\n      errors.push('  Use proper assertions instead');\n    }\n\n    // Rule: No .only() left in tests\n    if (/(test|it|describe)\\.only\\(/.test(content)) {\n      errors.push('.only() found - this skips other tests:');\n      errors.push('  Remove .only() before committing');\n    }\n\n    // Rule: No .skip() without explanation\n    if (/(test|it|describe)\\.skip\\(/.test(content)) {\n      if (!/TODO|FIXME|skip.*because|temporarily/i.test(content)) {\n        errors.push('.skip() found without explanation:');\n        errors.push('  Add a comment explaining why the test is skipped');\n        errors.push(\"  Example: test.skip('reason: waiting for API fix')\");\n      }\n    }\n  }\n\n  // Python test validation\n  if (filePath.endsWith('.py')) {\n    // Rule: Test function naming must use snake_case\n    if (/def test[A-Z]/.test(content)) {\n      errors.push('Test names must use snake_case, not camelCase:');\n      errors.push('  BAD:  def testUserCreation()');\n      errors.push('  GOOD: def test_user_creation()');\n    }\n\n    // Rule: Use pytest fixtures, not unittest setUp/tearDown\n    if (/def (setUp|tearDown|setUpClass|tearDownClass)\\s*\\(/.test(content)) {\n      errors.push('Use pytest fixtures instead of unittest setUp/tearDown:');\n      errors.push('  BAD:  def setUp(self): ...');\n      errors.push('  GOOD: @pytest.fixture\\\\n        def setup_data(): ...');\n    }\n\n    // Rule: No class-level mutable defaults\n    if (/class Test.*:/.test(content)) {\n      if (/^\\s+[a-z_]+ = \\[\\]/m.test(content) || /^\\s+[a-z_]+ = \\{\\}/m.test(content)) {\n        errors.push('Class-level mutable defaults can cause test pollution:');\n        errors.push('  BAD:  class TestUser:\\\\n            items = []');\n        errors.push('  GOOD: Use @pytest.fixture to create fresh instances');\n      }\n    }\n\n    // Rule: No print statements in tests\n    if (/^\\s+print\\(/m.test(content)) {\n      errors.push('print() found in test file:');\n      errors.push('  Remove debugging statements before committing');\n      errors.push(\"  Use proper assertions or pytest's capfd fixture\");\n    }\n\n    // Rule: No @pytest.mark.skip without reason\n    if (/@pytest\\.mark\\.skip\\s*$/.test(content) || /@pytest\\.mark\\.skip\\(\\s*\\)/.test(content)) {\n      errors.push('@pytest.mark.skip without reason:');\n      errors.push(\"  Add reason: @pytest.mark.skip(reason='waiting for fix')\");\n    }\n\n    // Rule: Async tests should use pytest-asyncio\n    if (/async def test_/.test(content)) {\n      if (!/@pytest\\.mark\\.asyncio/.test(content)) {\n        errors.push('Async test found without @pytest.mark.asyncio:');\n        errors.push('  Add: @pytest.mark.asyncio');\n        errors.push('  Or set asyncio_mode = auto in pytest.ini');\n      }\n    }\n  }\n\n  // Report errors and block\n  if (errors.length > 0) {\n    logHook('test-pattern-validator', `BLOCKED: ${errors[0]}`);\n    return outputBlock(`Test pattern violations detected in ${filePath}`);\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Test Runner Hook\n * Runs after Write in testing skills\n * Auto-runs the test file that was just created/modified\n * CC 2.1.7 Compliant\n */\n\nimport { existsSync, readFileSync } from 'node:fs';\nimport { execSync } from 'node:child_process';\nimport type { HookInput, HookResult } from '../types.js';\nimport { outputSilentSuccess, getProjectDir } from '../lib/common.js';\n\n/**\n * Find project root by looking for package.json\n */\nfunction findProjectRoot(startDir: string): string | null {\n  let dir = startDir;\n  while (dir !== '/') {\n    if (existsSync(`${dir}/package.json`)) {\n      return dir;\n    }\n    dir = dir.substring(0, dir.lastIndexOf('/'));\n  }\n  return null;\n}\n\n/**\n * Auto-run test file that was just created/modified\n */\nexport function testRunner(input: HookInput): HookResult {\n  const filePath = input.tool_input?.file_path || process.env.CC_TOOL_FILE_PATH || '';\n\n  // Early exit if no file path\n  if (!filePath) return outputSilentSuccess();\n\n  // Python test files\n  if (/test.*\\.py$/.test(filePath) || /_test\\.py$/.test(filePath)) {\n    process.stderr.write(`::group::Auto-running Python test: ${filePath.split('/').pop()}\\n`);\n\n    const dir = filePath.substring(0, filePath.lastIndexOf('/'));\n\n    try {\n      // Check for poetry\n      if (existsSync(`${dir}/pyproject.toml`)) {\n        try {\n          execSync('command -v poetry', { stdio: ['pipe', 'pipe', 'pipe'] });\n          const result = execSync(`poetry run pytest \"${filePath}\" -v --tb=short`, {\n            cwd: dir,\n            encoding: 'utf8',\n            timeout: 60000,\n            stdio: ['pipe', 'pipe', 'pipe'],\n          });\n          const lines = result.split('\\n').slice(-30);\n          process.stderr.write(lines.join('\\n') + '\\n');\n        } catch {\n          // Poetry not available, try pytest directly\n        }\n      }\n\n      // Try pytest directly\n      try {\n        execSync('command -v pytest', { stdio: ['pipe', 'pipe', 'pipe'] });\n        const result = execSync(`pytest \"${filePath}\" -v --tb=short`, {\n          cwd: dir,\n          encoding: 'utf8',\n          timeout: 60000,\n          stdio: ['pipe', 'pipe', 'pipe'],\n        });\n        const lines = result.split('\\n').slice(-30);\n        process.stderr.write(lines.join('\\n') + '\\n');\n      } catch {\n        process.stderr.write('pytest not found - skipping auto-run\\n');\n      }\n    } catch (error) {\n      // Test execution errors are logged but don't block\n      if (error instanceof Error) {\n        process.stderr.write(`Test execution error: ${error.message}\\n`);\n      }\n    }\n\n    process.stderr.write('::endgroup::\\n');\n  }\n\n  // TypeScript/JavaScript test files\n  if (/\\.(test|spec)\\.(ts|tsx|js|jsx)$/.test(filePath)) {\n    process.stderr.write(`::group::Auto-running TypeScript test: ${filePath.split('/').pop()}\\n`);\n\n    // Find project root\n    const projectRoot = findProjectRoot(filePath.substring(0, filePath.lastIndexOf('/')));\n\n    if (projectRoot) {\n      try {\n        const testPattern = filePath\n          .split('/')\n          .pop()\n          ?.replace(/\\.[^.]+$/, '')\n          .replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n\n        const result = execSync(`npm test -- --testPathPattern=\"${testPattern}\"`, {\n          cwd: projectRoot,\n          encoding: 'utf8',\n          timeout: 60000,\n          stdio: ['pipe', 'pipe', 'pipe'],\n        });\n        const lines = result.split('\\n').slice(-30);\n        process.stderr.write(lines.join('\\n') + '\\n');\n      } catch (error) {\n        // Test execution errors are logged but don't block\n        if (error instanceof Error) {\n          process.stderr.write(`Test execution error: ${error.message}\\n`);\n        }\n      }\n    }\n\n    process.stderr.write('::endgroup::\\n');\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Skill Hooks Entry Point\n *\n * Hooks that are skill-specific (validation, tracking, etc.)\n * Bundle: skill.mjs (~50 KB estimated)\n */\n\n// Re-export types and utilities\nexport * from '../types.js';\nexport * from '../lib/common.js';\nexport * from '../lib/git.js';\n\n// Skill hooks (24)\nimport { backendFileNaming } from '../skill/backend-file-naming.js';\nimport { decisionProcessor } from '../skill/decision-processor.js';\nimport { backendLayerValidator } from '../skill/backend-layer-validator.js';\nimport { coverageCheck } from '../skill/coverage-check.js';\nimport { coverageThresholdGate } from '../skill/coverage-threshold-gate.js';\nimport { crossInstanceTestValidator } from '../skill/cross-instance-test-validator.js';\nimport { diPatternEnforcer } from '../skill/di-pattern-enforcer.js';\nimport { duplicateCodeDetector } from '../skill/duplicate-code-detector.js';\nimport { evalMetricsCollector } from '../skill/eval-metrics-collector.js';\nimport { evidenceCollector } from '../skill/evidence-collector.js';\nimport { importDirectionEnforcer } from '../skill/import-direction-enforcer.js';\nimport { mergeConflictPredictor } from '../skill/merge-conflict-predictor.js';\nimport { mergeReadinessChecker } from '../skill/merge-readiness-checker.js';\nimport { migrationValidator } from '../skill/migration-validator.js';\nimport { patternConsistencyEnforcer } from '../skill/pattern-consistency-enforcer.js';\nimport { redactSecrets } from '../skill/redact-secrets.js';\nimport { reviewSummaryGenerator } from '../skill/review-summary-generator.js';\nimport { securitySummary } from '../skill/security-summary.js';\nimport { structureLocationValidator } from '../skill/structure-location-validator.js';\nimport { testLocationValidator } from '../skill/test-location-validator.js';\nimport { testPatternValidator } from '../skill/test-pattern-validator.js';\nimport { testRunner } from '../skill/test-runner.js';\n\nimport type { HookFn } from '../types.js';\n\n/**\n * Skill hooks registry\n */\nexport const hooks: Record<string, HookFn> = {\n  'skill/backend-file-naming': backendFileNaming,\n  'skill/decision-processor': decisionProcessor,\n  'skill/backend-layer-validator': backendLayerValidator,\n  'skill/coverage-check': coverageCheck,\n  'skill/coverage-threshold-gate': coverageThresholdGate,\n  'skill/cross-instance-test-validator': crossInstanceTestValidator,\n  'skill/di-pattern-enforcer': diPatternEnforcer,\n  'skill/duplicate-code-detector': duplicateCodeDetector,\n  'skill/eval-metrics-collector': evalMetricsCollector,\n  'skill/evidence-collector': evidenceCollector,\n  'skill/import-direction-enforcer': importDirectionEnforcer,\n  'skill/merge-conflict-predictor': mergeConflictPredictor,\n  'skill/merge-readiness-checker': mergeReadinessChecker,\n  'skill/migration-validator': migrationValidator,\n  'skill/pattern-consistency-enforcer': patternConsistencyEnforcer,\n  'skill/redact-secrets': redactSecrets,\n  'skill/review-summary-generator': reviewSummaryGenerator,\n  'skill/security-summary': securitySummary,\n  'skill/structure-location-validator': structureLocationValidator,\n  'skill/test-location-validator': testLocationValidator,\n  'skill/test-pattern-validator': testPatternValidator,\n  'skill/test-runner': testRunner,\n};\n\nexport function getHook(name: string): HookFn | undefined {\n  return hooks[name];\n}\n\nexport function listHooks(): string[] {\n  return Object.keys(hooks);\n}\n"],
  "mappings": "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",
  "names": ["isBashInput", "input", "isWriteInput", "isEditInput", "isReadInput", "appendFileSync", "existsSync", "statSync", "renameSync", "mkdirSync", "readSync", "execSync", "getLogDir", "getProjectDir", "getPluginRoot", "getSessionId", "getCachedBranch", "projectDir", "branch", "getLogLevel", "shouldLog", "level", "levels", "outputSilentSuccess", "outputSilentAllow", "outputBlock", "reason", "outputWithContext", "ctx", "outputPromptContext", "outputAllowWithContext", "systemMessage", "result", "outputError", "message", "outputWarning", "outputDeny", "LOG_ROTATION_MAX_SIZE", "PERMISSION_LOG_MAX_SIZE", "rotateLogFile", "logFile", "maxSize", "rotated", "ensureDir", "dir", "logHook", "hookName", "logDir", "timestamp", "logPermissionFeedback", "decision", "input", "toolName", "sessionId", "estimateTokenCount", "content", "charsPerToken", "outputPromptContextBudgeted", "category", "budgetChecker", "tokenTracker", "tokens", "readHookInput", "chunks", "buf", "bytesRead", "fd", "getField", "path", "parts", "value", "part", "normalizeCommand", "command", "escapeRegex", "str", "execSync", "getCurrentBranch", "projectDir", "dir", "getProjectDir", "execSync", "isProtectedBranch", "branch", "currentBranch", "getRepoRoot", "isGitRepo", "getGitStatus", "hasUncommittedChanges", "getDefaultBranch", "extractIssueNumber", "patterns", "pattern", "match", "validateBranchName", "validPrefixes", "prefix", "guardFileExtension", "input", "extensions", "filePath", "outputSilentSuccess", "ext", "e", "guardCodeFiles", "guardPythonFiles", "backendFileNaming", "input", "guard", "guardPythonFiles", "filePath", "outputSilentSuccess", "filename", "dirname", "errors", "validRouterPattern", "utilPattern", "validServicePattern", "validRepoPattern", "validSchemaPattern", "validModelPattern", "reason", "logHook", "outputBlock", "execSync", "readFileSync", "existsSync", "join", "MIN_OUTPUT_LENGTH", "MAX_TEXT_LENGTH", "DECISION_INDICATORS", "KNOWN_AGENTS", "KNOWN_TECHNOLOGIES", "KNOWN_PATTERNS", "BEST_PRACTICE_PATTERNS", "HIGH_IMPORTANCE", "MEDIUM_IMPORTANCE", "cachedPluginVersion", "getCCVersion", "match", "getPluginVersion", "pluginRoot", "getPluginRoot", "path", "extractEntities", "text", "textLower", "a", "p", "detectRelationType", "t", "hasDecisionContent", "output", "lower", "ind", "extractDecisions", "decisions", "indicator", "regex", "matches", "cleaned", "detectCategory", "detectImportance", "k", "extractBestPractice", "name", "pattern", "decisionProcessor", "input", "skillName", "toolResult", "skillOutput", "outputSilentSuccess", "entities", "totalEntities", "parts", "firstDecision", "category", "importance", "bestPractice", "ccVersion", "pluginVersion", "metadata", "scriptPath", "relationType", "entityList", "backendLayerValidator", "input", "guard", "guardPythonFiles", "filePath", "content", "outputSilentSuccess", "errors", "reason", "logHook", "outputBlock", "existsSync", "appendFileSync", "mkdirSync", "execSync", "coverageCheck", "_input", "projectDir", "getProjectDir", "logDir", "getLogDir", "logFile", "threshold", "mkdirSync", "logLines", "timestamp", "coverageFile", "coverageXml", "existsSync", "totalLine", "execSync", "line", "match", "coverage", "coverageDir", "summaryFile", "appendFileSync", "outputSilentSuccess", "existsSync", "readFileSync", "COVERAGE_PATHS", "parseCoverage", "filePath", "content", "data", "coverageThresholdGate", "_input", "projectDir", "getProjectDir", "threshold", "coverageFile", "coverageContent", "path", "fullPath", "existsSync", "readFileSync", "outputSilentSuccess", "coverage", "reason", "outputBlock", "existsSync", "readFileSync", "isTestFile", "filePath", "findTestFile", "implFile", "base", "ext", "patterns", "pattern", "existsSync", "dir", "baseFilename", "testDirPatterns", "testFilename", "parentDir", "extractTestableUnits", "content", "units", "matches", "match", "name", "lines", "line", "crossInstanceTestValidator", "input", "outputSilentSuccess", "errors", "warnings", "testFile", "testableUnits", "testContent", "readFileSync", "untestedUnits", "unit", "filename", "outputBlock", "warningContext", "outputWithContext", "diPatternEnforcer", "input", "filePath", "content", "outputSilentSuccess", "filename", "errors", "match", "syncPattern", "lines", "line", "logHook", "ctx", "outputWithContext", "readFileSync", "readdirSync", "extractSignatures", "content", "filePath", "signatures", "matches", "lines", "line", "match", "findCodeFiles", "dir", "pattern", "files", "ignoreDirs", "walk", "currentDir", "entries", "readdirSync", "entry", "fullPath", "checkCopyPastePatterns", "warnings", "prev", "count", "startLine", "checkUtilityPatterns", "errors", "fetchCount", "validationCount", "jsonCount", "envCount", "duplicateCodeDetector", "input", "outputSilentSuccess", "projectRoot", "getRepoRoot", "getProjectDir", "codeFiles", "signature", "name", "codeFile", "fileContent", "readFileSync", "relPath", "copyPasteWarnings", "w", "utilityCheck", "ctx", "outputWithContext", "existsSync", "readFileSync", "readdirSync", "evalMetricsCollector", "_input", "projectDir", "getProjectDir", "messages", "evalResultsPath", "existsSync", "content", "readFileSync", "data", "key", "value", "formatted", "lines", "deepevalDir", "files", "readdirSync", "file", "ragasPath", "msg", "outputSilentSuccess", "existsSync", "appendFileSync", "mkdirSync", "readdirSync", "evidenceCollector", "_input", "logDir", "getLogDir", "projectDir", "getProjectDir", "logFile", "mkdirSync", "timestamp", "logLines", "lastExitCode", "existsSync", "testResultsDir", "files", "readdirSync", "file", "appendFileSync", "outputSilentSuccess", "getLayer", "filePath", "importDirectionEnforcer", "input", "guard", "guardCodeFiles", "content", "outputSilentSuccess", "layer", "errors", "reason", "logHook", "outputBlock", "existsSync", "readFileSync", "execSync", "getWorktrees", "execSync", "line", "getWorktreeBranch", "worktree", "isFileModified", "relPath", "status", "getBranchDivergence", "baseBranch", "currentBranch", "ahead", "behind", "mergeConflictPredictor", "input", "filePath", "content", "outputSilentSuccess", "worktrees", "warnings", "conflicts", "repoRoot", "getRepoRoot", "getProjectDir", "currentWorktree", "worktreeFile", "existsSync", "branch", "otherContent", "readFileSync", "newLines", "otherLines", "diff", "getCurrentBranch", "getDefaultBranch", "conflict", "ctx", "outputWithContext", "existsSync", "readFileSync", "execSync", "gitExec", "command", "cwd", "execSync", "getProjectDir", "mergeReadinessChecker", "input", "outputSilentSuccess", "targetBranch", "currentBranch", "getCurrentBranch", "projectRoot", "getRepoRoot", "errors", "warnings", "passes", "hasUncommittedChanges", "status", "ahead", "behind", "conflictFiles", "file", "mergeBase", "fileCount", "existsSync", "readFileSync", "pass", "warning", "error", "existsSync", "readFileSync", "execSync", "migrationValidator", "input", "filePath", "outputSilentSuccess", "existsSync", "errors", "content", "readFileSync", "outputWithContext", "execSync", "error", "logHook", "ctx", "existsSync", "patternConsistencyEnforcer", "input", "filePath", "content", "outputSilentSuccess", "patternsFile", "getRepoRoot", "getProjectDir", "existsSync", "errors", "warnings", "outputBlock", "warning", "API_KEY_PATTERNS", "SECRET_PATTERNS", "redactSecrets", "input", "toolOutput", "outputSilentSuccess", "pattern", "appendFileSync", "mkdirSync", "reviewSummaryGenerator", "_input", "logDir", "getLogDir", "logFile", "mkdirSync", "logContent", "appendFileSync", "outputSilentSuccess", "appendFileSync", "mkdirSync", "securitySummary", "_input", "logDir", "getLogDir", "logFile", "mkdirSync", "logContent", "appendFileSync", "outputSilentSuccess", "MAX_DEPTH", "structureLocationValidator", "input", "guard", "guardCodeFiles", "filePath", "outputSilentSuccess", "errors", "filename", "relativePath", "depth", "dirname", "reason", "logHook", "outputBlock", "isTestFile", "filePath", "testLocationValidator", "input", "guard", "guardCodeFiles", "outputSilentSuccess", "filename", "isTest", "reason", "logHook", "outputBlock", "isAllowed", "pattern", "isInAllowedDir", "isTestFile", "filePath", "testPatternValidator", "input", "content", "outputSilentSuccess", "errors", "shortTests", "t", "totalExpects", "totalTests", "avgExpects", "logHook", "outputBlock", "existsSync", "execSync", "findProjectRoot", "startDir", "dir", "existsSync", "testRunner", "input", "filePath", "outputSilentSuccess", "execSync", "lines", "error", "projectRoot", "testPattern", "hooks", "backendFileNaming", "decisionProcessor", "backendLayerValidator", "coverageCheck", "coverageThresholdGate", "crossInstanceTestValidator", "diPatternEnforcer", "duplicateCodeDetector", "evalMetricsCollector", "evidenceCollector", "importDirectionEnforcer", "mergeConflictPredictor", "mergeReadinessChecker", "migrationValidator", "patternConsistencyEnforcer", "redactSecrets", "reviewSummaryGenerator", "securitySummary", "structureLocationValidator", "testLocationValidator", "testPatternValidator", "testRunner", "getHook", "name", "listHooks"]
}
