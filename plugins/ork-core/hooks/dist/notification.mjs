// OrchestKit Hooks - notification bundle
// Generated: 2026-01-30T15:14:32.154Z

function ot(t){return typeof t.command=="string"}function nt(t){return typeof t.file_path=="string"&&typeof t.content=="string"}function et(t){return typeof t.file_path=="string"&&typeof t.old_string=="string"&&typeof t.new_string=="string"}function rt(t){return typeof t.file_path=="string"&&t.content===void 0}import{appendFileSync as S,existsSync as H,statSync as N,renameSync as w,mkdirSync as U,readSync as L}from"node:fs";import{execSync as B}from"node:child_process";import v from"node:os";import p from"node:path";function C(){return process.env.HOME||process.env.USERPROFILE||v.homedir()}function l(){return process.env.CLAUDE_PROJECT_DIR||"."}function x(){return process.env.CLAUDE_PLUGIN_ROOT||process.env.CLAUDE_PROJECT_DIR||"."}function y(){return process.env.CLAUDE_PLUGIN_ROOT?p.join(C(),".claude","logs","ork"):p.join(l(),".claude","logs")}var ct=p.join,pt=p.sep;function _(){return y()}function d(){return l()}function mt(){return x()}function m(){return process.env.CLAUDE_SESSION_ID||`fallback-${process.pid}-${Date.now()}`}function R(t){if(process.env.ORCHESTKIT_BRANCH)return process.env.ORCHESTKIT_BRANCH;try{let n=B("git branch --show-current",{cwd:t||d(),encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}).trim();return process.env.ORCHESTKIT_BRANCH=n,n}catch{return"unknown"}}function j(){return process.env.ORCHESTKIT_LOG_LEVEL||"warn"}function F(t){let n=["debug","info","warn","error"];return n.indexOf(t)>=n.indexOf(j())}function s(){return{continue:!0,suppressOutput:!0}}function dt(){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{permissionDecision:"allow"}}}function kt(t){return{continue:!1,stopReason:t,hookSpecificOutput:{permissionDecision:"deny",permissionDecisionReason:t}}}function ht(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"PostToolUse",additionalContext:t}}}function A(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"UserPromptSubmit",additionalContext:t}}}function xt(t,n){let e={continue:!0,hookSpecificOutput:{hookEventName:"PreToolUse",additionalContext:t,permissionDecision:"allow"}};return n?e.systemMessage=n:e.suppressOutput=!0,e}function yt(t){return{continue:!0,systemMessage:t}}function St(t){return{continue:!0,systemMessage:`\u26A0 ${t}`}}function Ht(t){return{continue:!1,stopReason:t,hookSpecificOutput:{hookEventName:"PreToolUse",permissionDecision:"deny",permissionDecisionReason:t}}}var M=200*1024,W=100*1024;function I(t,n){if(H(t))try{if(N(t).size>n){let o=`${t}.old.${Date.now()}`;w(t,o)}}catch{}}function b(t){H(t)||U(t,{recursive:!0})}function u(t,n,e="debug"){if(!F(e))return;let o=_(),r=`${o}/hooks.log`;try{b(o),I(r,M);let i=new Date().toISOString().replace("T"," ").slice(0,19);S(r,`[${i}] [${e.toUpperCase()}] [${t}] ${n}
`)}catch{}}function _t(t,n,e){let o=_(),r=`${o}/permission-feedback.log`;try{b(o),I(r,W);let i=new Date().toISOString(),c=e?.tool_name||process.env.HOOK_TOOL_NAME||"unknown",f=e?.session_id||m();S(r,`${i} | ${t} | ${n} | tool=${c} | session=${f}
`)}catch{}}function G(t){if(!t)return 0;let o=(t.match(/[{};()=><]/g)||[]).length/t.length>.03?2.8:3.5;return Math.ceil(t.length/o)}function Rt(t,n,e,o,r){let i=G(t);return o&&o.isOverBudget(e)?(u(n,`Budget exhausted for ${e}, suppressing ${i}t`),s()):(r&&r.trackTokenUsage(n,e,i),A(t))}function It(){try{let t=[],e=Buffer.allocUnsafe(256),o,r=0;for(;;)try{if(o=L(r,e,0,256,null),o===0)break;t.push(Buffer.from(e.subarray(0,o)))}catch{break}let i=Buffer.concat(t).toString("utf8").trim();return i?JSON.parse(i):{tool_name:"",session_id:m(),tool_input:{}}}catch{return{tool_name:"",session_id:m(),tool_input:{}}}}function bt(t,n){let e=n.replace(/^\./,"").split("."),o=t;for(let r of e){if(o==null)return;o=o[r]}return o}function Ot(t){return t.replace(/\\\s*[\r\n]+/g," ").replace(/\n/g," ").replace(/\s+/g," ").trim()}function Tt(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}import{execSync as h}from"node:child_process";import{basename as K}from"node:path";var O={permission_prompt:"Sosumi",idle_prompt:"Ping",default:"Ping"};function k(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function T(t){try{return h(`command -v ${t}`,{stdio:"ignore"}),!0}catch{return!1}}function Z(t){let n=t.match(/(?:feature|fix|bug|issue)[/-](\d+)/i);return n?`#${n[1]}`:null}function z(){try{let t=d();return K(t)}catch{return"Claude Code"}}function q(t,n){let e=Z(t),o=n==="permission_prompt"?"\u23F8 Permission needed":"\u{1F4A4} Waiting";return e?`${o} \xB7 ${e} \xB7 ${t}`:`${o} \xB7 ${t}`}function J(t,n=120){return t.length<=n?t:t.substring(0,n-3)+"..."}function X(t,n,e,o){try{let r=k(t),i=k(n),c=k(J(e));return h(`osascript -e 'display notification "${c}" with title "${r}" subtitle "${i}" sound name "${o}"'`,{stdio:"ignore",timeout:5e3}),!0}catch{return!1}}function V(t,n,e){try{let o=`${n}
${e}`;return h(`notify-send -- "${t}" "${o}"`,{stdio:"ignore",timeout:5e3}),!0}catch{return!1}}function a(t){let n=t.tool_input||{},e=n.message||t.message||"",o=n.notification_type||t.notification_type||"";if(u("desktop",`Notification: [${o}] ${e.substring(0,100)}`),o!=="permission_prompt"&&o!=="idle_prompt")return s();let r=z(),i=R(),c=q(i,o),f=O[o]||O.default;return T("osascript")?X(r,c,e,f):T("notify-send")&&V(r,c,e),s()}import{execSync as P}from"node:child_process";var Q={permission_prompt:"/System/Library/Sounds/Sosumi.aiff",idle_prompt:"/System/Library/Sounds/Ping.aiff",auth_success:"/System/Library/Sounds/Glass.aiff"};function Y(){try{return P("command -v afplay",{stdio:"ignore"}),!0}catch{return!1}}function tt(t){try{P(`afplay "${t}" &`,{stdio:"ignore"})}catch{}}function g(t){let e=(t.tool_input||{}).notification_type||"";if(u("sound",`Sound notification check: [${e}]`),Y()){let o=Q[e];o&&tt(o)}return s()}var $=[{name:"desktop",fn:a},{name:"sound",fn:g}];async function D(t){let e=(await Promise.allSettled($.map(async o=>{try{let r=o.fn(t);return r instanceof Promise&&await r,{hook:o.name,status:"success"}}catch(r){let i=r instanceof Error?r.message:String(r);return u("notification-dispatcher",`${o.name} failed: ${i}`),{hook:o.name,status:"error",message:i}}}))).filter(o=>o.status==="rejected"||o.status==="fulfilled"&&o.value.status==="error");return e.length>0&&u("notification-dispatcher",`${e.length}/${$.length} hooks had errors`),s()}var E={"notification/desktop":a,"notification/sound":g,"notification/unified-dispatcher":D};function Wt(t){return E[t]}function Gt(){return Object.keys(E)}export{Tt as escapeRegex,G as estimateTokenCount,R as getCachedBranch,bt as getField,Wt as getHook,_ as getLogDir,j as getLogLevel,mt as getPluginRoot,d as getProjectDir,m as getSessionId,E as hooks,ot as isBashInput,et as isEditInput,rt as isReadInput,nt as isWriteInput,Gt as listHooks,u as logHook,_t as logPermissionFeedback,Ot as normalizeCommand,xt as outputAllowWithContext,kt as outputBlock,Ht as outputDeny,yt as outputError,A as outputPromptContext,Rt as outputPromptContextBudgeted,dt as outputSilentAllow,s as outputSilentSuccess,St as outputWarning,ht as outputWithContext,It as readHookInput,F as shouldLog};
//# sourceMappingURL=notification.mjs.map
