// OrchestKit Hooks - permission bundle
// Generated: 2026-01-23T16:38:20.831Z

var d=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(o,e)=>(typeof require<"u"?require:o)[e]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});function Z(t){return typeof t.command=="string"}function z(t){return typeof t.file_path=="string"&&typeof t.content=="string"}function X(t){return typeof t.file_path=="string"&&typeof t.old_string=="string"&&typeof t.new_string=="string"}function K(t){return typeof t.file_path=="string"&&t.content===void 0}import{appendFileSync as m,existsSync as g,statSync as T,renameSync as b,mkdirSync as O}from"node:fs";var $=process.env.CLAUDE_PLUGIN_ROOT||process.env.CLAUDE_PROJECT_DIR||".",k=process.env.CLAUDE_PROJECT_DIR||".";function h(){return process.env.CLAUDE_PLUGIN_ROOT?`${process.env.HOME}/.claude/logs/ork`:`${k}/.claude/logs`}function x(){return k}function _(){return $}function l(){return process.env.CLAUDE_SESSION_ID}function r(){return{continue:!0,suppressOutput:!0}}function u(){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{permissionDecision:"allow"}}}function V(t){return{continue:!1,stopReason:t,hookSpecificOutput:{permissionDecision:"deny",permissionDecisionReason:t}}}function tt(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"PostToolUse",additionalContext:t}}}function ot(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"UserPromptSubmit",additionalContext:t}}}function et(t,o){let e={continue:!0,hookSpecificOutput:{hookEventName:"PreToolUse",additionalContext:t,permissionDecision:"allow"}};return o?e.systemMessage=o:e.suppressOutput=!0,e}function nt(t){return{continue:!0,systemMessage:t}}function rt(t){return{continue:!0,systemMessage:`\u26A0 ${t}`}}function st(t){return{continue:!1,stopReason:t,hookSpecificOutput:{hookEventName:"PreToolUse",permissionDecision:"deny",permissionDecisionReason:t}}}var D=200*1024,j=100*1024;function R(t,o){if(g(t))try{if(T(t).size>o){let n=`${t}.old.${Date.now()}`;b(t,n)}}catch{}}function y(t){g(t)||O(t,{recursive:!0})}function s(t,o){let e=h(),n=`${e}/hooks.log`;try{y(e),R(n,D);let i=new Date().toISOString().replace("T"," ").slice(0,19);m(n,`[${i}] [${t}] ${o}
`)}catch{}}function p(t,o,e){let n=h(),i=`${n}/permission-feedback.log`;try{y(n),R(i,j);let a=new Date().toISOString(),c=e?.tool_name||process.env.HOOK_TOOL_NAME||"unknown",E=e?.session_id||l();m(i,`${a} | ${t} | ${o} | tool=${c} | session=${E}
`)}catch{}}function it(){try{let t=[],e=Buffer.allocUnsafe(256),n,i=0,{readSync:a}=d("node:fs");for(;;)try{if(n=a(i,e,0,256,null),n===0)break;t.push(Buffer.from(e.subarray(0,n)))}catch{break}let c=Buffer.concat(t).toString("utf8").trim();return c?JSON.parse(c):{tool_name:"",session_id:l(),tool_input:{}}}catch{return{tool_name:"",session_id:l(),tool_input:{}}}}function ut(t,o){let e=o.replace(/^\./,"").split("."),n=t;for(let i of e){if(n==null)return;n=n[i]}return n}function pt(t){return t.replace(/\\\s*[\r\n]+/g," ").replace(/\n/g," ").replace(/\s+/g," ").trim()}function at(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ft(t){return o=>t(o)?null:r()}function f(t,...o){let e=t.tool_input.file_path;if(!e)return r();let n=e.split(".").pop()?.toLowerCase()||"";return o.map(a=>a.toLowerCase().replace(/^\./,"")).includes(n)?null:r()}function dt(t){return f(t,"py","ts","tsx","js","jsx","go","rs","java")}function mt(t){return f(t,"py")}function gt(t){return f(t,"ts","tsx","js","jsx")}function kt(t){let o=t.tool_input.file_path;return o?[/test/i,/spec/i,/__tests__/i].some(n=>n.test(o))?null:r():r()}function ht(t){let o=t.tool_input.file_path||"";return o&&[/\/\.claude\//,/\/node_modules\//,/\/\.git\//,/\/dist\//,/\/build\//,/\/__pycache__\//,/\/\.venv\//,/\/venv\//,/\.lock$/].some(n=>n.test(o))?r():null}function xt(t,...o){let e=t.tool_input.file_path;if(!e)return r();for(let n of o)if(typeof n=="string"){if(new RegExp(n.replace(/\*/g,".*").replace(/\?/g,".")).test(e))return null}else if(n.test(e))return null;return r()}function I(t,...o){let e=t.tool_name;return e?o.includes(e)?null:r():r()}function _t(t){return I(t,"Write","Edit")}function Rt(t){return I(t,"Bash")}function yt(t){let o=t.tool_input.command||"";return[/^echo\s/,/^ls(\s|$)/,/^pwd$/,/^cat\s/,/^head\s/,/^tail\s/,/^wc\s/,/^date$/,/^whoami$/].some(n=>n.test(o))?r():null}function It(t){return(t.tool_input.command||"").startsWith("git")?null:r()}function Ht(t){let e=`${t.project_dir||process.env.CLAUDE_PROJECT_DIR||"."}/.claude/coordination/.claude.db`;try{let{existsSync:n}=d("node:fs");if(n(e))return null}catch{}return r()}function St(t,...o){for(let e of o){let n=e(t);if(n!==null)return n}return null}function H(t){let o=t.tool_name;return s("auto-approve-readonly",`Auto-approving readonly: ${o}`),p("allow",`Auto-approved readonly: ${o}`,t),u()}var A=[/^git (status|log|diff|branch|show|fetch|pull)/,/^git checkout/,/^npm (list|ls|outdated|audit|run|test)/,/^pnpm (list|ls|outdated|audit|run|test)/,/^yarn (list|outdated|audit|run|test)/,/^poetry (show|run|env)/,/^docker (ps|images|logs|inspect)/,/^docker-compose (ps|logs)/,/^docker compose (ps|logs)/,/^ls(\s|$)/,/^pwd$/,/^echo\s/,/^cat\s/,/^head\s/,/^tail\s/,/^wc\s/,/^find\s/,/^which\s/,/^type\s/,/^env$/,/^printenv/,/^gh (issue|pr|repo|workflow) (list|view|status)/,/^gh milestone/,/^pytest/,/^poetry run pytest/,/^npm run (test|lint|typecheck|format)/,/^ruff (check|format)/,/^ty check/,/^mypy/];function S(t){let o=t.tool_input.command||"";s("auto-approve-safe-bash",`Evaluating bash command: ${o.slice(0,50)}...`);for(let e of A)if(e.test(o))return s("auto-approve-safe-bash",`Auto-approved: matches safe pattern ${e}`),p("allow",`Matches safe pattern: ${e}`,t),u();return s("auto-approve-safe-bash","Command requires manual approval"),r()}import{resolve as C,isAbsolute as G}from"node:path";var U=["node_modules",".git","dist","build","__pycache__",".venv","venv"];function v(t){let o=t.tool_input.file_path||"",e=x();if(s("auto-approve-project-writes",`Evaluating write to: ${o}`),G(o)||(o=C(e,o)),o.startsWith(e)){for(let n of U)if(o.includes(`/${n}/`))return s("auto-approve-project-writes",`Write to excluded directory: ${n}`),r();return s("auto-approve-project-writes","Auto-approved: within project directory"),p("allow",`In-project write: ${o}`,t),u()}return s("auto-approve-project-writes","Write outside project directory - manual approval required"),r()}import{existsSync as F,readFileSync as L}from"node:fs";import{join as N}from"node:path";var B=[/rm\s+-rf\s+[/~]/,/sudo\s/,/chmod\s+-R\s+777/,/>\s*\/dev\/sd/,/mkfs\./,/dd\s+if=/,/:.*\(\).*\{.*\|.*&.*\}/,/curl.*\|\s*sh/,/wget.*\|\s*sh/];function W(t){return B.some(o=>o.test(t))}function M(){let t=_(),o=N(t,".claude","feedback","learned-patterns.json");try{if(F(o))return JSON.parse(L(o,"utf8")).autoApprovePatterns||[]}catch{}return[]}function q(t){let o=M();for(let e of o)try{if(new RegExp(e).test(t))return!0}catch{}return!1}function P(t){let o=t.tool_name,e=t.tool_input.command||t.tool_input.file_path||"";if(s("learning-tracker",`Processing permission for tool: ${o}, command: ${e.slice(0,50)}...`),o==="Bash"&&e){if(W(e))return s("learning-tracker","Command matches security blocklist, skipping"),r();if(q(e))return s("learning-tracker","Command matches learned auto-approve pattern"),p("allow","Learned pattern match",t),u()}return r()}var w={"permission/auto-approve-readonly":H,"permission/auto-approve-safe-bash":S,"permission/auto-approve-project-writes":v,"permission/learning-tracker":P};function Nt(t){return w[t]}function Bt(){return Object.keys(w)}export{ft as createGuard,at as escapeRegex,ut as getField,Nt as getHook,h as getLogDir,_ as getPluginRoot,x as getProjectDir,l as getSessionId,Rt as guardBash,dt as guardCodeFiles,f as guardFileExtension,It as guardGitCommand,Ht as guardMultiInstance,yt as guardNontrivialBash,xt as guardPathPattern,mt as guardPythonFiles,ht as guardSkipInternal,kt as guardTestFiles,I as guardTool,gt as guardTypescriptFiles,_t as guardWriteEdit,w as hooks,Z as isBashInput,X as isEditInput,K as isReadInput,z as isWriteInput,Bt as listHooks,s as logHook,p as logPermissionFeedback,pt as normalizeCommand,et as outputAllowWithContext,V as outputBlock,st as outputDeny,nt as outputError,ot as outputPromptContext,u as outputSilentAllow,r as outputSilentSuccess,rt as outputWarning,tt as outputWithContext,it as readHookInput,St as runGuards};
//# sourceMappingURL=permission.mjs.map
