{
  "version": 3,
  "sources": ["../src/types.ts", "../src/lib/common.ts", "../src/setup/first-run-setup.ts", "../src/setup/mem0-analytics-dashboard.ts", "../src/setup/mem0-backup-setup.ts", "../src/setup/mem0-cleanup.ts", "../src/setup/setup-check.ts", "../src/setup/setup-maintenance.ts", "../src/setup/setup-repair.ts", "../src/entries/setup.ts"],
  "sourcesContent": ["/**\n * TypeScript type definitions for Claude Code hooks\n * CC 2.1.9 compliant with additionalContext support\n */\n\n/**\n * Hook events supported by Claude Code\n */\nexport type HookEvent =\n  | 'PreToolUse'\n  | 'PostToolUse'\n  | 'PermissionRequest'\n  | 'UserPromptSubmit'\n  | 'SessionStart'\n  | 'SessionEnd'\n  | 'Stop'\n  | 'SubagentStart'\n  | 'SubagentStop'\n  | 'Setup'\n  | 'Notification';\n\n/**\n * Hook input envelope from Claude Code (sent via stdin as JSON)\n */\nexport interface HookInput {\n  /** The hook event type */\n  hook_event?: HookEvent;\n  /** The tool being invoked */\n  tool_name: string;\n  /** Session ID (CC 2.1.9 guarantees availability) */\n  session_id: string;\n  /** Tool-specific input parameters */\n  tool_input: ToolInput;\n  /** Tool output (PostToolUse only) */\n  tool_output?: unknown;\n  /** Tool error message if any */\n  tool_error?: string;\n  /** Tool exit code */\n  exit_code?: number;\n  /** User prompt (UserPromptSubmit only) */\n  prompt?: string;\n  /** Project directory */\n  project_dir?: string;\n\n  // SubagentStart/SubagentStop specific fields\n  /** Agent type for subagent hooks */\n  subagent_type?: string;\n  /** Agent type (alternative field name) */\n  agent_type?: string;\n  /** Agent ID */\n  agent_id?: string;\n  /** Agent output (SubagentStop) */\n  agent_output?: string;\n  /** Output (alternative field name) */\n  output?: string;\n  /** Error from subagent */\n  error?: string;\n  /** Duration in milliseconds */\n  duration_ms?: number;\n  /** Tool result (SubagentStop) */\n  tool_result?: string;\n\n  // Notification specific fields\n  /** Notification message */\n  message?: string;\n  /** Notification type */\n  notification_type?: string;\n}\n\n/**\n * Tool input types - union of all tool inputs\n */\nexport interface ToolInput {\n  /** Bash command (Bash tool) */\n  command?: string;\n  /** Timeout in ms (Bash tool) */\n  timeout?: number;\n  /** File path (Write/Edit/Read tools) */\n  file_path?: string;\n  /** File content (Write tool) */\n  content?: string;\n  /** Old text to replace (Edit tool) */\n  old_string?: string;\n  /** New text (Edit tool) */\n  new_string?: string;\n  /** Pattern (Glob/Grep tools) */\n  pattern?: string;\n  /** Allow additional properties */\n  [key: string]: unknown;\n}\n\n/**\n * Hook-specific output for CC 2.1.9\n */\nexport interface HookSpecificOutput {\n  /** Hook event name for context */\n  hookEventName?: 'PreToolUse' | 'PostToolUse' | 'PermissionRequest' | 'UserPromptSubmit';\n  /** Permission decision (PermissionRequest hooks) */\n  permissionDecision?: 'allow' | 'deny';\n  /** Reason for permission decision */\n  permissionDecisionReason?: string;\n  /** Additional context injected before tool execution (CC 2.1.9) */\n  additionalContext?: string;\n}\n\n/**\n * Hook result - output JSON to stdout\n * CC 2.1.7+ compliant\n */\nexport interface HookResult {\n  /** Whether to continue execution */\n  continue: boolean;\n  /** Suppress hook output from user */\n  suppressOutput?: boolean;\n  /** System message shown to user */\n  systemMessage?: string;\n  /** Reason for stopping (when continue is false) */\n  stopReason?: string;\n  /** Hook-specific output fields */\n  hookSpecificOutput?: HookSpecificOutput;\n}\n\n/**\n * Hook function signature\n */\nexport type HookFn = (input: HookInput) => Promise<HookResult> | HookResult;\n\n/**\n * Hook registration entry\n */\nexport interface HookRegistration {\n  /** Hook name (e.g., 'permission/auto-approve-readonly') */\n  name: string;\n  /** Hook event type */\n  event: HookEvent;\n  /** Tool matcher (string pattern or regex) */\n  matcher?: string | RegExp;\n  /** Hook implementation function */\n  fn: HookFn;\n}\n\n/**\n * Bash tool input (type guard helper)\n */\nexport interface BashToolInput extends ToolInput {\n  command: string;\n  timeout?: number;\n}\n\n/**\n * Write tool input (type guard helper)\n */\nexport interface WriteToolInput extends ToolInput {\n  file_path: string;\n  content: string;\n}\n\n/**\n * Edit tool input (type guard helper)\n */\nexport interface EditToolInput extends ToolInput {\n  file_path: string;\n  old_string: string;\n  new_string: string;\n}\n\n/**\n * Read tool input (type guard helper)\n */\nexport interface ReadToolInput extends ToolInput {\n  file_path: string;\n  offset?: number;\n  limit?: number;\n}\n\n/**\n * Type guards for tool inputs\n */\nexport function isBashInput(input: ToolInput): input is BashToolInput {\n  return typeof input.command === 'string';\n}\n\nexport function isWriteInput(input: ToolInput): input is WriteToolInput {\n  return typeof input.file_path === 'string' && typeof input.content === 'string';\n}\n\nexport function isEditInput(input: ToolInput): input is EditToolInput {\n  return (\n    typeof input.file_path === 'string' &&\n    typeof input.old_string === 'string' &&\n    typeof input.new_string === 'string'\n  );\n}\n\nexport function isReadInput(input: ToolInput): input is ReadToolInput {\n  return typeof input.file_path === 'string' && input.content === undefined;\n}\n", "/**\n * Common utilities for TypeScript hooks\n * Ported from hooks/_lib/common.sh\n */\n\nimport { appendFileSync, existsSync, statSync, renameSync, mkdirSync } from 'node:fs';\nimport type { HookResult, HookInput } from '../types.js';\n\n// -----------------------------------------------------------------------------\n// Environment and Paths\n// All functions read env vars dynamically to support testing\n// -----------------------------------------------------------------------------\n\n/**\n * Get the log directory path\n */\nexport function getLogDir(): string {\n  if (process.env.CLAUDE_PLUGIN_ROOT) {\n    return `${process.env.HOME}/.claude/logs/ork`;\n  }\n  return `${getProjectDir()}/.claude/logs`;\n}\n\n/**\n * Get the project directory\n * Read dynamically to support testing\n */\nexport function getProjectDir(): string {\n  return process.env.CLAUDE_PROJECT_DIR || '.';\n}\n\n/**\n * Get the plugin root directory\n * Read dynamically to support testing\n */\nexport function getPluginRoot(): string {\n  return process.env.CLAUDE_PLUGIN_ROOT || process.env.CLAUDE_PROJECT_DIR || '.';\n}\n\n/**\n * Get the session ID\n * CC 2.1.9+ should guarantee CLAUDE_SESSION_ID availability, but we add\n * a defensive fallback to prevent hook crashes during edge cases.\n * Read dynamically to support testing.\n */\nexport function getSessionId(): string {\n  return process.env.CLAUDE_SESSION_ID || `fallback-${process.pid}-${Date.now()}`;\n}\n\n// -----------------------------------------------------------------------------\n// Output Helpers (CC 2.1.7+ compliant)\n// -----------------------------------------------------------------------------\n\n/**\n * Output silent success - hook completed without errors, no user-visible output\n */\nexport function outputSilentSuccess(): HookResult {\n  return { continue: true, suppressOutput: true };\n}\n\n/**\n * Output silent allow - permission hook approves silently\n */\nexport function outputSilentAllow(): HookResult {\n  return {\n    continue: true,\n    suppressOutput: true,\n    hookSpecificOutput: { permissionDecision: 'allow' },\n  };\n}\n\n/**\n * Output block - stops the operation with an error\n */\nexport function outputBlock(reason: string): HookResult {\n  return {\n    continue: false,\n    stopReason: reason,\n    hookSpecificOutput: {\n      permissionDecision: 'deny',\n      permissionDecisionReason: reason,\n    },\n  };\n}\n\n/**\n * Output with additionalContext - injects context before tool execution (CC 2.1.9)\n * For PostToolUse hooks (hookEventName optional)\n */\nexport function outputWithContext(ctx: string): HookResult {\n  return {\n    continue: true,\n    suppressOutput: true,\n    hookSpecificOutput: {\n      hookEventName: 'PostToolUse',\n      additionalContext: ctx,\n    },\n  };\n}\n\n/**\n * Output with additionalContext for UserPromptSubmit hooks (CC 2.1.9)\n * hookEventName is REQUIRED for UserPromptSubmit\n */\nexport function outputPromptContext(ctx: string): HookResult {\n  return {\n    continue: true,\n    suppressOutput: true,\n    hookSpecificOutput: {\n      hookEventName: 'UserPromptSubmit',\n      additionalContext: ctx,\n    },\n  };\n}\n\n/**\n * Output allow with additionalContext - permission hook approves with context (CC 2.1.9)\n */\nexport function outputAllowWithContext(ctx: string, systemMessage?: string): HookResult {\n  const result: HookResult = {\n    continue: true,\n    hookSpecificOutput: {\n      hookEventName: 'PreToolUse',\n      additionalContext: ctx,\n      permissionDecision: 'allow',\n    },\n  };\n\n  if (systemMessage) {\n    result.systemMessage = systemMessage;\n  } else {\n    result.suppressOutput = true;\n  }\n\n  return result;\n}\n\n/**\n * Output error message - only use when there's an actual problem\n */\nexport function outputError(message: string): HookResult {\n  return { continue: true, systemMessage: message };\n}\n\n/**\n * Output warning message - CC 2.1.7 compliant (no ANSI in JSON)\n */\nexport function outputWarning(message: string): HookResult {\n  return { continue: true, systemMessage: `\\u26a0 ${message}` };\n}\n\n/**\n * Output deny with feedback logging (CC 2.1.7)\n */\nexport function outputDeny(reason: string): HookResult {\n  return {\n    continue: false,\n    stopReason: reason,\n    hookSpecificOutput: {\n      hookEventName: 'PreToolUse',\n      permissionDecision: 'deny',\n      permissionDecisionReason: reason,\n    },\n  };\n}\n\n// -----------------------------------------------------------------------------\n// Logging\n// -----------------------------------------------------------------------------\n\nconst LOG_ROTATION_MAX_SIZE = 200 * 1024; // 200KB\nconst PERMISSION_LOG_MAX_SIZE = 100 * 1024; // 100KB\n\n/**\n * Rotate log file if it exceeds size limit\n */\nfunction rotateLogFile(logFile: string, maxSize: number): void {\n  if (!existsSync(logFile)) return;\n\n  try {\n    const stats = statSync(logFile);\n    if (stats.size > maxSize) {\n      const rotated = `${logFile}.old.${Date.now()}`;\n      renameSync(logFile, rotated);\n    }\n  } catch {\n    // Ignore rotation errors\n  }\n}\n\n/**\n * Ensure directory exists\n */\nfunction ensureDir(dir: string): void {\n  if (!existsSync(dir)) {\n    mkdirSync(dir, { recursive: true });\n  }\n}\n\n/**\n * Log to hook log file with automatic rotation\n */\nexport function logHook(hookName: string, message: string): void {\n  const logDir = getLogDir();\n  const logFile = `${logDir}/hooks.log`;\n\n  try {\n    ensureDir(logDir);\n    rotateLogFile(logFile, LOG_ROTATION_MAX_SIZE);\n\n    const timestamp = new Date().toISOString().replace('T', ' ').slice(0, 19);\n    appendFileSync(logFile, `[${timestamp}] [${hookName}] ${message}\\n`);\n  } catch {\n    // Ignore logging errors - don't block hook execution\n  }\n}\n\n/**\n * Log permission decision for audit trail (CC 2.1.7 feature)\n */\nexport function logPermissionFeedback(\n  decision: 'allow' | 'deny' | 'warn',\n  reason: string,\n  input?: HookInput\n): void {\n  const logDir = getLogDir();\n  const logFile = `${logDir}/permission-feedback.log`;\n\n  try {\n    ensureDir(logDir);\n    rotateLogFile(logFile, PERMISSION_LOG_MAX_SIZE);\n\n    const timestamp = new Date().toISOString();\n    const toolName = input?.tool_name || process.env.HOOK_TOOL_NAME || 'unknown';\n    const sessionId = input?.session_id || getSessionId();\n\n    appendFileSync(\n      logFile,\n      `${timestamp} | ${decision} | ${reason} | tool=${toolName} | session=${sessionId}\\n`\n    );\n  } catch {\n    // Ignore logging errors\n  }\n}\n\n// -----------------------------------------------------------------------------\n// Input Helpers\n// -----------------------------------------------------------------------------\n\n/**\n * Read hook input from stdin synchronously\n * Returns parsed JSON or empty object on failure\n */\nexport function readHookInput(): HookInput {\n  try {\n    // Read from stdin synchronously\n    const chunks: Buffer[] = [];\n    const BUFSIZE = 256;\n    const buf = Buffer.allocUnsafe(BUFSIZE);\n\n    let bytesRead: number;\n    const fd = 0; // stdin\n\n    // Use fs.readSync for synchronous stdin reading\n    const { readSync } = require('node:fs');\n    while (true) {\n      try {\n        bytesRead = readSync(fd, buf, 0, BUFSIZE, null);\n        if (bytesRead === 0) break;\n        chunks.push(Buffer.from(buf.subarray(0, bytesRead)));\n      } catch {\n        break;\n      }\n    }\n\n    const input = Buffer.concat(chunks).toString('utf8').trim();\n    if (!input) {\n      return { tool_name: '', session_id: getSessionId(), tool_input: {} };\n    }\n\n    return JSON.parse(input);\n  } catch {\n    return { tool_name: '', session_id: getSessionId(), tool_input: {} };\n  }\n}\n\n/**\n * Get field from hook input using optional chaining\n */\nexport function getField<T>(input: HookInput, path: string): T | undefined {\n  const parts = path.replace(/^\\./, '').split('.');\n  let value: unknown = input;\n\n  for (const part of parts) {\n    if (value === null || value === undefined) return undefined;\n    value = (value as Record<string, unknown>)[part];\n  }\n\n  return value as T;\n}\n\n// -----------------------------------------------------------------------------\n// String Utilities\n// -----------------------------------------------------------------------------\n\n/**\n * Normalize command: remove line continuations and collapse whitespace\n * Prevents bypassing detection with backslash-newline tricks (CC 2.1.6 fix)\n */\nexport function normalizeCommand(command: string): string {\n  return command\n    .replace(/\\\\\\s*[\\r\\n]+/g, ' ') // Remove line continuations\n    .replace(/\\n/g, ' ') // Replace newlines with spaces\n    .replace(/\\s+/g, ' ') // Collapse whitespace\n    .trim();\n}\n\n/**\n * Escape string for use in regex\n */\nexport function escapeRegex(str: string): string {\n  return str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\n", "/**\n * First Run Setup - Full setup with optional interactive wizard\n * Hook: Setup (triggered by setup-check.sh)\n * CC 2.1.11 Compliant\n *\n * Phases:\n * 1. Environment detection\n * 2. Dependency validation\n * 3. Configuration selection\n * 4. Apply configuration\n * 5. Create marker file\n */\n\nimport { existsSync, mkdirSync, writeFileSync, readdirSync, chmodSync, statSync } from 'node:fs';\nimport { execSync } from 'node:child_process';\nimport type { HookInput, HookResult } from '../types.js';\nimport { logHook, getProjectDir, getPluginRoot, outputWithContext, outputSilentSuccess } from '../lib/common.js';\n\nconst CURRENT_VERSION = '4.25.0';\n\ninterface EnvironmentInfo {\n  python?: string;\n  nodejs?: string;\n  git?: boolean;\n  docker?: boolean;\n  sqlite3?: boolean;\n  os: string;\n}\n\ninterface PresetConfig {\n  preset: string;\n  description: string;\n  features: {\n    skills: boolean;\n    agents: boolean;\n    hooks: boolean;\n    mcp: boolean;\n    coordination: boolean;\n    statusline: boolean;\n  };\n  hook_groups: {\n    safety: boolean;\n    quality: boolean;\n    productivity: boolean;\n    observability: boolean;\n  };\n}\n\n/**\n * Detect environment\n */\nfunction detectEnvironment(): EnvironmentInfo {\n  logHook('first-run-setup', 'Phase 1: Detecting environment');\n\n  const envInfo: EnvironmentInfo = {\n    os: process.platform,\n  };\n\n  // Detect Python version\n  try {\n    const result = execSync('python3 --version', { encoding: 'utf8', stdio: ['pipe', 'pipe', 'pipe'] });\n    const match = result.match(/(\\d+\\.\\d+)/);\n    if (match) {\n      envInfo.python = match[1];\n      logHook('first-run-setup', `Python: ${match[1]}`);\n    }\n  } catch {\n    // Python not available\n  }\n\n  // Detect Node.js version\n  try {\n    const result = execSync('node --version', { encoding: 'utf8', stdio: ['pipe', 'pipe', 'pipe'] });\n    const match = result.match(/(\\d+\\.\\d+)/);\n    if (match) {\n      envInfo.nodejs = match[1];\n      logHook('first-run-setup', `Node.js: ${match[1]}`);\n    }\n  } catch {\n    // Node.js not available\n  }\n\n  // Detect Git\n  try {\n    execSync('which git', { encoding: 'utf8', stdio: ['pipe', 'pipe', 'pipe'] });\n    envInfo.git = true;\n    logHook('first-run-setup', 'Git: available');\n  } catch {\n    // Git not available\n  }\n\n  // Detect Docker\n  try {\n    execSync('which docker', { encoding: 'utf8', stdio: ['pipe', 'pipe', 'pipe'] });\n    envInfo.docker = true;\n    logHook('first-run-setup', 'Docker: available');\n  } catch {\n    // Docker not available\n  }\n\n  // Detect SQLite3\n  try {\n    execSync('which sqlite3', { encoding: 'utf8', stdio: ['pipe', 'pipe', 'pipe'] });\n    envInfo.sqlite3 = true;\n    logHook('first-run-setup', 'SQLite3: available (multi-instance coordination enabled)');\n  } catch {\n    // SQLite3 not available\n  }\n\n  return envInfo;\n}\n\n/**\n * Validate dependencies\n */\nfunction validateDependencies(): { valid: boolean; missing: string[]; warnings: string[] } {\n  logHook('first-run-setup', 'Phase 2: Validating dependencies');\n\n  const missing: string[] = [];\n  const warnings: string[] = [];\n\n  // Required: jq\n  try {\n    execSync('which jq', { encoding: 'utf8', stdio: ['pipe', 'pipe', 'pipe'] });\n  } catch {\n    missing.push('jq (required for JSON processing)');\n  }\n\n  // Optional: sqlite3\n  try {\n    execSync('which sqlite3', { encoding: 'utf8', stdio: ['pipe', 'pipe', 'pipe'] });\n  } catch {\n    warnings.push('sqlite3 not found - multi-instance coordination disabled');\n  }\n\n  // Optional: anthropic SDK\n  try {\n    execSync('python3 -c \"import anthropic\"', { encoding: 'utf8', stdio: ['pipe', 'pipe', 'pipe'] });\n    logHook('first-run-setup', 'Anthropic SDK: available (Memory Fabric Agent enabled)');\n  } catch {\n    warnings.push('anthropic SDK not found - Memory Fabric Agent will use fallback mode');\n    warnings.push(\"  Install with: pip install 'orchestkit[memory]'\");\n  }\n\n  // Report\n  if (missing.length > 0) {\n    logHook('first-run-setup', 'ERROR: Missing required dependencies:');\n    for (const dep of missing) {\n      logHook('first-run-setup', `  - ${dep}`);\n    }\n  }\n\n  for (const warn of warnings) {\n    logHook('first-run-setup', `WARN: ${warn}`);\n  }\n\n  return { valid: missing.length === 0, missing, warnings };\n}\n\n/**\n * Get preset configuration\n */\nfunction getPresetConfig(preset: string): PresetConfig {\n  const configs: Record<string, PresetConfig> = {\n    complete: {\n      preset: 'complete',\n      description: 'Full AI-assisted development toolkit',\n      features: {\n        skills: true,\n        agents: true,\n        hooks: true,\n        mcp: true,\n        coordination: true,\n        statusline: true,\n      },\n      hook_groups: {\n        safety: true,\n        quality: true,\n        productivity: true,\n        observability: true,\n      },\n    },\n    standard: {\n      preset: 'standard',\n      description: 'Skills and hooks without agent orchestration',\n      features: {\n        skills: true,\n        agents: false,\n        hooks: true,\n        mcp: true,\n        coordination: true,\n        statusline: true,\n      },\n      hook_groups: {\n        safety: true,\n        quality: true,\n        productivity: true,\n        observability: true,\n      },\n    },\n    lite: {\n      preset: 'lite',\n      description: 'Essential skills for constrained environments',\n      features: {\n        skills: true,\n        agents: false,\n        hooks: true,\n        mcp: false,\n        coordination: false,\n        statusline: false,\n      },\n      hook_groups: {\n        safety: true,\n        quality: true,\n        productivity: false,\n        observability: false,\n      },\n    },\n    'hooks-only': {\n      preset: 'hooks-only',\n      description: 'Safety hooks only for pure automation',\n      features: {\n        skills: false,\n        agents: false,\n        hooks: true,\n        mcp: false,\n        coordination: false,\n        statusline: false,\n      },\n      hook_groups: {\n        safety: true,\n        quality: false,\n        productivity: false,\n        observability: false,\n      },\n    },\n  };\n\n  return configs[preset] || configs.complete;\n}\n\n/**\n * Apply configuration\n */\nfunction applyConfiguration(preset: string, envInfo: EnvironmentInfo, pluginRoot: string): PresetConfig {\n  logHook('first-run-setup', `Phase 4: Applying configuration (preset: ${preset})`);\n\n  const config = getPresetConfig(preset);\n\n  // Ensure directories exist\n  const dirs = [\n    `${pluginRoot}/.claude/defaults`,\n    `${pluginRoot}/.claude/context/session`,\n    `${pluginRoot}/.claude/context/knowledge`,\n    `${pluginRoot}/.claude/logs`,\n  ];\n\n  for (const dir of dirs) {\n    try {\n      mkdirSync(dir, { recursive: true });\n    } catch {\n      // Ignore\n    }\n  }\n\n  // Write config if it doesn't exist\n  const configFile = `${pluginRoot}/.claude/defaults/config.json`;\n  if (!existsSync(configFile)) {\n    writeFileSync(configFile, JSON.stringify(config, null, 2));\n    logHook('first-run-setup', `Created config file: ${configFile}`);\n  }\n\n  // Make all hooks executable\n  try {\n    const hooksDir = `${pluginRoot}/hooks`;\n    if (existsSync(hooksDir)) {\n      const makeExecutable = (dir: string) => {\n        try {\n          const entries = readdirSync(dir, { withFileTypes: true });\n          for (const entry of entries) {\n            const fullPath = `${dir}/${entry.name}`;\n            if (entry.isDirectory()) {\n              makeExecutable(fullPath);\n            } else if (entry.name.endsWith('.sh')) {\n              try {\n                chmodSync(fullPath, 0o755);\n              } catch {\n                // Ignore chmod errors\n              }\n            }\n          }\n        } catch {\n          // Ignore directory errors\n        }\n      };\n      makeExecutable(hooksDir);\n      logHook('first-run-setup', 'Made hooks executable');\n    }\n  } catch {\n    // Ignore\n  }\n\n  return config;\n}\n\n/**\n * Create marker file\n */\nfunction createMarker(preset: string, envInfo: EnvironmentInfo, pluginRoot: string): void {\n  logHook('first-run-setup', 'Phase 5: Creating marker file');\n\n  const now = new Date().toISOString();\n\n  // Count components\n  let hookCount = 0;\n  let skillCount = 0;\n  let agentCount = 0;\n\n  try {\n    const countFiles = (dir: string, pattern: RegExp): number => {\n      let count = 0;\n      const walk = (d: string) => {\n        try {\n          const entries = readdirSync(d, { withFileTypes: true });\n          for (const entry of entries) {\n            const fullPath = `${d}/${entry.name}`;\n            if (entry.isDirectory()) {\n              walk(fullPath);\n            } else if (pattern.test(entry.name)) {\n              count++;\n            }\n          }\n        } catch {\n          // Ignore\n        }\n      };\n      walk(dir);\n      return count;\n    };\n\n    hookCount = countFiles(`${pluginRoot}/hooks`, /\\.sh$/);\n    skillCount = countFiles(`${pluginRoot}/skills`, /SKILL\\.md$/);\n    agentCount = countFiles(`${pluginRoot}/agents`, /\\.md$/);\n  } catch {\n    // Ignore count errors\n  }\n\n  const marker = {\n    version: CURRENT_VERSION,\n    setup_date: now,\n    preset,\n    components: {\n      hooks: { count: hookCount, valid: true },\n      skills: { count: skillCount, valid: true },\n      agents: { count: agentCount, valid: true },\n    },\n    last_health_check: now,\n    last_maintenance: now,\n    environment: envInfo,\n    user_preferences: {\n      onboarding_completed: true,\n      mcp_configured: false,\n      statusline_configured: false,\n    },\n  };\n\n  const markerFile = `${pluginRoot}/.setup-complete`;\n  writeFileSync(markerFile, JSON.stringify(marker, null, 2));\n  logHook('first-run-setup', `Marker file created: ${markerFile}`);\n}\n\n/**\n * First run setup hook\n */\nexport function firstRunSetup(input: HookInput): HookResult {\n  const pluginRoot = getPluginRoot();\n  const mode = process.argv.includes('--silent') ? 'silent' : 'interactive';\n\n  logHook('first-run-setup', `First-run setup starting (mode: ${mode})`);\n\n  // Phase 1: Environment detection\n  const envInfo = detectEnvironment();\n\n  // Phase 2: Dependency validation\n  const { valid, missing } = validateDependencies();\n  if (!valid) {\n    logHook('first-run-setup', 'ERROR: Dependency validation failed');\n    const ctx = `OrchestKit setup failed: Missing required dependencies. Install ${missing.join(', ')}.`;\n    return outputWithContext(ctx);\n  }\n\n  // Phase 3: Select preset (default to complete)\n  const preset = 'complete';\n  if (mode === 'interactive') {\n    logHook('first-run-setup', 'Interactive mode - using complete preset (wizard via Claude conversation)');\n  } else {\n    logHook('first-run-setup', 'Silent mode - using complete preset');\n  }\n\n  // Phase 4: Apply configuration\n  applyConfiguration(preset, envInfo, pluginRoot);\n\n  // Phase 5: Create marker\n  createMarker(preset, envInfo, pluginRoot);\n\n  // Count components for success message\n  let hookCount = 0;\n  let skillCount = 0;\n  let agentCount = 0;\n  try {\n    const countFiles = (dir: string, pattern: RegExp): number => {\n      let count = 0;\n      const walk = (d: string) => {\n        try {\n          const entries = readdirSync(d, { withFileTypes: true });\n          for (const entry of entries) {\n            const fullPath = `${d}/${entry.name}`;\n            if (entry.isDirectory()) {\n              walk(fullPath);\n            } else if (pattern.test(entry.name)) {\n              count++;\n            }\n          }\n        } catch {\n          // Ignore\n        }\n      };\n      walk(dir);\n      return count;\n    };\n\n    hookCount = countFiles(`${pluginRoot}/hooks`, /\\.sh$/);\n    skillCount = countFiles(`${pluginRoot}/skills`, /SKILL\\.md$/);\n    agentCount = countFiles(`${pluginRoot}/agents`, /\\.md$/);\n  } catch {\n    // Ignore count errors\n  }\n\n  logHook('first-run-setup', `Setup complete: ${skillCount} skills, ${agentCount} agents, ${hookCount} hooks`);\n\n  const ctx =\n    mode === 'interactive'\n      ? `OrchestKit v${CURRENT_VERSION} setup complete! Loaded ${skillCount} skills, ${agentCount} agents, and ${hookCount} hooks. Use /ork:configure to customize settings.`\n      : `OrchestKit v${CURRENT_VERSION} initialized (silent mode).`;\n\n  return outputWithContext(ctx);\n}\n", "/**\n * Mem0 Analytics Dashboard - Generate weekly/monthly reports\n * Hook: Setup (maintenance)\n * CC 2.1.7 Compliant\n *\n * Features:\n * - Generates weekly/monthly usage reports\n * - Tracks memory growth trends\n * - Analyzes search patterns\n * - Identifies optimization opportunities\n */\n\nimport { existsSync, mkdirSync, writeFileSync } from 'node:fs';\nimport { execSync } from 'node:child_process';\nimport type { HookInput, HookResult } from '../types.js';\nimport { logHook, getProjectDir, getPluginRoot, outputSilentSuccess } from '../lib/common.js';\n\n/**\n * Check if mem0 is available\n */\nfunction isMem0Available(): boolean {\n  return !!process.env.MEM0_API_KEY;\n}\n\n/**\n * Mem0 analytics dashboard hook\n */\nexport function mem0AnalyticsDashboard(input: HookInput): HookResult {\n  logHook('mem0-analytics', 'Mem0 analytics dashboard starting');\n\n  // Check if mem0 is available\n  if (!isMem0Available()) {\n    logHook('mem0-analytics', 'Mem0 not available, skipping analytics dashboard');\n    return outputSilentSuccess();\n  }\n\n  const projectDir = input.project_dir || getProjectDir();\n  const pluginRoot = getPluginRoot();\n  const analyticsFile = `${projectDir}/.claude/logs/mem0-analytics.jsonl`;\n  const dashboardFile = `${projectDir}/.claude/logs/mem0-dashboard.json`;\n  const summaryScript = `${pluginRoot}/skills/mem0-memory/scripts/memory-summary.py`;\n\n  // Generate dashboard data\n  let summaryOutput = '{}';\n  if (existsSync(summaryScript)) {\n    try {\n      summaryOutput = execSync(`python3 \"${summaryScript}\"`, {\n        encoding: 'utf8',\n        timeout: 30000,\n        stdio: ['pipe', 'pipe', 'pipe'],\n      });\n    } catch {\n      logHook('mem0-analytics', 'Failed to run summary script');\n    }\n  } else {\n    logHook('mem0-analytics', 'Summary script not found, skipping dashboard');\n    return outputSilentSuccess();\n  }\n\n  let summary: unknown;\n  try {\n    summary = JSON.parse(summaryOutput);\n  } catch {\n    summary = {};\n  }\n\n  const timestamp = new Date().toISOString();\n  const dashboardData = {\n    timestamp,\n    summary,\n    trends: {\n      memory_growth: 'tracked',\n      search_frequency: 'tracked',\n      graph_utilization: 'tracked',\n    },\n  };\n\n  // Save dashboard\n  try {\n    mkdirSync(`${projectDir}/.claude/logs`, { recursive: true });\n    writeFileSync(dashboardFile, JSON.stringify(dashboardData, null, 2));\n    logHook('mem0-analytics', 'Mem0 analytics dashboard generated');\n  } catch (error) {\n    logHook('mem0-analytics', `Failed to save dashboard: ${error}`);\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Mem0 Backup Setup Hook - Configure scheduled exports\n * Hook: Setup (maintenance)\n * CC 2.1.7 Compliant\n *\n * Features:\n * - Configures scheduled exports\n * - Sets up backup workflow\n * - Defines backup retention policy\n */\n\nimport { existsSync, mkdirSync, writeFileSync } from 'node:fs';\nimport type { HookInput, HookResult } from '../types.js';\nimport { logHook, getProjectDir, getPluginRoot, outputSilentSuccess } from '../lib/common.js';\n\n/**\n * Check if mem0 is available\n */\nfunction isMem0Available(): boolean {\n  return !!process.env.MEM0_API_KEY;\n}\n\n/**\n * Mem0 backup setup hook\n */\nexport function mem0BackupSetup(input: HookInput): HookResult {\n  logHook('mem0-backup', 'Mem0 backup setup starting');\n\n  // Check if mem0 is available\n  if (!isMem0Available()) {\n    logHook('mem0-backup', 'Mem0 not available, skipping backup setup');\n    return outputSilentSuccess();\n  }\n\n  const projectDir = input.project_dir || getProjectDir();\n  const backupConfig = `${projectDir}/.claude/mem0-backup-config.json`;\n\n  // Backup configuration from environment\n  const backupSchedule = process.env.MEM0_BACKUP_SCHEDULE || 'weekly';\n  const backupRetention = parseInt(process.env.MEM0_BACKUP_RETENTION || '30', 10);\n\n  // Create backup config\n  try {\n    mkdirSync(`${projectDir}/.claude`, { recursive: true });\n\n    const config = {\n      schedule: backupSchedule,\n      retention_days: backupRetention,\n      enabled: true,\n    };\n\n    writeFileSync(backupConfig, JSON.stringify(config, null, 2));\n    logHook('mem0-backup', `Mem0 backup configured: schedule=${backupSchedule}, retention=${backupRetention} days`);\n  } catch (error) {\n    logHook('mem0-backup', `Failed to create backup config: ${error}`);\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Mem0 Cleanup Hook - Bulk cleanup of old memories\n * Hook: Setup (maintenance)\n * CC 2.1.7 Compliant\n *\n * Features:\n * - Uses batch-delete.py for efficient bulk cleanup\n * - Removes stale memories based on age criteria\n * - Queries memories via get-memories.py and filters by age\n */\n\nimport { existsSync, mkdirSync, appendFileSync } from 'node:fs';\nimport { execSync, spawn } from 'node:child_process';\nimport type { HookInput, HookResult } from '../types.js';\nimport { logHook, getProjectDir, getPluginRoot, outputSilentSuccess } from '../lib/common.js';\n\n/**\n * Check if mem0 is available\n */\nfunction isMem0Available(): boolean {\n  return !!process.env.MEM0_API_KEY;\n}\n\n/**\n * Calculate cutoff date (N days ago)\n */\nfunction getCutoffDate(daysAgo: number): string {\n  const date = new Date();\n  date.setDate(date.getDate() - daysAgo);\n  return date.toISOString().split('T')[0];\n}\n\n/**\n * Mem0 cleanup hook\n */\nexport function mem0Cleanup(input: HookInput): HookResult {\n  logHook('mem0-cleanup', 'Mem0 cleanup starting');\n\n  // Check if mem0 is available\n  if (!isMem0Available()) {\n    logHook('mem0-cleanup', 'Mem0 not available, skipping cleanup');\n    return outputSilentSuccess();\n  }\n\n  const projectDir = input.project_dir || getProjectDir();\n  const pluginRoot = getPluginRoot();\n  const scriptsDir = `${pluginRoot}/skills/mem0-memory/scripts`;\n  const batchDeleteScript = `${scriptsDir}/batch/batch-delete.py`;\n  const getMemoriesScript = `${scriptsDir}/crud/get-memories.py`;\n\n  // Check if required scripts exist\n  if (!existsSync(batchDeleteScript)) {\n    logHook('mem0-cleanup', `Batch delete script not found at ${batchDeleteScript}, skipping cleanup`);\n    return outputSilentSuccess();\n  }\n\n  if (!existsSync(getMemoriesScript)) {\n    logHook('mem0-cleanup', `Get memories script not found at ${getMemoriesScript}, skipping cleanup`);\n    return outputSilentSuccess();\n  }\n\n  // Age threshold from environment\n  const ageThreshold = parseInt(process.env.MEM0_CLEANUP_AGE_DAYS || '90', 10);\n  const cutoffDate = getCutoffDate(ageThreshold);\n\n  const logFile = `${projectDir}/.claude/logs/mem0-cleanup.log`;\n  try {\n    mkdirSync(`${projectDir}/.claude/logs`, { recursive: true });\n  } catch {\n    // Ignore\n  }\n\n  logHook('mem0-cleanup', `Querying memories older than ${cutoffDate} (${ageThreshold} days)`);\n\n  const timestamp = new Date().toISOString();\n  try {\n    appendFileSync(logFile, `[${timestamp}] Cleanup started - threshold: ${cutoffDate}\\n`);\n  } catch {\n    // Ignore\n  }\n\n  // Get all memories\n  let memoriesJson: { memories: Array<{ id: string; created_at: string; metadata?: { protected?: boolean } }> };\n  try {\n    const result = execSync(`python3 \"${getMemoriesScript}\"`, {\n      encoding: 'utf8',\n      timeout: 60000,\n      stdio: ['pipe', 'pipe', 'pipe'],\n    });\n    memoriesJson = JSON.parse(result);\n  } catch {\n    logHook('mem0-cleanup', 'Failed to get memories');\n    try {\n      appendFileSync(logFile, `[${timestamp}] Failed to get memories\\n`);\n    } catch {\n      // Ignore\n    }\n    return outputSilentSuccess();\n  }\n\n  // Filter stale memories (older than cutoff, not protected)\n  const memories = memoriesJson.memories || [];\n  const staleIds = memories\n    .filter((m) => {\n      const createdAt = m.created_at?.split('T')[0] || '';\n      const isOld = createdAt < cutoffDate;\n      const isProtected = m.metadata?.protected === true;\n      return isOld && !isProtected;\n    })\n    .map((m) => m.id)\n    .slice(0, 100); // Limit to 100 per run\n\n  if (staleIds.length === 0) {\n    logHook('mem0-cleanup', `No stale memories found older than ${cutoffDate}`);\n    try {\n      appendFileSync(logFile, `[${timestamp}] No stale memories found\\n`);\n    } catch {\n      // Ignore\n    }\n    return outputSilentSuccess();\n  }\n\n  logHook('mem0-cleanup', `Found ${staleIds.length} stale memories to delete`);\n  try {\n    appendFileSync(logFile, `[${timestamp}] Found ${staleIds.length} stale memories\\n`);\n  } catch {\n    // Ignore\n  }\n\n  // Execute batch delete\n  try {\n    const idsArray = JSON.stringify(staleIds);\n    execSync(`python3 \"${batchDeleteScript}\" --memory-ids '${idsArray}'`, {\n      encoding: 'utf8',\n      timeout: 120000,\n      stdio: ['pipe', 'pipe', 'pipe'],\n    });\n\n    logHook('mem0-cleanup', `Successfully deleted ${staleIds.length} stale memories`);\n    try {\n      appendFileSync(logFile, `[${timestamp}] Deleted ${staleIds.length} memories successfully\\n`);\n    } catch {\n      // Ignore\n    }\n  } catch (error) {\n    logHook('mem0-cleanup', `Batch delete failed: ${error}`);\n    try {\n      appendFileSync(logFile, `[${timestamp}] Delete failed: ${error}\\n`);\n    } catch {\n      // Ignore\n    }\n  }\n\n  logHook('mem0-cleanup', `Mem0 cleanup complete (age threshold: ${ageThreshold} days)`);\n  return outputSilentSuccess();\n}\n", "/**\n * Setup Check - Entry point for CC 2.1.11 Setup hooks\n * Hook: Setup (triggered by --init, --init-only, --maintenance)\n * Also runs on SessionStart for fast validation\n *\n * This hook implements the hybrid marker file + validation approach:\n * 1. Check marker file for fast path (< 10ms when setup complete)\n * 2. Quick validation for self-healing (< 50ms)\n * 3. Triggers appropriate sub-hook based on state\n */\n\nimport { existsSync, readFileSync, readdirSync, writeFileSync } from 'node:fs';\nimport { spawn } from 'node:child_process';\nimport type { HookInput, HookResult } from '../types.js';\nimport { logHook, getPluginRoot, outputSilentSuccess, outputWithContext } from '../lib/common.js';\n\nconst CURRENT_VERSION = '4.25.0';\n\n/**\n * Get marker field from marker file\n */\nfunction getMarkerField(markerFile: string, field: string): unknown {\n  if (!existsSync(markerFile)) {\n    return null;\n  }\n\n  try {\n    const content = JSON.parse(readFileSync(markerFile, 'utf-8'));\n    // Simple dot notation parsing\n    const parts = field.split('.');\n    let value: unknown = content;\n    for (const part of parts) {\n      if (value === null || value === undefined) return null;\n      value = (value as Record<string, unknown>)[part];\n    }\n    return value;\n  } catch {\n    return null;\n  }\n}\n\n/**\n * Quick validation - checks critical components exist (< 50ms target)\n */\nfunction quickValidate(pluginRoot: string): number {\n  let errors = 0;\n\n  // Check 1: Config file exists and is valid JSON\n  const configFile = `${pluginRoot}/.claude/defaults/config.json`;\n  if (existsSync(configFile)) {\n    try {\n      JSON.parse(readFileSync(configFile, 'utf-8'));\n    } catch {\n      logHook('setup-check', 'WARN: config.json is invalid JSON');\n      errors++;\n    }\n  }\n\n  // Check 2: At least some hooks exist (simplified count)\n  let hookCount = 0;\n  if (existsSync(`${pluginRoot}/hooks`)) {\n    try {\n      const countShFiles = (dir: string, depth = 0): number => {\n        if (depth > 3) return 0; // Limit depth\n        let count = 0;\n        try {\n          const entries = readdirSync(dir, { withFileTypes: true });\n          for (const entry of entries.slice(0, 100)) {\n            // Limit entries\n            const fullPath = `${dir}/${entry.name}`;\n            if (entry.isDirectory() && !entry.name.startsWith('.')) {\n              count += countShFiles(fullPath, depth + 1);\n            } else if (entry.name.endsWith('.sh')) {\n              count++;\n            }\n          }\n        } catch {\n          // Ignore\n        }\n        return count;\n      };\n      hookCount = countShFiles(`${pluginRoot}/hooks`);\n    } catch {\n      // Ignore\n    }\n  }\n\n  if (hookCount < 10) {\n    logHook('setup-check', `WARN: Only ${hookCount} hooks found (expected 50+)`);\n    // Don't increment errors - just warn\n  }\n\n  // Check 3: Version matches\n  const markerFile = `${pluginRoot}/.setup-complete`;\n  const markerVersion = getMarkerField(markerFile, 'version') as string | null;\n  if (markerVersion && markerVersion !== CURRENT_VERSION) {\n    logHook('setup-check', `INFO: Version mismatch - marker: ${markerVersion}, current: ${CURRENT_VERSION}`);\n    return 2; // Trigger migration\n  }\n\n  return errors;\n}\n\n/**\n * Check if maintenance is due\n */\nfunction isMaintenanceDue(markerFile: string): boolean {\n  const lastMaintenance = getMarkerField(markerFile, 'last_maintenance') as string | null;\n  if (!lastMaintenance) {\n    return true;\n  }\n\n  try {\n    const lastEpoch = new Date(lastMaintenance).getTime();\n    const nowEpoch = Date.now();\n    const hoursSince = (nowEpoch - lastEpoch) / (1000 * 60 * 60);\n    return hoursSince >= 24;\n  } catch {\n    return true;\n  }\n}\n\n/**\n * Update marker field\n */\nfunction updateMarker(markerFile: string, field: string, value: unknown): void {\n  if (!existsSync(markerFile)) {\n    return;\n  }\n\n  try {\n    const content = JSON.parse(readFileSync(markerFile, 'utf-8'));\n    content[field] = value;\n    writeFileSync(markerFile, JSON.stringify(content, null, 2));\n  } catch {\n    // Ignore\n  }\n}\n\n/**\n * Setup check hook\n */\nexport function setupCheck(input: HookInput): HookResult {\n  // Check bypass flags\n  if (process.env.ORCHESTKIT_SKIP_SETUP === '1' || process.env.ORCHESTKIT_SKIP_SLOW_HOOKS === '1') {\n    return outputSilentSuccess();\n  }\n\n  const pluginRoot = getPluginRoot();\n  const markerFile = `${pluginRoot}/.setup-complete`;\n  const setupDir = `${pluginRoot}/hooks/setup`;\n\n  logHook('setup-check', `Setup check starting (v${CURRENT_VERSION})`);\n\n  // Check trigger mode from argv\n  const args = process.argv;\n  if (args.includes('--init') || args.includes('init')) {\n    logHook('setup-check', 'Explicit --init: Running full setup');\n    // In TS we can't exec, but the bash wrapper will handle this\n    return {\n      continue: true,\n      systemMessage: 'Running first-run setup...',\n    };\n  }\n\n  if (args.includes('--init-only') || args.includes('init-only')) {\n    logHook('setup-check', 'CI/CD mode (--init-only): Running silent setup');\n    return {\n      continue: true,\n      systemMessage: 'Running silent setup...',\n    };\n  }\n\n  if (args.includes('--maintenance') || args.includes('maintenance')) {\n    logHook('setup-check', 'Explicit --maintenance: Running maintenance tasks');\n    return {\n      continue: true,\n      systemMessage: 'Running maintenance tasks...',\n    };\n  }\n\n  // Auto mode: Check marker file first (fast path)\n  if (!existsSync(markerFile)) {\n    logHook('setup-check', 'No marker file found - first run detected');\n\n    const hookEvent = input.hook_event || process.env.HOOK_EVENT;\n    if (hookEvent === 'Setup') {\n      return {\n        continue: true,\n        systemMessage: 'First run detected. Running setup...',\n      };\n    } else {\n      // SessionStart - inform user but don't block\n      const ctx = \"OrchestKit setup not complete. Run 'claude --init' to configure the plugin.\";\n      return outputWithContext(ctx);\n    }\n  }\n\n  // Marker exists - run quick validation\n  logHook('setup-check', 'Marker file exists - running quick validation');\n\n  const validationResult = quickValidate(pluginRoot);\n\n  switch (validationResult) {\n    case 0:\n      // All checks passed - check if maintenance is due\n      if (isMaintenanceDue(markerFile)) {\n        logHook('setup-check', 'Maintenance due - queueing background tasks');\n        // Run maintenance in background (spawn detached)\n        const maintenanceScript = `${setupDir}/setup-maintenance.sh`;\n        if (existsSync(maintenanceScript)) {\n          const child = spawn(maintenanceScript, ['--background'], {\n            detached: true,\n            stdio: 'ignore',\n          });\n          child.unref();\n        }\n      }\n\n      logHook('setup-check', 'Setup check passed (fast path)');\n      return outputSilentSuccess();\n\n    case 1:\n      // Validation failed - trigger repair in background\n      logHook('setup-check', 'Validation failed - triggering self-healing repair');\n      const repairScript = `${setupDir}/setup-repair.sh`;\n      if (existsSync(repairScript)) {\n        const child = spawn(repairScript, [], {\n          detached: true,\n          stdio: 'ignore',\n        });\n        child.unref();\n      }\n      return outputWithContext('OrchestKit setup validation failed. Repair running in background.');\n\n    case 2:\n      // Version mismatch - run migration in background\n      logHook('setup-check', 'Version mismatch - running migration');\n      const maintenanceScript = `${setupDir}/setup-maintenance.sh`;\n      if (existsSync(maintenanceScript)) {\n        const child = spawn(maintenanceScript, ['--migrate'], {\n          detached: true,\n          stdio: 'ignore',\n        });\n        child.unref();\n      }\n\n      updateMarker(markerFile, 'version', CURRENT_VERSION);\n      return outputWithContext(`OrchestKit upgraded to v${CURRENT_VERSION}.`);\n\n    default:\n      return outputSilentSuccess();\n  }\n}\n", "/**\n * Setup Maintenance - Periodic maintenance tasks\n * Hook: Setup (triggered by setup-check.sh or --maintenance flag)\n * CC 2.1.11 Compliant\n *\n * Tasks:\n * - Log rotation (daily)\n * - Stale lock cleanup (daily)\n * - Session archive (daily)\n * - Memory Fabric cleanup (daily)\n * - Metrics aggregation (weekly)\n * - Full health validation (weekly)\n * - Version migrations (on version change)\n */\n\nimport {\n  existsSync,\n  mkdirSync,\n  readFileSync,\n  writeFileSync,\n  renameSync,\n  readdirSync,\n  unlinkSync,\n  statSync,\n  chmodSync,\n} from 'node:fs';\nimport { execSync } from 'node:child_process';\nimport type { HookInput, HookResult } from '../types.js';\nimport { logHook, getPluginRoot, getProjectDir, outputSilentSuccess, outputWithContext } from '../lib/common.js';\n\nconst CURRENT_VERSION = '4.25.0';\n\nconst tasksCompleted: string[] = [];\n\n/**\n * Get marker field\n */\nfunction getMarkerField(markerFile: string, field: string): unknown {\n  if (!existsSync(markerFile)) {\n    return null;\n  }\n\n  try {\n    const content = JSON.parse(readFileSync(markerFile, 'utf-8'));\n    return content[field.replace(/^\\./, '')];\n  } catch {\n    return null;\n  }\n}\n\n/**\n * Update marker field\n */\nfunction updateMarkerField(markerFile: string, field: string, value: unknown): void {\n  if (!existsSync(markerFile)) {\n    return;\n  }\n\n  try {\n    const content = JSON.parse(readFileSync(markerFile, 'utf-8'));\n    content[field.replace(/^\\./, '')] = value;\n    writeFileSync(markerFile, JSON.stringify(content, null, 2));\n  } catch {\n    // Ignore\n  }\n}\n\n/**\n * Calculate hours since timestamp\n */\nfunction hoursSince(timestamp: string | null): number {\n  if (!timestamp) {\n    return 999;\n  }\n\n  try {\n    const lastEpoch = new Date(timestamp).getTime();\n    const nowEpoch = Date.now();\n    return (nowEpoch - lastEpoch) / (1000 * 60 * 60);\n  } catch {\n    return 999;\n  }\n}\n\n/**\n * Task: Log rotation\n */\nfunction taskLogRotation(pluginRoot: string): void {\n  logHook('setup-maintenance', 'Task: Log rotation');\n\n  const logDirs = [`${pluginRoot}/.claude/logs`, `${process.env.HOME}/.claude/logs/ork`];\n\n  let rotated = 0;\n\n  for (const logDir of logDirs) {\n    if (!existsSync(logDir)) {\n      continue;\n    }\n\n    try {\n      const files = readdirSync(logDir);\n      for (const file of files) {\n        if (!file.endsWith('.log')) continue;\n\n        const filePath = `${logDir}/${file}`;\n        try {\n          const stats = statSync(filePath);\n          if (stats.size > 204800) {\n            // 200KB\n            const rotatedName = `${filePath}.old.${Date.now()}`;\n            renameSync(filePath, rotatedName);\n            rotated++;\n\n            // Try to gzip\n            try {\n              execSync(`gzip \"${rotatedName}\"`, { stdio: ['pipe', 'pipe', 'pipe'] });\n            } catch {\n              // gzip not available\n            }\n          }\n        } catch {\n          // Ignore file errors\n        }\n      }\n\n      // Clean up old rotated logs (keep last 5)\n      const rotatedLogs = files.filter((f) => f.includes('.log.old.')).sort().reverse();\n      for (const oldLog of rotatedLogs.slice(5)) {\n        try {\n          unlinkSync(`${logDir}/${oldLog}`);\n        } catch {\n          // Ignore\n        }\n      }\n    } catch {\n      // Ignore directory errors\n    }\n  }\n\n  if (rotated > 0) {\n    tasksCompleted.push(`Rotated ${rotated} log files`);\n  }\n}\n\n/**\n * Task: Stale lock cleanup\n */\nfunction taskStaleLockCleanup(pluginRoot: string): void {\n  logHook('setup-maintenance', 'Task: Stale lock cleanup');\n\n  const coordDb = `${pluginRoot}/.claude/coordination/.claude.db`;\n  let cleaned = 0;\n\n  if (existsSync(coordDb)) {\n    try {\n      execSync(`sqlite3 \"${coordDb}\" \"DELETE FROM file_locks WHERE datetime(acquired_at) < datetime('now', '-24 hours');\"`, {\n        timeout: 5000,\n        stdio: ['pipe', 'pipe', 'pipe'],\n      });\n\n      const lockCount = execSync(`sqlite3 \"${coordDb}\" \"SELECT COUNT(*) FROM file_locks;\"`, {\n        encoding: 'utf8',\n        timeout: 5000,\n        stdio: ['pipe', 'pipe', 'pipe'],\n      }).trim();\n\n      logHook('setup-maintenance', `Coordination locks remaining: ${lockCount}`);\n      cleaned = 1;\n    } catch {\n      // Ignore SQLite errors\n    }\n  }\n\n  // Clean up .lock files older than 24 hours\n  try {\n    const walkAndClean = (dir: string, depth = 0) => {\n      if (depth > 3) return;\n      try {\n        const entries = readdirSync(dir, { withFileTypes: true });\n        for (const entry of entries) {\n          const fullPath = `${dir}/${entry.name}`;\n          if (entry.isDirectory() && !entry.name.startsWith('.')) {\n            walkAndClean(fullPath, depth + 1);\n          } else if (entry.name.endsWith('.lock')) {\n            try {\n              const stats = statSync(fullPath);\n              const ageHours = (Date.now() - stats.mtimeMs) / (1000 * 60 * 60);\n              if (ageHours > 24) {\n                unlinkSync(fullPath);\n                cleaned++;\n              }\n            } catch {\n              // Ignore\n            }\n          }\n        }\n      } catch {\n        // Ignore\n      }\n    };\n    walkAndClean(pluginRoot);\n  } catch {\n    // Ignore\n  }\n\n  if (cleaned > 0) {\n    tasksCompleted.push('Cleaned stale locks');\n  }\n}\n\n/**\n * Task: Session cleanup\n */\nfunction taskSessionCleanup(pluginRoot: string): void {\n  logHook('setup-maintenance', 'Task: Session cleanup');\n\n  const sessionDir = `${pluginRoot}/.claude/context/sessions`;\n  const archiveDir = `${pluginRoot}/.claude/context/archive`;\n\n  if (!existsSync(sessionDir)) {\n    return;\n  }\n\n  let archived = 0;\n\n  try {\n    mkdirSync(archiveDir, { recursive: true });\n    const entries = readdirSync(sessionDir, { withFileTypes: true });\n\n    for (const entry of entries) {\n      if (!entry.isDirectory()) continue;\n\n      const fullPath = `${sessionDir}/${entry.name}`;\n      try {\n        const stats = statSync(fullPath);\n        const ageDays = (Date.now() - stats.mtimeMs) / (1000 * 60 * 60 * 24);\n        if (ageDays > 7) {\n          renameSync(fullPath, `${archiveDir}/${entry.name}`);\n          archived++;\n        }\n      } catch {\n        // Ignore\n      }\n    }\n  } catch {\n    // Ignore\n  }\n\n  // Clean up old temp files\n  try {\n    const entries = readdirSync('/tmp');\n    for (const entry of entries) {\n      if (!entry.startsWith('claude-session-')) continue;\n\n      const fullPath = `/tmp/${entry}`;\n      try {\n        const stats = statSync(fullPath);\n        const ageDays = (Date.now() - stats.mtimeMs) / (1000 * 60 * 60 * 24);\n        if (ageDays > 7 && stats.isDirectory()) {\n          execSync(`rm -rf \"${fullPath}\"`, { stdio: ['pipe', 'pipe', 'pipe'] });\n        }\n      } catch {\n        // Ignore\n      }\n    }\n  } catch {\n    // Ignore\n  }\n\n  if (archived > 0) {\n    tasksCompleted.push(`Archived ${archived} old sessions`);\n  }\n}\n\n/**\n * Task: Memory Fabric cleanup\n */\nfunction taskMemoryFabricCleanup(projectDir: string): void {\n  logHook('setup-maintenance', 'Task: Memory Fabric cleanup');\n\n  let cleaned = 0;\n  const logsDir = `${projectDir}/.claude/logs`;\n\n  // Clean up old pending sync files (older than 7 days)\n  if (existsSync(logsDir)) {\n    try {\n      const files = readdirSync(logsDir);\n      for (const file of files) {\n        if (!file.startsWith('.mem0-pending-sync-')) continue;\n\n        const fullPath = `${logsDir}/${file}`;\n        try {\n          const stats = statSync(fullPath);\n          const ageDays = (Date.now() - stats.mtimeMs) / (1000 * 60 * 60 * 24);\n          if (ageDays > 7) {\n            unlinkSync(fullPath);\n            cleaned++;\n          }\n        } catch {\n          // Ignore\n        }\n      }\n    } catch {\n      // Ignore\n    }\n  }\n\n  // Clean up global pending sync if stale\n  const globalSync = `${process.env.HOME}/.claude/.mem0-pending-sync.json`;\n  if (existsSync(globalSync)) {\n    try {\n      const stats = statSync(globalSync);\n      const ageHours = (Date.now() - stats.mtimeMs) / (1000 * 60 * 60);\n      if (ageHours > 24) {\n        unlinkSync(globalSync);\n        cleaned++;\n      }\n    } catch {\n      // Ignore\n    }\n  }\n\n  if (cleaned > 0) {\n    tasksCompleted.push(`Cleaned ${cleaned} Memory Fabric files`);\n  }\n}\n\n/**\n * Task: Health validation\n */\nfunction taskHealthValidation(pluginRoot: string, markerFile: string): void {\n  logHook('setup-maintenance', 'Task: Full health validation');\n\n  let issues = 0;\n\n  // Validate all hooks are executable\n  let nonExec = 0;\n  const checkExecutable = (dir: string, depth = 0) => {\n    if (depth > 4) return;\n    try {\n      const entries = readdirSync(dir, { withFileTypes: true });\n      for (const entry of entries) {\n        const fullPath = `${dir}/${entry.name}`;\n        if (entry.isDirectory() && !entry.name.startsWith('.')) {\n          checkExecutable(fullPath, depth + 1);\n        } else if (entry.name.endsWith('.sh')) {\n          try {\n            const stats = statSync(fullPath);\n            if (!(stats.mode & 0o111)) {\n              chmodSync(fullPath, 0o755);\n              nonExec++;\n            }\n          } catch {\n            // Ignore\n          }\n        }\n      }\n    } catch {\n      // Ignore\n    }\n  };\n\n  checkExecutable(`${pluginRoot}/hooks`);\n  if (nonExec > 0) {\n    logHook('setup-maintenance', `WARN: ${nonExec} hooks were not executable`);\n    issues++;\n  }\n\n  // Validate config.json\n  const configFile = `${pluginRoot}/.claude/defaults/config.json`;\n  if (existsSync(configFile)) {\n    try {\n      JSON.parse(readFileSync(configFile, 'utf-8'));\n    } catch {\n      logHook('setup-maintenance', 'WARN: config.json is invalid');\n      issues++;\n    }\n  }\n\n  // Update health check timestamp\n  updateMarkerField(markerFile, 'last_health_check', new Date().toISOString());\n\n  if (issues === 0) {\n    tasksCompleted.push('Health validation passed');\n  } else {\n    tasksCompleted.push(`Health validation found ${issues} issues (auto-fixed)`);\n  }\n}\n\n/**\n * Task: Version migration\n */\nfunction taskVersionMigration(markerFile: string): void {\n  logHook('setup-maintenance', 'Task: Version migration');\n\n  const markerVersion = getMarkerField(markerFile, 'version') as string | null;\n\n  if (!markerVersion || markerVersion === CURRENT_VERSION) {\n    return;\n  }\n\n  logHook('setup-maintenance', `Migrating from ${markerVersion} to ${CURRENT_VERSION}`);\n\n  // Version-specific migrations would go here\n  // For now, just log and update version\n\n  updateMarkerField(markerFile, 'version', CURRENT_VERSION);\n  tasksCompleted.push(`Migrated from ${markerVersion} to ${CURRENT_VERSION}`);\n}\n\n/**\n * Setup maintenance hook\n */\nexport function setupMaintenance(input: HookInput): HookResult {\n  const pluginRoot = getPluginRoot();\n  const projectDir = input.project_dir || getProjectDir();\n  const markerFile = `${pluginRoot}/.setup-complete`;\n\n  // Determine mode from argv\n  const args = process.argv;\n  let mode = 'auto';\n  if (args.includes('--force')) {\n    mode = 'force';\n  } else if (args.includes('--migrate')) {\n    mode = 'migrate';\n  } else if (args.includes('--background')) {\n    mode = 'background';\n  }\n\n  logHook('setup-maintenance', `Maintenance starting (mode: ${mode})`);\n\n  const now = new Date().toISOString();\n  const lastMaintenance = getMarkerField(markerFile, 'last_maintenance') as string | null;\n  const hours = hoursSince(lastMaintenance);\n\n  let runDaily = false;\n  let runWeekly = false;\n\n  switch (mode) {\n    case 'force':\n      runDaily = true;\n      runWeekly = true;\n      break;\n    case 'migrate':\n      taskVersionMigration(markerFile);\n      break;\n    case 'background':\n    case 'auto':\n      if (hours >= 24) {\n        runDaily = true;\n      }\n      if (hours >= 168) {\n        // 7 days\n        runWeekly = true;\n      }\n      break;\n  }\n\n  // Run daily tasks\n  if (runDaily) {\n    logHook('setup-maintenance', 'Running daily maintenance tasks');\n    taskLogRotation(pluginRoot);\n    taskStaleLockCleanup(pluginRoot);\n    taskSessionCleanup(pluginRoot);\n    taskMemoryFabricCleanup(projectDir);\n  }\n\n  // Run weekly tasks\n  if (runWeekly) {\n    logHook('setup-maintenance', 'Running weekly maintenance tasks');\n    taskHealthValidation(pluginRoot, markerFile);\n  }\n\n  // Update last maintenance timestamp\n  updateMarkerField(markerFile, 'last_maintenance', now);\n\n  // Build summary\n  if (tasksCompleted.length > 0) {\n    logHook('setup-maintenance', `Maintenance complete: ${tasksCompleted.length} tasks`);\n    const summary = `Completed: ${tasksCompleted.join(', ')}`;\n\n    if (mode === 'background') {\n      return outputSilentSuccess();\n    }\n\n    return outputWithContext(`Maintenance: ${summary}`);\n  }\n\n  logHook('setup-maintenance', 'No maintenance tasks needed');\n  return outputSilentSuccess();\n}\n", "/**\n * Setup Repair - Self-healing for broken installations\n *\n * INTERNAL HOOK: Called by setup-check when validation fails.\n * NOT registered in plugin.json (by design - it's a sub-hook).\n *\n * CC 2.1.11 Compliant\n *\n * Repair Actions:\n * - Restore missing/corrupt config files\n * - Fix hook permissions\n * - Regenerate marker file\n * - Run migrations for version mismatches\n */\n\nimport {\n  existsSync,\n  mkdirSync,\n  readFileSync,\n  writeFileSync,\n  renameSync,\n  readdirSync,\n  statSync,\n  chmodSync,\n} from 'node:fs';\nimport type { HookInput, HookResult } from '../types.js';\nimport { logHook, getPluginRoot, outputSilentSuccess, outputWithContext } from '../lib/common.js';\n\nconst CURRENT_VERSION = '4.25.0';\n\nconst repairsMade: string[] = [];\nconst repairsFailed: string[] = [];\nlet notifyUser = false;\n\n/**\n * Repair: Restore config.json\n */\nfunction repairConfig(pluginRoot: string): void {\n  const configFile = `${pluginRoot}/.claude/defaults/config.json`;\n  const configDir = `${pluginRoot}/.claude/defaults`;\n\n  // Ensure directory exists\n  try {\n    mkdirSync(configDir, { recursive: true });\n  } catch {\n    // Ignore\n  }\n\n  // Check if config exists and is valid\n  if (existsSync(configFile)) {\n    try {\n      JSON.parse(readFileSync(configFile, 'utf-8'));\n      return; // Config is valid\n    } catch {\n      // Backup corrupt config\n      const backup = `${configFile}.corrupt.${Date.now()}`;\n      try {\n        renameSync(configFile, backup);\n        logHook('setup-repair', `Backed up corrupt config to ${backup}`);\n        notifyUser = true;\n      } catch {\n        // Ignore rename errors\n      }\n    }\n  }\n\n  // Restore default config\n  const defaultConfig = {\n    preset: 'complete',\n    description: 'Full AI-assisted development toolkit (restored by repair)',\n    features: {\n      skills: true,\n      agents: true,\n      hooks: true,\n      mcp: true,\n      coordination: true,\n      statusline: true,\n    },\n    hook_groups: {\n      safety: true,\n      quality: true,\n      productivity: true,\n      observability: true,\n    },\n  };\n\n  writeFileSync(configFile, JSON.stringify(defaultConfig, null, 2));\n  repairsMade.push('config.json restored');\n  logHook('setup-repair', 'Restored default config.json');\n}\n\n/**\n * Repair: Fix hook permissions\n */\nfunction repairHookPermissions(pluginRoot: string): void {\n  let fixed = 0;\n\n  const fixPermissions = (dir: string, depth = 0) => {\n    if (depth > 5) return;\n\n    try {\n      const entries = readdirSync(dir, { withFileTypes: true });\n      for (const entry of entries) {\n        const fullPath = `${dir}/${entry.name}`;\n        if (entry.isDirectory() && !entry.name.startsWith('.')) {\n          fixPermissions(fullPath, depth + 1);\n        } else if (entry.name.endsWith('.sh')) {\n          try {\n            const stats = statSync(fullPath);\n            if (!(stats.mode & 0o111)) {\n              chmodSync(fullPath, 0o755);\n              fixed++;\n            }\n          } catch {\n            // Ignore\n          }\n        }\n      }\n    } catch {\n      // Ignore\n    }\n  };\n\n  fixPermissions(`${pluginRoot}/hooks`);\n\n  if (fixed > 0) {\n    repairsMade.push(`${fixed} hook permissions fixed`);\n    logHook('setup-repair', `Fixed permissions on ${fixed} hooks`);\n  }\n}\n\n/**\n * Repair: Ensure required directories exist\n */\nfunction repairDirectories(pluginRoot: string): void {\n  let dirsCreated = 0;\n\n  const requiredDirs = [\n    `${pluginRoot}/.claude/defaults`,\n    `${pluginRoot}/.claude/context/session`,\n    `${pluginRoot}/.claude/context/knowledge`,\n    `${pluginRoot}/.claude/logs`,\n    `${pluginRoot}/.claude/coordination`,\n  ];\n\n  for (const dir of requiredDirs) {\n    if (!existsSync(dir)) {\n      try {\n        mkdirSync(dir, { recursive: true });\n        dirsCreated++;\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  if (dirsCreated > 0) {\n    repairsMade.push(`${dirsCreated} directories created`);\n    logHook('setup-repair', `Created ${dirsCreated} missing directories`);\n  }\n}\n\n/**\n * Repair: Regenerate marker file\n */\nfunction repairMarker(pluginRoot: string): void {\n  const now = new Date().toISOString();\n\n  // Count components\n  let hookCount = 0;\n  let skillCount = 0;\n  let agentCount = 0;\n\n  const countFiles = (dir: string, pattern: RegExp, maxDepth = 5): number => {\n    let count = 0;\n    const walk = (d: string, depth: number) => {\n      if (depth > maxDepth) return;\n      try {\n        const entries = readdirSync(d, { withFileTypes: true });\n        for (const entry of entries) {\n          const fullPath = `${d}/${entry.name}`;\n          if (entry.isDirectory() && !entry.name.startsWith('.')) {\n            walk(fullPath, depth + 1);\n          } else if (pattern.test(entry.name)) {\n            count++;\n          }\n        }\n      } catch {\n        // Ignore\n      }\n    };\n    walk(dir, 0);\n    return count;\n  };\n\n  try {\n    hookCount = countFiles(`${pluginRoot}/hooks`, /\\.sh$/);\n    skillCount = countFiles(`${pluginRoot}/skills`, /SKILL\\.md$/);\n    agentCount = countFiles(`${pluginRoot}/agents`, /\\.md$/);\n  } catch {\n    // Ignore\n  }\n\n  const marker = {\n    version: CURRENT_VERSION,\n    setup_date: now,\n    preset: 'complete',\n    repaired_at: now,\n    components: {\n      hooks: { count: hookCount, valid: true },\n      skills: { count: skillCount, valid: true },\n      agents: { count: agentCount, valid: true },\n    },\n    last_health_check: now,\n    last_maintenance: now,\n    environment: {\n      os: process.platform,\n    },\n    user_preferences: {\n      onboarding_completed: true,\n      mcp_configured: false,\n      statusline_configured: false,\n    },\n  };\n\n  const markerFile = `${pluginRoot}/.setup-complete`;\n  writeFileSync(markerFile, JSON.stringify(marker, null, 2));\n  repairsMade.push('marker file regenerated');\n  logHook('setup-repair', 'Regenerated marker file');\n}\n\n/**\n * Check for critical missing components\n */\nfunction checkCriticalComponents(pluginRoot: string): boolean {\n  let criticalMissing = 0;\n\n  // Count hooks\n  let hookCount = 0;\n  try {\n    const countFiles = (dir: string): number => {\n      let count = 0;\n      const walk = (d: string, depth: number) => {\n        if (depth > 4) return;\n        try {\n          const entries = readdirSync(d, { withFileTypes: true });\n          for (const entry of entries) {\n            const fullPath = `${d}/${entry.name}`;\n            if (entry.isDirectory() && !entry.name.startsWith('.')) {\n              walk(fullPath, depth + 1);\n            } else if (entry.name.endsWith('.sh')) {\n              count++;\n            }\n          }\n        } catch {\n          // Ignore\n        }\n      };\n      walk(dir, 0);\n      return count;\n    };\n    hookCount = countFiles(`${pluginRoot}/hooks`);\n  } catch {\n    // Ignore\n  }\n\n  if (hookCount < 20) {\n    logHook('setup-repair', `CRITICAL: Only ${hookCount} hooks found (expected 50+)`);\n    criticalMissing++;\n  }\n\n  // Count skills\n  let skillCount = 0;\n  try {\n    const countFiles = (dir: string): number => {\n      let count = 0;\n      const walk = (d: string, depth: number) => {\n        if (depth > 2) return;\n        try {\n          const entries = readdirSync(d, { withFileTypes: true });\n          for (const entry of entries) {\n            const fullPath = `${d}/${entry.name}`;\n            if (entry.isDirectory() && !entry.name.startsWith('.')) {\n              walk(fullPath, depth + 1);\n            } else if (entry.name === 'SKILL.md') {\n              count++;\n            }\n          }\n        } catch {\n          // Ignore\n        }\n      };\n      walk(dir, 0);\n      return count;\n    };\n    skillCount = countFiles(`${pluginRoot}/skills`);\n  } catch {\n    // Ignore\n  }\n\n  if (skillCount < 50) {\n    logHook('setup-repair', `CRITICAL: Only ${skillCount} skills found (expected 100+)`);\n    criticalMissing++;\n  }\n\n  // Check for common.sh library\n  if (!existsSync(`${pluginRoot}/hooks/_lib/common.sh`)) {\n    logHook('setup-repair', 'CRITICAL: hooks/_lib/common.sh missing');\n    criticalMissing++;\n  }\n\n  if (criticalMissing >= 2) {\n    repairsFailed.push('Multiple critical components missing - reinstall recommended');\n    notifyUser = true;\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Setup repair hook\n */\nexport function setupRepair(input: HookInput): HookResult {\n  const pluginRoot = getPluginRoot();\n\n  logHook('setup-repair', 'Setup repair starting');\n\n  // Run repairs in order of importance\n  repairDirectories(pluginRoot);\n  repairConfig(pluginRoot);\n  repairHookPermissions(pluginRoot);\n\n  // Check for critical missing components\n  if (!checkCriticalComponents(pluginRoot)) {\n    logHook('setup-repair', 'WARN: Critical components missing, repair incomplete');\n  }\n\n  // Regenerate marker file last (after other repairs)\n  repairMarker(pluginRoot);\n\n  // Build output message\n  let repairSummary = '';\n  if (repairsMade.length > 0) {\n    repairSummary = `Repairs: ${repairsMade.join(', ')}`;\n  }\n\n  if (repairsFailed.length > 0) {\n    repairSummary = `${repairSummary ? repairSummary + '. ' : ''}Issues: ${repairsFailed.join(', ')}`;\n    notifyUser = true;\n  }\n\n  logHook('setup-repair', `Repair complete: ${repairsMade.length} repairs made, ${repairsFailed.length} issues`);\n\n  // Output result\n  if (notifyUser && repairSummary) {\n    return outputWithContext(`OrchestKit auto-repair: ${repairSummary}`);\n  }\n\n  return outputSilentSuccess();\n}\n", "/**\n * Setup Hooks Entry Point\n *\n * Hooks that run during setup (--init, --maintenance)\n * Bundle: setup.mjs (~15 KB estimated)\n */\n\n// Re-export types and utilities\nexport * from '../types.js';\nexport * from '../lib/common.js';\n\n// Setup hooks (7)\nimport { firstRunSetup } from '../setup/first-run-setup.js';\nimport { mem0AnalyticsDashboard } from '../setup/mem0-analytics-dashboard.js';\nimport { mem0BackupSetup } from '../setup/mem0-backup-setup.js';\nimport { mem0Cleanup } from '../setup/mem0-cleanup.js';\nimport { setupCheck } from '../setup/setup-check.js';\nimport { setupMaintenance } from '../setup/setup-maintenance.js';\nimport { setupRepair } from '../setup/setup-repair.js';\n\nimport type { HookFn } from '../types.js';\n\n/**\n * Setup hooks registry\n */\nexport const hooks: Record<string, HookFn> = {\n  'setup/first-run-setup': firstRunSetup,\n  'setup/mem0-analytics-dashboard': mem0AnalyticsDashboard,\n  'setup/mem0-backup-setup': mem0BackupSetup,\n  'setup/mem0-cleanup': mem0Cleanup,\n  'setup/setup-check': setupCheck,\n  'setup/setup-maintenance': setupMaintenance,\n  'setup/setup-repair': setupRepair,\n};\n\nexport function getHook(name: string): HookFn | undefined {\n  return hooks[name];\n}\n\nexport function listHooks(): string[] {\n  return Object.keys(hooks);\n}\n"],
  "mappings": "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",
  "names": ["isBashInput", "input", "isWriteInput", "isEditInput", "isReadInput", "appendFileSync", "existsSync", "statSync", "renameSync", "mkdirSync", "getLogDir", "getProjectDir", "getPluginRoot", "getSessionId", "outputSilentSuccess", "outputSilentAllow", "outputBlock", "reason", "outputWithContext", "ctx", "outputPromptContext", "outputAllowWithContext", "systemMessage", "result", "outputError", "message", "outputWarning", "outputDeny", "LOG_ROTATION_MAX_SIZE", "PERMISSION_LOG_MAX_SIZE", "rotateLogFile", "logFile", "maxSize", "rotated", "ensureDir", "dir", "logHook", "hookName", "logDir", "timestamp", "logPermissionFeedback", "decision", "input", "toolName", "sessionId", "readHookInput", "chunks", "buf", "bytesRead", "fd", "readSync", "getField", "path", "parts", "value", "part", "normalizeCommand", "command", "escapeRegex", "str", "existsSync", "mkdirSync", "writeFileSync", "readdirSync", "chmodSync", "execSync", "CURRENT_VERSION", "detectEnvironment", "logHook", "envInfo", "match", "execSync", "validateDependencies", "missing", "warnings", "dep", "warn", "getPresetConfig", "preset", "configs", "applyConfiguration", "pluginRoot", "config", "dirs", "dir", "mkdirSync", "configFile", "existsSync", "writeFileSync", "hooksDir", "makeExecutable", "entries", "readdirSync", "entry", "fullPath", "chmodSync", "createMarker", "now", "hookCount", "skillCount", "agentCount", "countFiles", "pattern", "count", "walk", "d", "marker", "markerFile", "firstRunSetup", "input", "getPluginRoot", "mode", "valid", "ctx", "outputWithContext", "existsSync", "mkdirSync", "writeFileSync", "execSync", "isMem0Available", "mem0AnalyticsDashboard", "input", "logHook", "outputSilentSuccess", "projectDir", "getProjectDir", "pluginRoot", "getPluginRoot", "analyticsFile", "dashboardFile", "summaryScript", "summaryOutput", "existsSync", "execSync", "summary", "dashboardData", "mkdirSync", "writeFileSync", "error", "mkdirSync", "writeFileSync", "isMem0Available", "mem0BackupSetup", "input", "logHook", "outputSilentSuccess", "projectDir", "getProjectDir", "backupConfig", "backupSchedule", "backupRetention", "mkdirSync", "writeFileSync", "error", "existsSync", "mkdirSync", "appendFileSync", "execSync", "isMem0Available", "getCutoffDate", "daysAgo", "date", "mem0Cleanup", "input", "logHook", "outputSilentSuccess", "projectDir", "getProjectDir", "scriptsDir", "getPluginRoot", "batchDeleteScript", "getMemoriesScript", "existsSync", "ageThreshold", "cutoffDate", "logFile", "mkdirSync", "timestamp", "appendFileSync", "memoriesJson", "result", "execSync", "staleIds", "m", "isOld", "isProtected", "idsArray", "error", "existsSync", "readFileSync", "readdirSync", "writeFileSync", "spawn", "CURRENT_VERSION", "getMarkerField", "markerFile", "field", "existsSync", "content", "readFileSync", "parts", "value", "part", "quickValidate", "pluginRoot", "errors", "configFile", "logHook", "hookCount", "countShFiles", "dir", "depth", "count", "entries", "readdirSync", "entry", "fullPath", "markerVersion", "isMaintenanceDue", "lastMaintenance", "lastEpoch", "updateMarker", "writeFileSync", "setupCheck", "input", "outputSilentSuccess", "getPluginRoot", "setupDir", "args", "outputWithContext", "maintenanceScript", "spawn", "repairScript", "existsSync", "mkdirSync", "readFileSync", "writeFileSync", "renameSync", "readdirSync", "unlinkSync", "statSync", "chmodSync", "execSync", "CURRENT_VERSION", "tasksCompleted", "getMarkerField", "markerFile", "field", "existsSync", "readFileSync", "updateMarkerField", "value", "content", "writeFileSync", "hoursSince", "timestamp", "lastEpoch", "taskLogRotation", "pluginRoot", "logHook", "logDirs", "rotated", "logDir", "files", "readdirSync", "file", "filePath", "statSync", "rotatedName", "renameSync", "execSync", "rotatedLogs", "f", "oldLog", "unlinkSync", "taskStaleLockCleanup", "coordDb", "cleaned", "lockCount", "walkAndClean", "dir", "depth", "entries", "entry", "fullPath", "stats", "taskSessionCleanup", "sessionDir", "archiveDir", "archived", "mkdirSync", "taskMemoryFabricCleanup", "projectDir", "logsDir", "globalSync", "taskHealthValidation", "issues", "nonExec", "checkExecutable", "chmodSync", "configFile", "taskVersionMigration", "markerVersion", "setupMaintenance", "input", "getPluginRoot", "getProjectDir", "args", "mode", "now", "lastMaintenance", "hours", "runDaily", "runWeekly", "summary", "outputSilentSuccess", "outputWithContext", "existsSync", "mkdirSync", "readFileSync", "writeFileSync", "renameSync", "readdirSync", "statSync", "chmodSync", "CURRENT_VERSION", "repairsMade", "repairsFailed", "notifyUser", "repairConfig", "pluginRoot", "configFile", "configDir", "mkdirSync", "existsSync", "readFileSync", "backup", "renameSync", "logHook", "writeFileSync", "repairHookPermissions", "fixed", "fixPermissions", "dir", "depth", "entries", "readdirSync", "entry", "fullPath", "statSync", "chmodSync", "repairDirectories", "dirsCreated", "requiredDirs", "repairMarker", "now", "hookCount", "skillCount", "agentCount", "countFiles", "pattern", "maxDepth", "count", "walk", "d", "marker", "markerFile", "checkCriticalComponents", "criticalMissing", "setupRepair", "input", "getPluginRoot", "repairSummary", "outputWithContext", "outputSilentSuccess", "hooks", "firstRunSetup", "mem0AnalyticsDashboard", "mem0BackupSetup", "mem0Cleanup", "setupCheck", "setupMaintenance", "setupRepair", "getHook", "name", "listHooks"]
}
