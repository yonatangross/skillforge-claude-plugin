// OrchestKit Hooks - agent bundle
// Generated: 2026-01-23T17:57:28.914Z

var m=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(o,e)=>(typeof require<"u"?require:o)[e]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});function L(t){return typeof t.command=="string"}function j(t){return typeof t.file_path=="string"&&typeof t.content=="string"}function B(t){return typeof t.file_path=="string"&&typeof t.old_string=="string"&&typeof t.new_string=="string"}function F(t){return typeof t.file_path=="string"&&t.content===void 0}import{appendFileSync as g,existsSync as k,statSync as P,renameSync as O,mkdirSync as C}from"node:fs";function y(){return process.env.CLAUDE_PLUGIN_ROOT?`${process.env.HOME}/.claude/logs/ork`:`${f()}/.claude/logs`}function f(){return process.env.CLAUDE_PROJECT_DIR||"."}function q(){return process.env.CLAUDE_PLUGIN_ROOT||process.env.CLAUDE_PROJECT_DIR||"."}function a(){return process.env.CLAUDE_SESSION_ID||`fallback-${process.pid}-${Date.now()}`}function r(){return{continue:!0,suppressOutput:!0}}function V(){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{permissionDecision:"allow"}}}function K(t){return{continue:!1,stopReason:t,hookSpecificOutput:{permissionDecision:"deny",permissionDecisionReason:t}}}function c(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"PostToolUse",additionalContext:t}}}function Z(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"UserPromptSubmit",additionalContext:t}}}function z(t,o){let e={continue:!0,hookSpecificOutput:{hookEventName:"PreToolUse",additionalContext:t,permissionDecision:"allow"}};return o?e.systemMessage=o:e.suppressOutput=!0,e}function J(t){return{continue:!0,systemMessage:t}}function X(t){return{continue:!0,systemMessage:`\u26A0 ${t}`}}function i(t){return{continue:!1,stopReason:t,hookSpecificOutput:{hookEventName:"PreToolUse",permissionDecision:"deny",permissionDecisionReason:t}}}var b=200*1024,v=100*1024;function h(t,o){if(k(t))try{if(P(t).size>o){let n=`${t}.old.${Date.now()}`;O(t,n)}}catch{}}function x(t){k(t)||C(t,{recursive:!0})}function Q(t,o){let e=y(),n=`${e}/hooks.log`;try{x(e),h(n,b);let s=new Date().toISOString().replace("T"," ").slice(0,19);g(n,`[${s}] [${t}] ${o}
`)}catch{}}function Y(t,o,e){let n=y(),s=`${n}/permission-feedback.log`;try{x(n),h(s,v);let u=new Date().toISOString(),p=e?.tool_name||process.env.HOOK_TOOL_NAME||"unknown",l=e?.session_id||a();g(s,`${u} | ${t} | ${o} | tool=${p} | session=${l}
`)}catch{}}function tt(){try{let t=[],e=Buffer.allocUnsafe(256),n,s=0,{readSync:u}=m("node:fs");for(;;)try{if(n=u(s,e,0,256,null),n===0)break;t.push(Buffer.from(e.subarray(0,n)))}catch{break}let p=Buffer.concat(t).toString("utf8").trim();return p?JSON.parse(p):{tool_name:"",session_id:a(),tool_input:{}}}catch{return{tool_name:"",session_id:a(),tool_input:{}}}}function et(t,o){let e=o.replace(/^\./,"").split("."),n=t;for(let s of e){if(n==null)return;n=n[s]}return n}function ot(t){return t.replace(/\\\s*[\r\n]+/g," ").replace(/\n/g," ").replace(/\s+/g," ").trim()}function nt(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function it(t){return o=>t(o)?null:r()}function d(t,...o){let e=t.tool_input.file_path;if(!e)return r();let n=e.split(".").pop()?.toLowerCase()||"";return o.map(u=>u.toLowerCase().replace(/^\./,"")).includes(n)?null:r()}function ut(t){return d(t,"py","ts","tsx","js","jsx","go","rs","java")}function pt(t){return d(t,"py")}function ct(t){return d(t,"ts","tsx","js","jsx")}function at(t){let o=t.tool_input.file_path;return o?[/test/i,/spec/i,/__tests__/i].some(n=>n.test(o))?null:r():r()}function lt(t){let o=t.tool_input.file_path||"";return o&&[/\/\.claude\//,/\/node_modules\//,/\/\.git\//,/\/dist\//,/\/build\//,/\/__pycache__\//,/\/\.venv\//,/\/venv\//,/\.lock$/].some(n=>n.test(o))?r():null}function ft(t,...o){let e=t.tool_input.file_path;if(!e)return r();for(let n of o)if(typeof n=="string"){if(new RegExp(n.replace(/\*/g,".*").replace(/\?/g,".")).test(e))return null}else if(n.test(e))return null;return r()}function _(t,...o){let e=t.tool_name;return e?o.includes(e)?null:r():r()}function dt(t){return _(t,"Write","Edit")}function mt(t){return _(t,"Bash")}function gt(t){let o=t.tool_input.command||"";return[/^echo\s/,/^ls(\s|$)/,/^pwd$/,/^cat\s/,/^head\s/,/^tail\s/,/^wc\s/,/^date$/,/^whoami$/].some(n=>n.test(o))?r():null}function kt(t){return(t.tool_input.command||"").startsWith("git")?null:r()}function yt(t){let e=`${t.project_dir||process.env.CLAUDE_PROJECT_DIR||"."}/.claude/coordination/.claude.db`;try{let{existsSync:n}=m("node:fs");if(n(e))return null}catch{}return r()}function ht(t,...o){for(let e of o){let n=e(t);if(n!==null)return n}return null}function I(t){let o=t.tool_input.file_path||"",e=t.tool_name;return e!=="Write"&&e!=="Edit"?r():/\.(tsx|jsx|html)$/.test(o)?c("A11y reminder: Verify WCAG 2.2 compliance - check color contrast, ARIA labels, keyboard navigation, and focus management."):r()}function R(t){let o=t.tool_name,e=process.env.CLAUDE_AGENT_ID||"unknown";return["Write","Edit","MultiEdit","NotebookEdit"].includes(o)?i(`BLOCKED: Agent '${e}' is read-only. Write/Edit operations are not permitted. This agent investigates and reports - it does not modify code.`):r()}var w=[/force.*push/i,/push.*--force/i,/--force-with-lease/i,/workflow_dispatch/i,/delete.*workflow/i,/gh\s+secret\s+delete/i,/gh\s+variable\s+delete/i,/rm.*-rf.*\.github/i];function H(t){let o=t.tool_input.command||"";for(let e of w)if(e.test(o))return i(`BLOCKED: Potentially destructive CI/CD operation detected. Pattern: '${e.source}'. This requires explicit user approval.`);return/deploy|release|publish/i.test(o)?c("CI/CD Safety: Deployment commands detected. Verify target environment and ensure proper approvals are in place."):r()}var $=[/\bprod\b/i,/production/i,/--env.*prod/i,/ENV=prod/i,/ENVIRONMENT=prod/i,/deploy.*main/i,/deploy.*master/i];function S(t){let o=t.tool_input.command||"";for(let e of $)if(e.test(o))return i(`BLOCKED: Production deployment detected. Pattern: '${e.source}'. Production deployments require explicit user approval and should go through proper release processes.`);return/rollback|revert|downgrade/i.test(o)?c("Deployment Safety: Rollback operation detected. Verify the target version and ensure proper change management procedures are followed."):/terraform|kubectl|helm|docker.*push/i.test(o)?c("Deployment Safety: Infrastructure change detected. Verify changes in staging before production deployment."):r()}var N=[/DROP\s+TABLE/i,/DROP\s+DATABASE/i,/TRUNCATE/i,/DELETE\s+FROM.*WHERE\s+1/i,/DELETE\s+FROM\s+[^W]*$/i,/--force/i,/alembic\s+downgrade/i];function E(t){if(t.tool_name!=="Bash")return r();let e=t.tool_input.command||"";for(let n of N)if(n.test(e))return i(`BLOCKED: Potentially destructive database command detected. Pattern: '${n.source}'. Please confirm this operation is intentional before proceeding.`);return r()}import{mkdirSync as A,appendFileSync as G}from"node:fs";function T(t){let o=process.env.CLAUDE_AGENT_ID||"unknown",e=t.tool_name,n=t.session_id||a(),s=t.project_dir||f(),u=`${s}/.claude/logs/security-audit.log`;if(e!=="Bash")return r();let p=t.tool_input.command||"",l=new Date().toISOString();if(p)try{A(`${s}/.claude/logs`,{recursive:!0}),G(u,`[${l}] [${n}] [${o}] CMD: ${p}
`)}catch{}return r()}var D={"agent/a11y-lint-check":I,"agent/block-writes":R,"agent/ci-safety-check":H,"agent/deployment-safety-check":S,"agent/migration-safety-check":E,"agent/security-command-audit":T};function Lt(t){return D[t]}function jt(){return Object.keys(D)}export{it as createGuard,nt as escapeRegex,et as getField,Lt as getHook,y as getLogDir,q as getPluginRoot,f as getProjectDir,a as getSessionId,mt as guardBash,ut as guardCodeFiles,d as guardFileExtension,kt as guardGitCommand,yt as guardMultiInstance,gt as guardNontrivialBash,ft as guardPathPattern,pt as guardPythonFiles,lt as guardSkipInternal,at as guardTestFiles,_ as guardTool,ct as guardTypescriptFiles,dt as guardWriteEdit,D as hooks,L as isBashInput,B as isEditInput,F as isReadInput,j as isWriteInput,jt as listHooks,Q as logHook,Y as logPermissionFeedback,ot as normalizeCommand,z as outputAllowWithContext,K as outputBlock,i as outputDeny,J as outputError,Z as outputPromptContext,V as outputSilentAllow,r as outputSilentSuccess,X as outputWarning,c as outputWithContext,tt as readHookInput,ht as runGuards};
//# sourceMappingURL=agent.mjs.map
