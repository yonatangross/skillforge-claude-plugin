{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/yonatangross/skillforge-claude-plugin/schemas/feedback.schema.json",
  "title": "SkillForge Feedback Schema",
  "description": "Schema for feedback data collection and learning patterns",
  "type": "object",
  "definitions": {
    "metrics": {
      "type": "object",
      "properties": {
        "version": { "type": "string", "pattern": "^\\d+\\.\\d+$" },
        "updated": { "type": "string", "format": "date-time" },
        "skills": {
          "type": "object",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "uses": { "type": "integer", "minimum": 0 },
              "successes": { "type": "integer", "minimum": 0 },
              "avgEdits": { "type": "number", "minimum": 0 },
              "lastUsed": { "type": "string", "format": "date" }
            },
            "required": ["uses", "successes"]
          }
        },
        "hooks": {
          "type": "object",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "triggered": { "type": "integer", "minimum": 0 },
              "blocked": { "type": "integer", "minimum": 0 },
              "userOverrides": { "type": "integer", "minimum": 0 }
            },
            "required": ["triggered"]
          }
        },
        "agents": {
          "type": "object",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "spawns": { "type": "integer", "minimum": 0 },
              "successes": { "type": "integer", "minimum": 0 },
              "avgDuration": { "type": "number", "minimum": 0 }
            },
            "required": ["spawns"]
          }
        }
      },
      "required": ["version", "updated"]
    },
    "learnedPatterns": {
      "type": "object",
      "properties": {
        "version": { "type": "string", "pattern": "^\\d+\\.\\d+$" },
        "updated": { "type": "string", "format": "date-time" },
        "permissions": {
          "type": "object",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "autoApprove": { "type": "boolean" },
              "confidence": { "type": "number", "minimum": 0, "maximum": 1 },
              "samples": { "type": "integer", "minimum": 0 },
              "lastApproved": { "type": "string", "format": "date-time" }
            },
            "required": ["autoApprove", "confidence", "samples"]
          }
        },
        "codeStyle": {
          "type": "object",
          "properties": {
            "asyncPreference": { "type": "string", "enum": ["async/await", "promises", "callbacks"] },
            "errorHandling": { "type": "string", "enum": ["try-catch", "result-type", "callbacks"] },
            "typeScriptStrict": { "type": "boolean" }
          }
        }
      },
      "required": ["version", "updated"]
    },
    "preferences": {
      "type": "object",
      "properties": {
        "version": { "type": "string", "pattern": "^\\d+\\.\\d+$" },
        "enabled": { "type": "boolean", "default": true },
        "learnFromEdits": { "type": "boolean", "default": true },
        "learnFromApprovals": { "type": "boolean", "default": true },
        "learnFromAgentOutcomes": { "type": "boolean", "default": true },
        "shareAnonymized": { "type": "boolean", "default": false },
        "retentionDays": { "type": "integer", "minimum": 1, "maximum": 365, "default": 90 },
        "pausedUntil": { "type": ["string", "null"], "format": "date-time" }
      },
      "required": ["version", "enabled"]
    }
  }
}