{
  "$schema": "../../schemas/skill-capabilities.schema.json",
  "name": "defense-in-depth",
  "version": "1.0.0",
  "description": "Multi-layer security architecture for AI systems with 8 validation layers from edge to storage",

  "capabilities": {
    "8-layer-architecture": {
      "keywords": ["defense in depth", "security layers", "validation layers", "multi-layer"],
      "solves": [
        "How do I secure my AI application end-to-end?",
        "What validation layers do I need?",
        "How do I implement defense in depth?"
      ],
      "reference_file": "references/8-layer-validation.md",
      "token_cost": 400
    },
    "request-context": {
      "keywords": ["request context", "immutable context", "context object", "user context"],
      "solves": [
        "How do I pass user identity through the system?",
        "How do I create an immutable request context?",
        "What should be in the request context?"
      ],
      "reference_file": "references/request-context-pattern.md",
      "token_cost": 250
    },
    "tenant-isolation": {
      "keywords": ["multi-tenant", "tenant isolation", "tenant filter", "cross-tenant"],
      "solves": [
        "How do I ensure tenant isolation?",
        "How do I prevent cross-tenant data access?",
        "How do I filter queries by tenant?"
      ],
      "reference_file": "references/tenant-isolation.md",
      "token_cost": 300
    },
    "audit-logging": {
      "keywords": ["audit log", "audit trail", "logging", "compliance"],
      "solves": [
        "What should I log for compliance?",
        "How do I create audit trails?",
        "How do I log without leaking PII?"
      ],
      "reference_file": "references/audit-logging.md",
      "token_cost": 200
    }
  },

  "skillforge_layers": [
    "Layer 0: Edge (WAF, Rate Limit, DDoS)",
    "Layer 1: Gateway (Auth, Context Extraction)",
    "Layer 2: Input Validation (Schema, PII, Injection)",
    "Layer 3: Authorization (RBAC/ABAC, Tenant Check)",
    "Layer 4: Data Access (Parameterized Queries)",
    "Layer 5: LLM Orchestration (Prompt Building)",
    "Layer 6: Output Validation (Guardrails)",
    "Layer 7: Attribution & Storage",
    "Layer 8: Observability (Logging, Tracing, Metrics)"
  ],

  "triggers": {
    "high_confidence": ["defense.*depth", "security.*layer", "8.*layer", "validation.*layer"],
    "medium_confidence": ["secure.*api", "multi.*layer", "protection"]
  },

  "integrates_with": ["security-checklist", "llm-safety-patterns", "observability-monitoring"],

  "progressive_loading": {
    "tier_1_discovery": {
      "file": "capabilities.json",
      "tokens": 100,
      "use_when": "Initial task analysis"
    },
    "tier_2_overview": {
      "file": "SKILL.md",
      "tokens": 600,
      "use_when": "Need security architecture overview"
    },
    "tier_3_specific": {
      "files": "references/*.md",
      "tokens": "200-400 each",
      "use_when": "Need specific layer implementation"
    }
  }
}
