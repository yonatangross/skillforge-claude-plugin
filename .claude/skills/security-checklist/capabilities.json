{
  "$schema": "../../schemas/skill-capabilities.schema.json",
  "name": "security-checklist",
  "version": "1.0.0",
  "description": "OWASP Top 10 mitigations, authentication patterns, input validation, and compliance guidelines",

  "capabilities": {
    "owasp-injection": {
      "keywords": ["sql injection", "injection", "xss", "command injection", "sanitize"],
      "solves": [
        "How do I prevent SQL injection?",
        "XSS prevention strategies",
        "Input sanitization best practices"
      ],
      "reference_file": "SKILL.md#3-injection",
      "token_cost": 150
    },
    "owasp-auth": {
      "keywords": ["authentication", "password", "session", "mfa", "brute force"],
      "solves": [
        "How do I implement secure authentication?",
        "Password hashing best practices",
        "Session management security"
      ],
      "reference_file": "SKILL.md#7-identification-and-authentication-failures",
      "token_cost": 180
    },
    "owasp-access-control": {
      "keywords": ["authorization", "access control", "idor", "rbac", "permissions"],
      "solves": [
        "How do I implement RBAC?",
        "Prevent unauthorized data access",
        "IDOR vulnerability prevention"
      ],
      "reference_file": "SKILL.md#1-broken-access-control",
      "token_cost": 130
    },
    "dependency-scanning": {
      "keywords": ["npm audit", "pip-audit", "dependency", "vulnerability", "cve"],
      "solves": [
        "How do I scan for vulnerable dependencies?",
        "npm audit workflow",
        "Dependency security best practices"
      ],
      "reference_file": "SKILL.md#automated-security-scanning",
      "token_cost": 200
    },
    "security-headers": {
      "keywords": ["csp", "cors", "hsts", "security headers", "x-frame-options"],
      "solves": [
        "Which security headers should I set?",
        "Content Security Policy configuration",
        "CORS configuration for APIs"
      ],
      "reference_file": "SKILL.md#security-headers",
      "token_cost": 100
    },
    "encryption": {
      "keywords": ["encrypt", "hash", "bcrypt", "argon2", "tls", "https"],
      "solves": [
        "How do I hash passwords securely?",
        "Data encryption at rest",
        "TLS configuration"
      ],
      "reference_file": "SKILL.md#2-cryptographic-failures",
      "token_cost": 140
    },
    "compliance-gdpr": {
      "keywords": ["gdpr", "privacy", "pii", "data protection", "consent"],
      "solves": [
        "GDPR compliance checklist",
        "How to handle PII",
        "User consent requirements"
      ],
      "reference_file": "SKILL.md#gdpr",
      "token_cost": 120
    }
  },

  "triggers": {
    "high_confidence": [
      "security.*audit",
      "owasp",
      "vulnerability",
      "penetration.*test",
      "secure.*code"
    ],
    "medium_confidence": [
      "auth.*security",
      "input.*validation",
      "encrypt"
    ]
  },

  "integrates_with": [
    "api-design-framework",
    "code-review-playbook",
    "evidence-verification"
  ],

  "progressive_loading": {
    "tier_1_discovery": {
      "file": "capabilities.json",
      "tokens": 100,
      "use_when": "Determine if security review is needed"
    },
    "tier_2_overview": {
      "file": "SKILL.md",
      "tokens": 800,
      "sections_to_load": ["overview", "security-principles", "quick-start-checklist"],
      "use_when": "General security guidance needed"
    },
    "tier_3_specific": {
      "sections": "SKILL.md#owasp-*",
      "tokens": "100-180 each",
      "use_when": "Specific vulnerability category guidance"
    },
    "tier_4_scanning": {
      "sections": "SKILL.md#automated-security-scanning",
      "tokens": 300,
      "use_when": "Need to run security scans and record evidence"
    }
  },

  "auto_trigger": {
    "on_agent": "code-quality-reviewer",
    "when": "reviewing code for production",
    "action": "load tier_4_scanning for npm audit / pip-audit workflow"
  },

  "mcp_tools": {
    "dependency_scan": {
      "tool": "Bash",
      "commands": ["npm audit --json", "pip-audit --format=json"],
      "evidence_capture": true,
      "use_when": "Need to scan dependencies for vulnerabilities and record evidence"
    },
    "documentation_lookup": {
      "tool": "context7",
      "library_ids": ["/OWASP/CheatSheetSeries"],
      "use_when": "Need current security best practices and OWASP guidance"
    }
  }
}
